@page "/DynamicFormAudit/DynamicFormsAuditTrails"
@page "/DynamicFormAudit/DynamicFormsAuditTrails/{SessionId:guid}/{SessionIds:guid}"
@using System.ComponentModel.DataAnnotations;
@using Newtonsoft.Json.Linq;
@using System.Collections;
@using System.Dynamic;
@using global::Core.AttributeDynamicData;
@using global::Core.Entities.Views;
@using global::Core.Entities;
@using Application.Queries;
@inject IMediator Mediator
@using MediatR
@using global::Core.EntityModels;
@using global::Core.Repositories.Query;
@inject AC.SD.Core.Services.ToastService toastService
@inject ILocalStorageService<ApplicationUser> _localStorageService
@inject IJSRuntime JSRuntime;
@inject NavigationManager NavigationManager
@using global::Core.Helpers;
@using System.Reflection;
@using System.Linq.Expressions;
@using Newtonsoft.Json;
@using System.Collections.ObjectModel
@implements IAsyncDisposable
@using System.Text.RegularExpressions;
@using ExpressionMathEval = org.matheval.Expression;
@inject AC.SD.Core.Helpers.DataGridDynamicForm _LoadDataGridDynamicForm
@rendermode @(new  InteractiveServerRenderMode(prerender: false))
@using CodingSeb.ExpressionEvaluator;
@using BlazorBarcodeScanner.ZXing.JS
@*     <DxLoadingPanel @bind-Visible="PanelVisible"
                    IsContentBlocked="true"
                    ApplyBackgroundShading="true"
                    IndicatorAreaVisible="false"
                    Text="Fetching Data..."> *@
<style>
    .my-style {
        <!-- your CSS rules -->
    }

    .FormLayoutGroupCss {
        padding: 5px;
    }

    .my-style-captionw {
        text-align: right;
    }
</style>
<style scoped>
    .zxing-video-container > video {
        width: 100%;
        height: auto;
    }

    .dxbl-upload-cancel-btn {
        display: none;
    }
</style>
<style scoped>
    .table-responsives {
        width: 100%;
        overflow-x: auto;
    }

    #customers {
        /* font-family: Arial, Helvetica, sans-serif;
                                                                                                                                                                                                                                                    border-collapse: collapse;*/
        width: 100%;
    }

        #customers td, #customers th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        #customers tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #customers tr:hover {
            background-color: #ddd;
        }

        #customers th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            font-weight: bold;
        }
</style>
<script>
    function htmlpdfGenerate() {
        var element = document.getElementById('htmlPdfPrint');
        var opt = {
            margin: 0.5,
            filename: 'myfile.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { useCORS: true, letterRendering: true, }, pagebreak: { avoid: "avoid-all" },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait', compressPDF: true }
        };
        // New Promise-based usage:
        //var openUrl= html2pdf().set(opt).from(element).output("bloburl");
        html2pdf().set(opt).from(element).toPdf().get('pdf').then(function (pdf) {
            window.open(pdf.output('bloburl'), '_blank');
        });
        return "ok";
    }
</script>

<div class="card-header text-center py-3">
    <h4>@_dynamicform?.Name</h4>
</div>
<div class="card" style="margin-top: 5px;padding: 5px;">
    <div class="card-body p-0">
        <div class="row" style="padding-bottom:10px;">
            <div class="">

                <DxMenu CollapseItemsToHamburgerMenu="true"
                        CollapseItemToIconMode="MenuCollapseItemToIconMode.Sequentially"
                        DisplayMode="MenuDisplayMode.Desktop">
                    <Items>
                        <DxMenuItem Text="Print Form" IconCssClass="fa fa-print" Click="@openPrintForm" />
                        <DxMenuItem Text="Print Form Pdf" IconCssClass="fa fa-print" Click="@PrintForm" />
                        <DxMenuItem Text="Audit Trail" IconCssClass="fa fa-history" Click="@addAuditTrail" Enabled="@EditEnabled" />
                    </Items>
                </DxMenu>


            </div>

        </div>
    </div>

    <div class="card cw-480" style="@mainStyle" id="htmlPdfPrint">
        <div class="card-header text-center py-3" style="@displayNonePrintForm">
            <h4>@_dynamicform?.Name</h4>
        </div>
        <DxTabs RenderMode="TabsRenderMode.Default" @bind-ActiveTabIndex="@ActiveTabIndex" TabClick="OnTabClick">
            <DxTabPage Text="Form">

                <div class="card-body" style="margin-top:5px;">
                    <DxFormLayout CssClass="w-100">
                        <EditForm EditContext="this._editContexts" Context="EditFormContext" OnValidSubmit="HandleValidSubmit">
                            <DataAnnotationsValidator />
                            <DxFormLayoutGroup ColSpanMd="12" Caption="Profile No" ExpandButtonDisplayMode="GroupExpandButtonDisplayMode.Start" ExpandedChanged="@ExpandedChanged" Expanded="@isMainHeader" AnimationType="LayoutAnimationType.Slide">
                                <HeaderContentTemplate>
                                    <div>
                                        Profile No
                                    </div>

                                </HeaderContentTemplate>
                                <Items>
                                    <DxFormLayoutItem Caption="Login From" ColSpanMd="@colSpanMd">
                                        @if (isPrint == true && _dynamicformData == null)
                                        {
                                            <DxTextBox @bind-Text="@_longInUserPrint" Enabled="false" />
                                        }
                                        else
                                        {
                                            <DxTextBox @bind-Text="@_longInUser" Enabled="false" />
                                        }
                                    </DxFormLayoutItem>
                                    <DxFormLayoutItem Caption="Login Company" ColSpanMd="@colSpanMd">
                                        @if (isPrint == true && _dynamicformData == null)
                                        {
                                            <DxTextBox @bind-Text="@_longInCompanyPrint" Enabled="false" />
                                        }
                                        else
                                        {
                                            <DxTextBox @bind-Text="@_longInCompany" Enabled="false" />
                                        }
                                    </DxFormLayoutItem>
                                    <DxFormLayoutItem Caption="Added By" ColSpanMd="@colSpanMd">
                                        @if (isPrint == true && _dynamicformData == null)
                                        {
                                            <DxTextBox @bind-Text="@_longInAddedByPrint" Enabled="false" />
                                        }
                                        else
                                        {
                                            <DxTextBox NullText="Added By" @bind-Text="@_longInAddedBy" Enabled="false" />
                                        }
                                    </DxFormLayoutItem>
                                    <DxFormLayoutItem Caption="Added Date" ColSpanMd="@colSpanMd">
                                        @if (isPrint == true && _dynamicformData == null)
                                        {
                                            <DxTextBox @bind-Text="@_longInDateTimePrint" Enabled="false" />
                                        }
                                        else
                                        {
                                            <DxTextBox NullText="Date" @bind-Text="@_longInDateTime" Enabled="false" />
                                        }
                                    </DxFormLayoutItem>
                                    <DxFormLayoutItem Caption="Profile No" ColSpanMd="12">
                                        <DxTextBox @bind-Text="@Datas.ProfileNo" Enabled="false" />
                                    </DxFormLayoutItem>
                                    @if (isPrint == false)
                                    {
                                        <DxFormLayoutItem Caption="Company" ColSpanMd="6">
                                            <DxDropDownBox @bind-Value="PlantValue"
                                                           QueryDisplayText="QueryPlantText"
                                                           ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                                                           NullText="Select a Company..."
                                                           Enabled="isPlant"
                                                           ShowValidationIcon="true">
                                                <DropDownBodyTemplate Context="ddbBodyContext">
                                                    <DxGrid Data="@_plantItems"
                                                            KeyFieldName="@nameof(ViewPlants.PlantID)" ShowSearchBox="true"
                                                            HighlightRowOnHover="true"
                                                            SearchTextParseMode="GridSearchTextParseMode.GroupWordsByAnd"
                                                            SelectionMode="GridSelectionMode.Single"
                                                            AllowSelectRowByClick="true"
                                                            FocusedRowEnabled="true"
                                                            TextWrapEnabled="false"
                                                            CssClass="templateGrid"
                                                            SelectedDataItem="@(ddbBodyContext.DropDownBox.Value as ViewPlants)"
                                                            SelectedDataItemChanged="item => GridSelectedDataItemChanged(item, ddbBodyContext.DropDownBox)">
                                                        <Columns>
                                                            <DxGridDataColumn FieldName="PlantCode" />
                                                            <DxGridDataColumn FieldName="Description" />
                                                            <DxGridDataColumn FieldName="NavCompanyName" />
                                                        </Columns>
                                                    </DxGrid>
                                                </DropDownBodyTemplate>
                                            </DxDropDownBox>
                                            <DxSpinEdit @bind-Value="@Datas.PlantId" ShowValidationIcon="true" style="display:none;" />
                                            @*  <DxComboBox Data="@_plantItems"
                                        NullText="Select Company..."
                                        ListRenderMode="ListRenderMode.Virtual"
                                        FilteringMode="DataGridFilteringMode.Contains"
                                        TextFieldName="PlantCode"
                                        ValueFieldName="PlantID"
                                        SelectedItemChanged="@((ViewPlants plantSelect) => SelectedItemChanged(plantSelect?.PlantID))"
                                        Enabled="isPlant"
                                        @bind-Value="@Datas.PlantId" ShowValidationIcon="true">
                                        <Columns>
                                        <DxListEditorColumn FieldName="@nameof(ViewPlants.PlantCode)"
                                        Caption="Plant Code"
                                        Width="180px" />
                                        <DxListEditorColumn FieldName="@nameof(ViewPlants.Description)"
                                        Caption="Description" />
                                        <DxListEditorColumn FieldName="@nameof(ViewPlants.NavCompanyName)"
                                        Caption="Nav Company" />
                                        </Columns>
                                        </DxComboBox>*@
                                            <ValidationMessage For="@(() => Datas.PlantId)" />
                                        </DxFormLayoutItem>
                                        <DxFormLayoutItem Caption="Division" ColSpanMd="6">
                                            @*   <DxComboBox Data="@_divisionItems"
                                        NullText="Select Division..."
                                        ListRenderMode="ListRenderMode.Virtual"
                                        FilteringMode="DataGridFilteringMode.Contains"
                                        TextFieldName="Name"
                                        ValueFieldName="DivisionID"
                                        Enabled="isDivision"
                                        SelectedItemChanged="@((ViewDivision plantSelect) => SelectedItemDivisionChanged(plantSelect?.DivisionID))"
                                        @bind-Value="@Datas.DivisionId" ShowValidationIcon="true">
                                        <Columns>
                                        <DxListEditorColumn FieldName="@nameof(ViewDivision.Name)"
                                        Caption="Name"
                                        Width="180px" />
                                        <DxListEditorColumn FieldName="@nameof(ViewDivision.Code)"
                                        Caption="Code" />
                                        <DxListEditorColumn FieldName="@nameof(ViewDivision.Description)"
                                        Caption="Description" />
                                        </Columns>
                                        </DxComboBox> *@
                                            <DxDropDownBox @bind-Value="DivisionValue"
                                                           QueryDisplayText="QueryDivisionText"
                                                           ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                                                           NullText="Select a Division..."
                                                           Enabled="isDivision"
                                                           ShowValidationIcon="true">
                                                <DropDownBodyTemplate Context="ddbBodyContext">
                                                    <DxGrid Data="@_divisionItems"
                                                            KeyFieldName="@nameof(ViewDivision.DivisionID)" ShowSearchBox="true"
                                                            HighlightRowOnHover="true"
                                                            SearchTextParseMode="GridSearchTextParseMode.GroupWordsByAnd"
                                                            SelectionMode="GridSelectionMode.Single"
                                                            AllowSelectRowByClick="true"
                                                            FocusedRowEnabled="true"
                                                            TextWrapEnabled="false"
                                                            CssClass="templateGrid"
                                                            SelectedDataItem="@(ddbBodyContext.DropDownBox.Value as ViewDivision)"
                                                            SelectedDataItemChanged="item => GridDivisionSelectedDataItemChanged(item, ddbBodyContext.DropDownBox)">
                                                        <Columns>
                                                            <DxGridDataColumn FieldName="@nameof(ViewDivision.Name)" Caption="Name" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewDivision.Code)" Caption="Code" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewDivision.Description)" Caption="Description" />
                                                        </Columns>
                                                    </DxGrid>
                                                </DropDownBodyTemplate>
                                            </DxDropDownBox>
                                            <DxSpinEdit @bind-Value="@Datas.DivisionId" ShowValidationIcon="true" style="display:none;" />
                                            <ValidationMessage For="@(() => Datas.DivisionId)" />
                                        </DxFormLayoutItem>
                                        <DxFormLayoutItem Caption="Department" ColSpanMd="6">
                                            @*  <DxComboBox Data="@_departmentItems"
                                        NullText="Select Department..."
                                        ListRenderMode="ListRenderMode.Virtual"
                                        FilteringMode="DataGridFilteringMode.Contains"
                                        TextFieldName="DepartmentName"
                                        ValueFieldName="DepartmentId"
                                        Enabled="isDepartment"
                                        SelectedItemChanged="@((ViewDepartment plantSelect) => SelectedItemDepartementChanged(plantSelect?.DepartmentId))"
                                        @bind-Value="@Datas.DepartmentId" ShowValidationIcon="true">
                                        <Columns>
                                        <DxListEditorColumn FieldName="@nameof(ViewDepartment.DepartmentName)"
                                        Caption="Name"
                                        Width="180px" />
                                        <DxListEditorColumn FieldName="@nameof(ViewDepartment.DepartmentCode)"
                                        Caption="Code" />
                                        <DxListEditorColumn FieldName="@nameof(ViewDepartment.Description)"
                                        Caption="Description" />
                                        </Columns>
                                        </DxComboBox> *@
                                            <DxDropDownBox @bind-Value="DepartmentValue"
                                                           QueryDisplayText="QueryDepartmentText"
                                                           ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                                                           NullText="Select a Department..."
                                                           Enabled="isDepartment"
                                                           ShowValidationIcon="true">
                                                <DropDownBodyTemplate Context="ddbBodyContext">
                                                    <DxGrid Data="@_departmentItems"
                                                            KeyFieldName="@nameof(ViewDepartment.DepartmentId)" ShowSearchBox="true"
                                                            HighlightRowOnHover="true"
                                                            SearchTextParseMode="GridSearchTextParseMode.GroupWordsByAnd"
                                                            SelectionMode="GridSelectionMode.Single"
                                                            AllowSelectRowByClick="true"
                                                            FocusedRowEnabled="true"
                                                            TextWrapEnabled="false"
                                                            CssClass="templateGrid"
                                                            SelectedDataItem="@(ddbBodyContext.DropDownBox.Value as ViewDepartment)"
                                                            SelectedDataItemChanged="item => GridDepartmentSelectedDataItemChanged(item, ddbBodyContext.DropDownBox)">
                                                        <Columns>
                                                            <DxGridDataColumn FieldName="@nameof(ViewDepartment.DepartmentName)" Caption="Name" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewDepartment.DepartmentCode)" Caption="Code" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewDepartment.Description)" Caption="Description" />
                                                        </Columns>
                                                    </DxGrid>
                                                </DropDownBodyTemplate>
                                            </DxDropDownBox>
                                            <DxSpinEdit @bind-Value="@Datas.DepartmentId" ShowValidationIcon="true" style="display:none;" />
                                            <ValidationMessage For="@(() => Datas.DepartmentId)" />
                                        </DxFormLayoutItem>
                                        <DxFormLayoutItem Caption="Section" ColSpanMd="6">
                                            @* <DxComboBox Data="@_sectionItems"
                                        NullText="Select Section..."
                                        ListRenderMode="ListRenderMode.Virtual"
                                        FilteringMode="DataGridFilteringMode.Contains"
                                        TextFieldName="SectionName"
                                        ValueFieldName="SectionId"
                                        Enabled="isSection"
                                        SelectedItemChanged="@((ViewSection plantSelect) => SelectedItemSectionChanged(plantSelect?.SectionId))"
                                        @bind-Value="@Datas.SectionId" ShowValidationIcon="true">
                                        <Columns>
                                        <DxListEditorColumn FieldName="@nameof(ViewSection.SectionName)"
                                        Caption="Name"
                                        Width="180px" />
                                        <DxListEditorColumn FieldName="@nameof(ViewSection.SectionCode)"
                                        Caption="Code" />
                                        <DxListEditorColumn FieldName="@nameof(ViewSection.Description)"
                                        Caption="Description" />
                                        </Columns>
                                        </DxComboBox> *@
                                            <DxDropDownBox @bind-Value="SectionValue"
                                                           QueryDisplayText="QuerySectionText"
                                                           ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                                                           NullText="Select a Section..."
                                                           Enabled="isSection"
                                                           ShowValidationIcon="true">
                                                <DropDownBodyTemplate Context="ddbBodyContext">
                                                    <DxGrid Data="@_sectionItems"
                                                            KeyFieldName="@nameof(ViewSection.SectionId)" ShowSearchBox="true"
                                                            HighlightRowOnHover="true"
                                                            SearchTextParseMode="GridSearchTextParseMode.GroupWordsByAnd"
                                                            SelectionMode="GridSelectionMode.Single"
                                                            AllowSelectRowByClick="true"
                                                            FocusedRowEnabled="true"
                                                            TextWrapEnabled="false"
                                                            CssClass="templateGrid"
                                                            SelectedDataItem="@(ddbBodyContext.DropDownBox.Value as ViewSection)"
                                                            SelectedDataItemChanged="item => GridSectionSelectedDataItemChanged(item, ddbBodyContext.DropDownBox)">
                                                        <Columns>
                                                            <DxGridDataColumn FieldName="@nameof(ViewSection.SectionName)" Caption="Name" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewSection.SectionCode)" Caption="Code" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewSection.Description)" Caption="Description" />
                                                        </Columns>
                                                    </DxGrid>
                                                </DropDownBodyTemplate>
                                            </DxDropDownBox>
                                            <DxSpinEdit @bind-Value="@Datas.SectionId" ShowValidationIcon="true" style="display:none;" />
                                            <ValidationMessage For="@(() => Datas.SectionId)" />
                                        </DxFormLayoutItem>
                                        <DxFormLayoutItem Caption="SubSection" ColSpanMd="6">
                                            @* <DxComboBox Data="@_subSectionItems"
                                        NullText="Select SubSection..."
                                        ListRenderMode="ListRenderMode.Virtual"
                                        FilteringMode="DataGridFilteringMode.Contains"
                                        TextFieldName="SubSectionName"
                                        ValueFieldName="SubSectionId"
                                        Enabled="isSubSection"
                                        @bind-Value="@Datas.SubSectionId" ShowValidationIcon="true">
                                        <Columns>
                                        <DxListEditorColumn FieldName="@nameof(ViewSubSection.SubSectionName)"
                                        Caption="Name"
                                        Width="180px" />
                                        <DxListEditorColumn FieldName="@nameof(ViewSubSection.SubSectionCode)"
                                        Caption="Code" />
                                        <DxListEditorColumn FieldName="@nameof(ViewSubSection.Description)"
                                        Caption="Description" />
                                        </Columns>
                                        </DxComboBox> *@
                                            <DxDropDownBox @bind-Value="SubSectionValue"
                                                           QueryDisplayText="QuerySubSectionText"
                                                           ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                                                           NullText="Select a Sub Section..."
                                                           Enabled="isSubSection"
                                                           ShowValidationIcon="true">
                                                <DropDownBodyTemplate Context="ddbBodyContext">
                                                    <DxGrid Data="@_subSectionItems"
                                                            KeyFieldName="@nameof(ViewSubSection.SubSectionId)" ShowSearchBox="true"
                                                            HighlightRowOnHover="true"
                                                            SearchTextParseMode="GridSearchTextParseMode.GroupWordsByAnd"
                                                            SelectionMode="GridSelectionMode.Single"
                                                            AllowSelectRowByClick="true"
                                                            FocusedRowEnabled="true"
                                                            TextWrapEnabled="false"
                                                            CssClass="templateGrid"
                                                            SelectedDataItem="@(ddbBodyContext.DropDownBox.Value as ViewSubSection)"
                                                            SelectedDataItemChanged="item => GridSubSectionSelectedDataItemChanged(item, ddbBodyContext.DropDownBox)">
                                                        <Columns>
                                                            <DxGridDataColumn FieldName="@nameof(ViewSubSection.SubSectionName)" Caption="Name" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewSubSection.SubSectionCode)" Caption="Code" />
                                                            <DxGridDataColumn FieldName="@nameof(ViewSubSection.Description)" Caption="Description" />
                                                        </Columns>
                                                    </DxGrid>
                                                </DropDownBodyTemplate>
                                            </DxDropDownBox>
                                            <DxSpinEdit @bind-Value="@Datas.SubSectionId" ShowValidationIcon="true" style="display:none;" />
                                            <ValidationMessage For="@(() => Datas.SubSectionId)" />
                                        </DxFormLayoutItem>
                                    }
                                </Items>
                            </DxFormLayoutGroup>
                        </EditForm>
                    </DxFormLayout>
                    <EditForm EditContext="this._editContext" Context="EditFormContext" OnValidSubmit="HandleValidSubmit">

                        @CreateEditFormFields()
                    </EditForm>
                </div>
            </DxTabPage>
            <DxTabPage Text="Approval" Visible="@isApproval">
                <DynamicFormApprovedFormList @ref="refDynamicFormApprovedFormList" isLocked="@isLocked" isBackShow="false" _applicationUser="@applicationUser" _dynamicformData="@_dynamicformData"></DynamicFormApprovedFormList>

            </DxTabPage>
            <DxTabPage Text="Work Flow">
                <DynamicFormDataWorkFlowFormList @ref="refDynamicFormDataWorkFlowFormList" dynamicFormId="@_dynamicform?.ID" FolderPathLists="@_dynamicFormWorkFlowFormListItems" _dynamicformData="@_dynamicformData" applicationUser="@applicationUser" EditEnabledApproval="@EditEnabledApproval" RevokeBack="BackUpload"></DynamicFormDataWorkFlowFormList>
            </DxTabPage>
        </DxTabs>
    </div>

</div>

@* </DxLoadingPanel> *@
<DxPopup @bind-Visible="@isApprovedPopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Approved From"
         Closed="EulaPopupClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Are you sure want to Approved?
        </p>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="Context.CloseCallback" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="HandleFormValidSubmit" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=IsDescriptionOpen
          PositionTarget=@($"#flyout-overview-target-container-Description")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText=@($"{ApproveRejectName} Description")
          FooterVisible="true"
          CloseOnOutsideClick="false"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 550px)"
          Position=@(FlyoutPosition.BottomStart | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <DxFormLayout CssClass="w-100">
            <DxFormLayoutItem Caption="" ColSpanMd="12">
                <DxMemo @bind-Text="@dynamicFormApproval.ApprovedDescription" CssClass="cw-480" Rows="5" />
            </DxFormLayoutItem>
        </DxFormLayout>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => IsDescriptionOpen = false) />
        <DxButton RenderStyle="ButtonRenderStyle.Success" Text="@ApproveRejectName" Click=@(() => OnUpdateDescription()) />
    </FooterContentTemplate>
</DxFlyout>
<DxPopup @bind-Visible="@PopupUpload"
         HeaderText="Upload Documents"
         CloseOnOutsideClick="false"
         ShowCloseButton="true"
         Closed="EulaPopupClosed"
         ShowFooter="false"
         Width="1500px">
    <BodyContentTemplate>
        <UploadDoumentDynamicFiles @ref="refUploadDoumentDynamicFiles" _applicationUser="@applicationUser" DynamicFormDataUploadByPermissions="@DynamicFormDataUploadByPermissions" _dynamicformData="@_dynamicformData" FileProfileTypeId="@FileProfileTypeId" RevokeBack="BackUpload"></UploadDoumentDynamicFiles>
    </BodyContentTemplate>
</DxPopup>


<DxPopup @bind-Visible="@wokrFlowpopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Work Flow"
         Closed="EulaPopupWorkFlowClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Do you want to Move WorkFlow?
        </p>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="OnWorkFlowNo" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="OnWorkFlowYes" />
    </FooterContentTemplate>
</DxPopup>

<DxFlyout @bind-IsOpen=IsSectionInfoOpen
          PositionTarget=@($"#flyout-overview-target-container-SectionInfo-{randomNum}-{DynamicFormInfoSection?.DynamicFormSectionId}")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText="Instruction"
          FooterVisible="true"
          CloseOnOutsideClick="true"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 250px)"
          Position=@(FlyoutPosition.Left | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <span>@DynamicFormInfoSection?.Instruction</span>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => IsSectionInfoOpen = false) />
    </FooterContentTemplate>
</DxFlyout>
<DxFlyout @bind-IsOpen=IsTooltipInfoOpen
          PositionTarget=@($"#flyout-overview-target-container-TooltipInfo-{_tooltipShowId}")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText="Tooltips"
          FooterVisible="true"
          CloseOnOutsideClick="true"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 250px)"
          Position=@(FlyoutPosition.Left | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <span>@_tooltipInstruction</span>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => IsTooltipInfoOpen = false) />
    </FooterContentTemplate>
</DxFlyout>

<DxPopup @bind-Visible="@DynamicFormFilterBypopup"
         ShowFooter="false"
         ShowCloseButton="true"
         HeaderText="Filter"
         CloseOnOutsideClick="false"
         CloseOnEscape="false"
         Closed="EulaPopupDynamicFormFilterByClosed"
         Width="1000px">
    <BodyContentTemplate>
        <DynamicFormFilterByForm @ref="refDynamicFormFilterByForm" _PlantLoadDependencyId="@_PlantLoadDependencyId" _dynamicform="@_dynamicform" _filterDynamicFormSection="@_filterDynamicFormSection" OnItemSelected="@CloseFilterFormPopup" _dataSourceName="@_dataSourceName" _filterAttrName="@_filterAttrName" _filterDynamicFormSectionAttribute="@_filterDynamicFormSectionAttribute"></DynamicFormFilterByForm>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="OnWorkFlowNo" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="OnWorkFlowYes" />
    </FooterContentTemplate>
</DxPopup>
<DxPopup @bind-Visible="@lockpopup"
         ShowFooter="true"
         HeaderText="@LockedName"
         ShowCloseButton="true"
         Closed="EulaPopupLockClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Do you want to @LockedName this record?
        </p>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="Context.CloseCallback" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="((e) => bulkLock())" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=IsWokFlowDescriptionOpen
          PositionTarget=@($"#flyout-overview-target-container-WorkFlowApproval")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText=@($"{ApproveRejectWokFlowName} Description")
          FooterVisible="true"
          CloseOnOutsideClick="false"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 550px)"
          Position=@(FlyoutPosition.BottomStart | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <DxFormLayout CssClass="w-100">
            <DxFormLayoutItem Caption="" ColSpanMd="12">
                <DxMemo @bind-Text="@dynamicFormWorkFlowApprovedForm.ApprovedDescription" CssClass="cw-480" Rows="5" />
            </DxFormLayoutItem>
        </DxFormLayout>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => IsWokFlowDescriptionOpen = false) />
        <DxButton RenderStyle="ButtonRenderStyle.Success" Text="@ApproveRejectWokFlowName" Click=@(() => OnUpdateWorkFlowDescription()) />
    </FooterContentTemplate>
</DxFlyout>
<DxPopup @bind-Visible="@IsSectionLockOpen"
         ShowFooter="true"
         HeaderText="Section Lock"
         ShowCloseButton="true"
         Closed="EulaPopupLockClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Do you want to @SectionLockedName this Section?
        </p>
        <span style="font-weight:bold;">@dynamicFormSectionData?.SectionName</span>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="Context.CloseCallback" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="((e) => bulkSectionLock())" />
    </FooterContentTemplate>
</DxPopup>
<DxPopup @bind-Visible="@createEmailpopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Create Email"
         Closed="EulaPopupLockClosed"
         Width="1000px">
    <BodyContentTemplate>
        <DynamicFormDataEmailAddSubContent @ref="refDynamicFormDataEmailAddSubContent" SessionId="@_dynamicformData?.SessionId"></DynamicFormDataEmailAddSubContent>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="Context.CloseCallback" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="createEmailYes" />

    </FooterContentTemplate>
</DxPopup>
<DxPopup @bind-Visible="@QrCodePopupVisible"
         CssClass="popup-demo-events"
         ShowFooter="true" HeaderText="Scan Qr Code" CloseOnEscape="false" ShowCloseButton="false" MinWidth="300" MinHeight="200" MaxWidth="400" MaxHeight="800" CloseOnOutsideClick="false">
    <BodyContentTemplate>
        <BlazorBarcodeScanner.ZXing.JS.BarcodeReader @ref="_QrCodeReader" StartCameraAutomatically="true" Title="" ShowStart="false" ShowStop="false" ShowReset="false" ShowToggleTorch="false" ShowVideoDeviceList="false" ShowResult="false" FullWidthVideo="true" OnBarcodeReceived="TicketNoReceivedBarcodeText" />
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Close" Click="@(() => CloseQrCodePopup())" />
    </FooterContentTemplate>
</DxPopup>
<DxPopup @bind-Visible="@createAuditpopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Audit Trail"
         Closed="EulaPopupLockClosed"
         Width="1500px">
    <BodyContentTemplate>
        <DynamicFormsAuditTrail @ref="refDynamicFormsAuditTrail" SessionId="@_dynamicformData?.SessionId"></DynamicFormsAuditTrail>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click="Context.CloseCallback" />
    </FooterContentTemplate>
</DxPopup>
<DxPopup @bind-Visible="@imageUploadPopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Image List"
         Closed="EulaPopupLockClosed"
         CloseOnOutsideClick="false"
         CloseOnEscape="false"
         Width="1000px">
    <BodyContentTemplate>
        <AC.SD.Core.Pages.Attribute.DynamicFormUploadImageList @ref="refDynamicFormUploadImageList" OnItemSelected="@revokeDynamicFormUploadImageList" _dynamicformData="@_dynamicformData" RevokeBack="backImageUpload" _DynamicFormDataAttrUploadShowList="@_DynamicFormDataAttrUploadList" dynamicFormSectionAttribute="@_filterDynamicFormSectionAttribute"></AC.SD.Core.Pages.Attribute.DynamicFormUploadImageList>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click="Context.CloseCallback" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=dynamicFormSectionAttrFormulaEnabled
          PositionTarget=@($"#flyout-overview-target-container-SectionAttrFormula-{dynamicFormSectionAttrFormulaFunction1?.DynamicFormSectionAttributeId}")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText="Set Range"
          FooterVisible="true"
          CloseOnOutsideClick="true"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 250px)"
          Position=@(FlyoutPosition.Left | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <div class="table-responsives" style="width:100%">

            <table style="width:100%" id="customers">
                @if (@dynamicFormSectionAttrFormulaFunction1?.DynamicFormSectionAttributeId > 0)
                {
                    string formatteds = string.Empty;
                    if (dynamicFormSectionAttrFormulaFunction1.AValue > 0)
                    {
                        decimal value = (decimal)dynamicFormSectionAttrFormulaFunction1.AValue;
                        formatteds = value % 1 == 0 ? ((int)value).ToString() : value.ToString();
                    }
                    <tr>
                        <th>Type</th>
                        <td>@dynamicFormSectionAttrFormulaFunction1?.Type</td>
                    </tr>
                    <tr>
                        <th>Range Formula</th>
                        <td>@dynamicFormSectionAttrFormulaFunction1?.FormulaFunctionName</td>
                    </tr>
                    <tr>
                        <th>AValue</th>
                        <td>@formatteds</td>
                    </tr>
                    if (@dynamicFormSectionAttrFormulaFunction1.IsBValueEnabled == true)
                    {
                        string formatted = string.Empty;
                        if (dynamicFormSectionAttrFormulaFunction1.BValue > 0)
                        {
                            decimal value = (decimal)dynamicFormSectionAttrFormulaFunction1.BValue;
                            formatted = value % 1 == 0 ? ((int)value).ToString() : value.ToString();
                        }
                        <tr>
                            <th>BValue</th>
                            <td>@formatted</td>
                        </tr>
                    }
                    <tr>
                        <th>Color Value</th>
                        <td><input type="color" style="pointer-events:none;" @bind="dynamicFormSectionAttrFormulaFunction1.ColorValue" /></td>
                    </tr>
                    <tr>
                        <th>Color Code</th>
                        <td>@dynamicFormSectionAttrFormulaFunction1?.ColorValue</td>
                    </tr>
                    @* @if (!string.IsNullOrEmpty(dynamicFormSectionAttrFormulaFunction1.FormulaTextBox))
                    {
                        <tr>
                        <th>Calculation Formula</th>
                            <td>@dynamicFormSectionAttrFormulaFunction1?.FormulaTextBox</td>
                    </tr>
                    } *@
                }
                else
                {
                    <tr><td colspan="2">No Records Found.</td></tr>
                }
            </table>

        </div>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => dynamicFormSectionAttrFormulaEnabled = false) />
    </FooterContentTemplate>
</DxFlyout>
<DxPopup @bind-Visible="@WithWorkFlowStartPopup"
         ShowFooter="true"
         HeaderText="WorkFlow"
         ShowCloseButton="true"
         CloseOnOutsideClick="false"
         CloseOnEscape="false"
         Closed="EulaPopupLockClosed"
         Width="1500px">
    <BodyContentTemplate>
        <p>
            Do you want to start the flow?
        </p>
        <DxGrid Data="@_dynamicFormWorkFlowSectionNoWorkFlowSection"
                KeyFieldName="DynamicFormWorkFlowFormId"
                FilterMenuButtonDisplayMode="GridFilterMenuButtonDisplayMode.Always"
                ColumnResizeMode="GridColumnResizeMode.NextColumn"
                PagerNavigationMode="PagerNavigationMode.InputBox"
                PageSize="20"
                style="height: calc(100vh - 720px);"
                CssClass="w-100"
                FocusedRowEnabled="true"
                AllowSelectRowByClick="true"
                CustomizeElement="Grid_CustomizeElement"
                FocusedRowChanged="OnRowApprovalClick1"
                AutoExpandAllGroupRows="true"
                SelectionMode="GridSelectionMode.Multiple"
                SelectAllCheckboxMode="GridSelectAllCheckboxMode.AllPages"
                VirtualScrollingEnabled="true">
            <Columns>
                <DxGridCommandColumn MinWidth="100" Context="Context1">
                    <HeaderTemplate>
                        <DxCheckBox Checked="@CheckedAll" CheckedExpression="@(() => CheckedAll)" CheckedChanged="@((bool value) => OnCheckedAllValueChanged(value))"></DxCheckBox>
                    </HeaderTemplate>
                    <CellDisplayTemplate>
                        @{
                            var item = (DynamicFormWorkFlowSection)Context1.DataItem;
                            <DxCheckBox @bind-Checked="item.Checked"></DxCheckBox>
                        }
                    </CellDisplayTemplate>
                </DxGridCommandColumn>
                <DxGridDataColumn FieldName="IsAnomalyStatus" Caption="Is Anonymous" MinWidth="30" />
                <DxGridDataColumn FieldName="IsMultipleUser" Caption="Is Multiple User" MinWidth="30" />

                <DxGridDataColumn FieldName="IsParallelWorkflow" Caption="Is Parallel Workflow" MinWidth="30" />
                <DxGridDataColumn FieldName="IsAllowDelegateUser" Caption="Is Allow Update Delegate" MinWidth="30" />
                <DxGridDataColumn FieldName="SequenceNo" GroupIndex="0" Caption="Sequence No" MinWidth="40" />
                <DxGridDataColumn FieldName="SectionName" Caption="Section Name" />
                <DxGridDataColumn FieldName="ActualUserName" Caption="Assigned User" Context="Context2">
                    <CellDisplayTemplate>
                        @{
                            var item = (DynamicFormWorkFlowSection)Context2.DataItem;
                            if (item.IsAnomalyStatus == true)
                            {
                                // Optionally handle anomaly case if needed.
                                <span style="color:blue;">Anomaly</span>
                            }
                            else if (item.IsMultipleUser == false)
                            {
                                if (item.UserId > 0)
                                {
                                    <span>@item.ActualUserName</span>
                                }
                                else
                                {
                                    <span style="color:red;">User Not Assigned</span>
                                }
                            }
                            else if (item.IsMultipleUser == true)
                            {
                                if (item.DynamicFormWorkFlowMultipleUsers == null || item.DynamicFormWorkFlowMultipleUsers.Count == 0)
                                {
                                    <span style="color:red;">Users Not Assigned</span>
                                }
                                else
                                {
                                    <i class="fa fa-users" aria-hidden="true" id=@($"flyout-overview-target-container-RenameFilenames-{item.DynamicFormWorkFlowId}")
                                       style="cursor:pointer;padding:5px;margin-right:5px;color:black" @onclick="@(() => openFormGridLists(item))">
                                    </i>
                                }
                            }
                        }
                    </CellDisplayTemplate>
                </DxGridDataColumn>
                <DxGridDataColumn FieldName="DelegateSectionUserName" Caption="Delegate User" />
                <DxGridDataColumn FieldName="IsDynamicFormWorkFlowApproval" Caption="Is Approval User Exit" MinWidth="40" />
                <DxGridDataColumn FieldName="ApprovedStatus" Caption="Status" />
                <DxGridDataColumn FieldName="CurrentApprovalUserName" Caption="Current Approver" />
            </Columns>
        </DxGrid>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="SubmitFormExternallyWorkFlowSubmitNo" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="((e) => SubmitFormExternallyWorkFlowSubmitYes())" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=IsRenameOpens
          PositionTarget=@($"#flyout-overview-target-container-RenameFilenames-{_selectedDynamicFormWorkFlowItems?.DynamicFormWorkFlowId}")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          HeaderVisible="true"
          HeaderText="Users"
          FooterVisible="true"
          FooterCssClass="custom-flyout-footer"
          CloseOnOutsideClick="false"
          MinWidth="600" MinHeight="200" MaxWidth="1000px" MaxHeight="800"
          PreventCloseOnPositionTargetClick="true">
    <BodyContentTemplate Context="PopupContext">
        <DxGrid Data="@DynamicFormWorkFlowMultipleUsers" ShowGroupPanel="true"
                ShowGroupedColumns="true"
                ShowSearchBox="true"
                ColumnResizeMode="GridColumnResizeMode.NextColumn"
                PagerNavigationMode="PagerNavigationMode.InputBox"
                KeyFieldName="DynamicFormWorkFlowMultipleUserId"
                PageSizeSelectorVisible="true"
                PageSizeSelectorAllRowsItemVisible="true"
                PageSizeSelectorItems="@(new int[] { 5,10,20 })"
                PageSize="10"
                CssClass="ch-360"
                FocusedRowEnabled="true"
                AllowSelectRowByClick="true"
                FilterMenuButtonDisplayMode="GridFilterMenuButtonDisplayMode.Always" TextWrapEnabled="false">
            <Columns>
                <DxGridDataColumn FieldName="FullName" Caption="Name" MinWidth="80" />
                <DxGridDataColumn FieldName="DepartmentName" Caption="Department" MinWidth="80" />
                <DxGridDataColumn FieldName="DesignationName" Caption="Designation" MinWidth="100" />
            </Columns>
        </DxGrid>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(() => IsRenameOpens = false) />
    </FooterContentTemplate>
</DxFlyout>
@code {
    bool AddPermissionEnabled { get; set; } = false; bool EditPermissionEnabled { get; set; } = false; bool DeletePermissionEnabled { get; set; } = false;
    bool IsRenameOpens { get; set; } = false; public DynamicFormWorkFlowSection _selectedDynamicFormWorkFlowItems { get; set; }
    public List<DynamicFormWorkFlowMultipleUser> DynamicFormWorkFlowMultipleUsers { get; set; } = new List<DynamicFormWorkFlowMultipleUser>();
    bool CheckedAll { get; set; } = false;
    bool dynamicFormSectionAttrFormulaEnabled { get; set; } = false;
    DynamicFormSectionAttrFormulaFunction dynamicFormSectionAttrFormulaFunction1 = new DynamicFormSectionAttrFormulaFunction();
    bool imageUploadPopup { get; set; } = false;
    bool EditEnabled { get; set; } = false;
    private AC.SD.Core.Pages.Attribute.DynamicFormUploadImageList refDynamicFormUploadImageList { get; set; }
    private DynamicFormsAuditTrail refDynamicFormsAuditTrail { get; set; }
    bool createAuditpopup { get; set; } = false;
    bool? IsDynamicGridForm { get; set; } = false; bool? IsPrintWithoutGridForm { get; set; } = false;
    private DynamicFormDataEmailAddSubContent refDynamicFormDataEmailAddSubContent { get; set; }
    bool isPrint { get; set; } = false; int colSpanMd { get; set; } = 3; bool isMainHeader { get; set; } = false;
    private string? displayNonePrintForm { get; set; } = "display:none;";
    private string? mainStyle { get; set; } = "overflow-x: hidden;overflow-y: auto;height: calc(100vh - 280px);";
    private DynamicFormDataWorkFlowFormList refDynamicFormDataWorkFlowFormList { get; set; }
    private UploadDoumentDynamicFiles refUploadDoumentDynamicFiles { get; set; }
    private DynamicFormFilterByForm refDynamicFormFilterByForm { get; set; }
    private DynamicFormApprovedFormList refDynamicFormApprovedFormList { get; set; }
    string? workflowStyle { get; set; } = "display:none;";
    private DynamicFormWorkFlowApprovedForm dynamicFormWorkFlowApprovedForm = new DynamicFormWorkFlowApprovedForm(); string? ApproveRejectWokFlowName { get; set; } = "Approve";
    public bool IsWorkflowApprovalApproved { get; set; } = false; public bool IsWorkflowApprovalRejected { get; set; } = false; public bool IsWokFlowDescriptionOpen { get; set; } = false;
    public DynamicFormWorkFlow DynamicFormWorkFlowItems { get; set; }
    object PlantValue { get; set; }
    object DivisionValue { get; set; }
    object DepartmentValue { get; set; }
    object SectionValue { get; set; }
    object SubSectionValue { get; set; }
    private IDisposable? DynamicFormPage6;
    bool DynamicFormFilterBypopup { get; set; } = false;
    string? _tooltipShowId { get; set; } = string.Empty; string? _filterAttrName { get; set; } = string.Empty; string? _dataSourceName { get; set; } = string.Empty;
    long? _PlantLoadDependencyId { get; set; } = null;
    string? _tooltipInstruction { get; set; } = string.Empty;
    DynamicFormSection DynamicFormInfoSection = new DynamicFormSection();
    bool wokrFlowpopup { get; set; } = false; bool isSaveEnabled { get; set; } = false;
    bool PanelVisible { get; set; } = true;
    EditContext _editContext; EditContext _editContexts;
    [Parameter]
    public Guid? SessionIds { get; set; }
    [Parameter]
    public Guid? SessionId { get; set; }
    public int ActiveTabIndex { get; set; } = 0;
    private bool loading;
    public bool IsDescriptionOpen { get; set; } = false; public bool IsSectionInfoOpen { get; set; } = false; public bool IsTooltipInfoOpen { get; set; } = false;
    private DynamicForm _dynamicform;
    private DynamicFormData _dynamicformData;
    private string MyID = Guid.NewGuid().ToString();
    private AttributeHeaderListModel _AttributeHeader;
    Object Data { get; set; } = new Object(); Object SpinData { get; set; } = new Object();
    DynamicFormProfile Datas = new DynamicFormProfile();
    DynamicFormData dynamicFormData = new DynamicFormData();
    public ApplicationUser applicationUser { get; private set; }
    public long? dynamicFormDataId { get; set; }
    bool isApproval { get; set; } = false; bool PopupUpload { get; set; } = false;
    bool isApprovedPopup { get; set; } = false;
    bool isApproved { get; set; } = true;
    bool isVisibleButton { get; set; } = true;
    bool IsSendApproval { get; set; } = false;
    bool IsSendApprovalVisible { get; set; } = true; bool AddEnabled { get; set; } = false;
    bool IsApprovalApproved { get; set; } = false;
    bool IsApprovalRejected { get; set; } = false; bool IsUploadEnabled { get; set; } = false;
    bool IsSave { get; set; } = true; bool IsApprovalSave { get; set; } = true;
    string? ApproveName { get; set; } = "Approve";
    string? RejectName { get; set; } = "Reject";
    string? ApproveRejectName { get; set; } = "Approve";
    private DynamicFormApproved dynamicFormApproval = new DynamicFormApproved();
    private List<DynamicFormApproved>? _dynamicFormApprovedList;
    private List<DynamicFormWorkFlowForm>? _dynamicFormWorkFlowFormList;
    public List<DynamicFormWorkFlowForm> _dynamicFormWorkFlowFormListItems = new List<DynamicFormWorkFlowForm>();
    public long? FileProfileTypeId { get; set; }
    public Guid? FileProfileSessionId { get; set; }
    int isRequiredCount { get; set; } = 0;
    bool? isSubmit { get; set; } = false;
    Dictionary<string, string> dic = new Dictionary<string, string>();
    bool isApprovalEnabled { get; set; } = false;
    // bool isApproved { get; set; } = true;
    private List<ViewPlants>? _plantItems;
    private List<ViewDivision>? _divisionItems;
    private List<ViewDepartment>? _departmentItems;
    private List<ViewSection>? _sectionItems;
    private List<ViewSubSection>? _subSectionItems;
    bool isPlant { get; set; } = false;
    bool isDivision { get; set; } = false; bool isDepartment { get; set; } = false;
    bool isSection { get; set; } = false; bool isSubSection { get; set; } = false;
    public DocumentProfileNoSeriesModel documentProfileNoSeriesData { get; set; }
    public string? isButtonClick { get; set; }
    private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSection;
    private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSectionNoWorkFlow; private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSectionNoWorkFlowSection; private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSectionNoWorkFlowSectionItems;
    private List<int?> _sequenceNoList = new List<int?>();
    bool isWorkflowEnabled { get; set; } = false; bool WithWorkFlowStartPopup { get; set; } = false;
    string? randomNum { get; set; }
    public List<DynamicFormSection> _dynamicFormSectionList { get; set; }
    public List<Type?> DataClassTypeList = new List<Type?>(); public List<string?> DataClassObjectNameList = new List<string?>();
    public List<AddTempSectionAttribute> addTempSectionAttributes = new List<AddTempSectionAttribute>();
    public List<DynamicFormDataUploadByPermission> DynamicFormDataUploadByPermissions = new List<DynamicFormDataUploadByPermission>();
    dynamic? jsonObjs = null; string? plantCode = null; List<string?> plantNames = new List<string?>() { "SWMY", "SWSG" }; List<long> plantIds = new List<long>();
    private List<AttributeDetails>? PlantDependencySubAttributeDetails { get; set; } = new List<AttributeDetails>();
    private List<AttributeDetails>? ApplicationMasterParentDetails { get; set; } = new List<AttributeDetails>();
    public List<string?> soCustomerType { get; set; } = new List<string?>() { "Clinic", "Vendor", "Customer", "RawMatItem", "PackagingItem", "ProcessItem" };
    public string? _longInUser { get; set; } = string.Empty; public string? _longInCompany { get; set; } = string.Empty; public string? _longInDateTime { get; set; }
    public string? _longInUserPrint { get; set; } = string.Empty; public string? _longInCompanyPrint { get; set; } = string.Empty; public string? _longInDateTimePrint { get; set; } = string.Empty;
    public string? _longInAddedByPrint { get; set; } = string.Empty;
    private ViewEmployee _userEmployee; public string? _longInAddedBy { get; set; } = string.Empty; bool AddButtonnEnabled { get; set; } = true;
    private DynamicFormSection _filterDynamicFormSection;
    private DynamicFormSectionAttribute _filterDynamicFormSectionAttribute;
    private List<AttributeFilterDetails> _attributeFilterDetailsList { get; set; } = new List<AttributeFilterDetails>();
    public object? DynamicGridObjectData { get; set; }
    public List<DropDownGridOptionsModel> DynamicGridDropDownGridOptionsModel { get; set; } = new List<DropDownGridOptionsModel>();
    public List<DynamicFormData> DynamicGridDynamicFormData { get; set; } = new List<DynamicFormData>();
    private List<long?> _DynamicFormSectionIds = new List<long?>();
    private List<DynamicFormSectionAttributeSection?> dynamicFormSectionAttributeSectionSelected = new List<DynamicFormSectionAttributeSection>();
    bool isLocked { get; set; } = false; string? LockedName { get; set; } = "Lock"; string? fafaunlock { get; set; } = "fa fa-lock"; bool isUserLocked { get; set; } = false; bool lockpopup { get; set; } = false;
    bool EditEnabledApproval { get; set; } = false; public List<DynamicFormWorkFlowApprovedForm> _dynamicFormWorkFlowApprovedFormList { get; set; }
    public DynamicFormWorkFlowApprovedForm _dynamicFormWorkFlowApprovedFormOne { get; set; }
    bool IsSectionLockOpen { get; set; } = false; public string? SectionLockedName { get; set; } = ""; public string? DynamicSectionName { get; set; }
    bool createEmailpopup { get; set; } = false; bool emailEnabled { get; set; } = false; public DynamicFormSection dynamicFormSectionData { get; set; }
    Object DataGridObject { get; set; } = new Object(); private List<DropDownBoxGridModel> _DropDownBoxGridModel = new List<DropDownBoxGridModel>();
    bool QrCodePopupVisible { get; set; } = false; private BarcodeReader _QrCodeReader; public PropertyInfo? PropertyQrCodeInfo { get; set; }
    public List<DynamicFormDataAttrUpload> _DynamicFormDataAttrUploadList { get; set; } = new List<DynamicFormDataAttrUpload>();
    protected override async Task OnInitializedAsync()
    {
        _editContext = new EditContext(Data);
        _editContexts = new EditContext(Datas);
        applicationUser = await _localStorageService.GetItem<ApplicationUser>("user");
        Random rnd = new Random();
        randomNum = "Info-" + rnd.Next(1000).ToString();
        _plantItems = await Mediator.Send(new GetAllPlantQuery());
        if (applicationUser != null)
        {
            _userEmployee = await Mediator.Send(new GetEmployeeFormByUserId(applicationUser.UserID));
        }
        AddMenuEnabled();
    }
    void OnRowApprovalClick1(GridFocusedRowChangedEventArgs args)
    {
        _selectedDynamicFormWorkFlowItems = (DynamicFormWorkFlowSection)args.DataItem;
    }
    void OnCheckedAllValueChanged(bool radioValue)
    {
        CheckedAll = radioValue;
        if (_dynamicFormWorkFlowSectionNoWorkFlowSection != null && _dynamicFormWorkFlowSectionNoWorkFlowSection.Count() > 0)
        {
            _dynamicFormWorkFlowSectionNoWorkFlowSection.ForEach(s =>
            {
                s.Checked = radioValue;
            });
        }
    }
    void openFormGridLists(DynamicFormWorkFlowSection dynamicFormWorkFlow)
    {
        IsRenameOpens = true;
        DynamicFormWorkFlowMultipleUsers = dynamicFormWorkFlow.DynamicFormWorkFlowMultipleUsers;
    }
    void onClickWorkFlowApprove()
    {
        dynamicFormWorkFlowApprovedForm.DynamicFormWorkFlowApprovedFormID = _dynamicFormWorkFlowApprovedFormOne.DynamicFormWorkFlowApprovedFormID;
        dynamicFormWorkFlowApprovedForm.IsApproved = true;
        dynamicFormWorkFlowApprovedForm.ApprovedDate = DateTime.Now;
        dynamicFormWorkFlowApprovedForm.ApprovedByUserID = applicationUser.UserID;
        ApproveRejectWokFlowName = "Approve";
        IsWokFlowDescriptionOpen = true;
        IsDescriptionOpen = false;
    }
    void Grid_CustomizeElement(GridCustomizeElementEventArgs e)
    {
        if (e.ElementType == GridElementType.DataRow && e.VisibleIndex % 2 == 1)
        {
            e.CssClass = "alt-item";
        }
    }
    void onClickWorkFlowReject()
    {
        dynamicFormWorkFlowApprovedForm.DynamicFormWorkFlowApprovedFormID = _dynamicFormWorkFlowApprovedFormOne.DynamicFormWorkFlowApprovedFormID;
        dynamicFormWorkFlowApprovedForm.IsApproved = false;
        dynamicFormWorkFlowApprovedForm.ApprovedDate = DateTime.Now;
        dynamicFormWorkFlowApprovedForm.ApprovedByUserID = applicationUser.UserID;
        ApproveRejectWokFlowName = "Reject"; IsWokFlowDescriptionOpen = true; IsDescriptionOpen = false;
    }
    async Task OnUpdateWorkFlowDescription()
    {
        var result = await Mediator.Send(new UpdateDynamicFormWorkFlowApprovedFormByUser(dynamicFormWorkFlowApprovedForm));
        if (result.DynamicFormWorkFlowApprovedFormID > 0)
        {
            IsWokFlowDescriptionOpen = false; IsDescriptionOpen = false;
            toastService.ShowToast("Work Flow Approval Updated.", AC.SD.Core.Services.ToastLevel.Success);
            await loadDynamicForm();
        }
    }
    void ExpandedChanged(bool NewExpanded)
    {
        isMainHeader = NewExpanded;
        StateHasChanged();
    }
    async Task addAuditTrail()
    {
        if (_dynamicformData != null)
        {
            createAuditpopup = true;
        }
    }
    async Task openPrintForm()
    {
        string str = NavigationManager.Uri;
        string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();
        string[] UrlList = rep1.Split("/");
        string names = "DynamicMasterSetupList";
        if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names.ToLower())
        {
            var url = NavigationManager.BaseUri + "DynamicMasterSetupList/dynamicPrintForm/" + SessionId + "/" + SessionIds;
            await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
        }
        else
        {
            string names1 = "dynamicFormMenuList";
            if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names1.ToLower())
            {
                var url = NavigationManager.BaseUri + "dynamicFormMenuList/dynamicPrintForm/" + SessionId + "/" + SessionIds;
                await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
            }
            else
            {
                var url = NavigationManager.BaseUri + "DynamicMasterSetup/dynamicPrintForm/" + SessionId + "/" + SessionIds;
                await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
            }

        }
    }
    public async Task PrintForm()
    {
        var isplantPrint = isMainHeader;
        isPrint = true; isMainHeader = true; colSpanMd = 6;
        CreateEditFormFields();
        await JSRuntime.InvokeAsync<string>("showLoading");
        toastService.ShowToast("Pls Wait Form Print Generating.", AC.SD.Core.Services.ToastLevel.Success);
        mainStyle = ""; displayNonePrintForm = "";
        StateHasChanged();
        await Task.Delay(1000);
        var result = await JSRuntime.InvokeAsync<string>("htmlpdfGenerate");
        if (result == "ok")
        {
            mainStyle = "overflow-x: hidden;overflow-y: auto;height: calc(100vh - 280px);";
            toastService.ShowToast("Print Form Generated.", AC.SD.Core.Services.ToastLevel.Success);
            isPrint = false; isMainHeader = isplantPrint; colSpanMd = 3; IsPrintWithoutGridForm = false;
            CreateEditFormFields();
            await JSRuntime.InvokeAsync<string>("hideLoading");
        }
        displayNonePrintForm = "display:none;";
        StateHasChanged();
    }
    public async Task PrintWithoutGridForm()
    {
        IsPrintWithoutGridForm = true; StateHasChanged();
        await PrintForm();
    }
    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            DynamicFormPage6 =
                NavigationManager.RegisterLocationChangingHandler(OnLocationChanging);
        }
    }

    private ValueTask OnLocationChanging(LocationChangingContext context)
    {
        if (context.TargetLocation == "/counter")
        {
            context.PreventNavigation();
        }

        return ValueTask.CompletedTask;
    }
    void BackApprovalForm()
    {

        StateHasChanged();
    }
    public async ValueTask DisposeAsync()
    {
        // System.GC.Collect();
        // DynamicFormPage6?.Dispose();
        // refUploadDoumentDynamicFiles?.DisposeAsync();
        // refDynamicFormDataWorkFlowFormList?.DisposeAsync();
        // refDynamicFormFilterByForm?.DisposeAsync();
        // refDynamicFormApprovedFormList?.DisposeAsync();
        // dynamicFormWorkFlowApprovedForm = new DynamicFormWorkFlowApprovedForm();
        // DynamicFormWorkFlowItems = null;
        // _dynamicform = null;
        // _dynamicformData = null;
        // _AttributeHeader = null;
        // if (Data != null)
        // {
        //     Data = null;
        // }
        // if (SpinData != null)
        // {
        //     SpinData = null;
        // }
        // dynamicFormData = new DynamicFormData();
        // dynamicFormApproval = new DynamicFormApproved();
        // _dynamicFormApprovedList?.Clear();
        // dic = new Dictionary<string, string>();
        // _plantItems?.Clear();
        // _divisionItems?.Clear();
        // _departmentItems?.Clear();
        // _sectionItems?.Clear();
        // _subSectionItems?.Clear();
        // documentProfileNoSeriesData = null;
        // Datas = new DynamicFormProfile();
        // _dynamicFormWorkFlowSection?.Clear();
        // _dynamicFormWorkFlowSectionNoWorkFlow?.Clear();
        // _sequenceNoList?.Clear();
        // _dynamicFormWorkFlowFormList?.Clear();
        // _dynamicFormSectionList?.Clear();
        // DynamicFormInfoSection = new DynamicFormSection();
        // DataClassTypeList?.Clear(); DataClassObjectNameList?.Clear();
        // addTempSectionAttributes?.Clear();
        // DynamicFormDataUploadByPermissions?.Clear();
        // jsonObjs = null;
        // plantNames?.Clear(); plantIds?.Clear();
        // PlantDependencySubAttributeDetails?.Clear();
        // ApplicationMasterParentDetails?.Clear();
        // soCustomerType?.Clear();
        // _userEmployee = null;
        // _filterDynamicFormSection = null;
        // _filterDynamicFormSectionAttribute = null;
        // _attributeFilterDetailsList?.Clear();
        // _DynamicFormSectionIds?.Clear();
        // dynamicFormSectionAttributeSectionSelected?.Clear();
        // _dynamicFormWorkFlowFormListItems?.Clear();
        // _dynamicFormWorkFlowApprovedFormList?.Clear();
        // _dynamicFormWorkFlowApprovedFormOne = null; dynamicFormSectionData = null;
        // GC.SuppressFinalize(this);
    }

    void EulaPopupDynamicFormFilterByClosed()
    {
        DynamicFormFilterBypopup = false;
        StateHasChanged();
    }
    void AddMenuEnabled()
    {
        AddButtonnEnabled = true;
        string str = NavigationManager.Uri;
        string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();
        string[] UrlList = rep1.Split("/");
        string names = "DynamicMasterSetupList";
        if (UrlList[0].ToLower() == "DynamicFormWorkFlowList".ToLower())
        {
            AddButtonnEnabled = false;
        }
        else if (UrlList[0].ToLower() == "DynamicFormApprovedMainList".ToLower())
        {
            AddButtonnEnabled = false;
        }
        else
        {
        }
        StateHasChanged();
    }
    string GetQueryParm(string parmName)
    {
        var uriBuilder = new UriBuilder(NavigationManager.Uri);
        var q = System.Web.HttpUtility.ParseQueryString(uriBuilder.Query);
        return q[parmName] ?? "";
    }
    protected override async Task OnParametersSetAsync()
    {
        if (applicationUser != null)
        {
            await loadDynamicForm();
        }
        base.OnParametersSet();
    }
    async Task onshowLoading()
    {
        //await JSRuntime.InvokeAsync<string>("showLoading");
    }
    async Task onhideLoading()
    {
        // await JSRuntime.InvokeAsync<string>("hideLoading");
    }
    async Task updateIpirApp()
    {
        if (_dynamicformData?.DynamicFormDataId > 0)
        {
            string? IpirSessionId = GetQueryParm("SessionId");
            string? IpirTypeName = GetQueryParm("Type");
            if (!string.IsNullOrEmpty(IpirTypeName))
            {
                long? IpirType = (long?)Convert.ToInt64(IpirTypeName);
                if (IpirType > 0)
                {
                    if (!string.IsNullOrEmpty(IpirSessionId))
                    {
                        bool isValid = Guid.TryParse(IpirSessionId, out _);
                        if (isValid == true)
                        {
                            var sessid = new Guid(IpirSessionId);
                            await Mediator.Send(new UpdateDynamicFormDataIssueDetails(sessid, IpirType, _dynamicformData?.DynamicFormDataId));
                        }
                    }
                }
            }
        }
    }
    async Task PermissionCheckFor()
    {
        if (_dynamicform != null && _dynamicform.ID > 0)
        {
            AddPermissionEnabled = false; DeletePermissionEnabled = false; EditPermissionEnabled = false;
            var result = await Mediator.Send(new GetDynamicFormPermissionCheck(_dynamicform.ID, applicationUser.UserID));
            if (result != null)
            {
                AddPermissionEnabled = result.IsAdd.GetValueOrDefault(true);
                DeletePermissionEnabled = result.IsDelete.GetValueOrDefault(true);
                EditPermissionEnabled = result.IsEdit.GetValueOrDefault(true);
            }
        }
    }
    async Task loadDynamicForm()
    {
        await onshowLoading();

        _DropDownBoxGridModel = new List<DropDownBoxGridModel>(); _DynamicFormDataAttrUploadList = new List<DynamicFormDataAttrUpload>(); dynamicFormSectionAttrFormulaFunction1 = new DynamicFormSectionAttrFormulaFunction();
        IsDynamicGridForm = false; IsPrintWithoutGridForm = false; isPrint = false; colSpanMd = 3; isMainHeader = false; EditEnabled = false;
        _dynamicformData = null; _dynamicFormApprovedList = null; _dynamicFormWorkFlowSection = null; _dynamicFormSectionList = null; isLocked = false; LockedName = "Lock"; fafaunlock = "fa fa-lock"; isUserLocked = false; emailEnabled = false;
        bool? deleted = false; addTempSectionAttributes = new List<AddTempSectionAttribute>(); EditEnabledApproval = false; dynamicFormWorkFlowApprovedForm = new DynamicFormWorkFlowApprovedForm(); ApproveRejectWokFlowName = "Approve";
        IsWorkflowApprovalRejected = false; IsWokFlowDescriptionOpen = false; workflowStyle = "display:none;"; _dynamicFormWorkFlowApprovedFormOne = new DynamicFormWorkFlowApprovedForm();
        _dynamicform = await Mediator.Send(new GetAllDynamicFormList(SessionId, _dynamicformData?.DynamicFormDataId));
        _dynamicFormWorkFlowFormList = await Mediator.Send(new GetDynamicFormWorkFlowFormList(_dynamicform.ID, null));
        _longInUser = applicationUser.UserName; _longInAddedBy = applicationUser.UserName; _longInDateTime = Application.Common.Helper.Helper.FormatDateTime(DateTime.Now); _dynamicFormWorkFlowApprovedFormList = new List<DynamicFormWorkFlowApprovedForm>();
        _DynamicFormSectionIds = new List<long?>(); dynamicFormSectionAttributeSectionSelected = new List<DynamicFormSectionAttributeSection>(); _dynamicFormWorkFlowSectionNoWorkFlow = new List<DynamicFormWorkFlowSection>();
        _attributeFilterDetailsList = new List<AttributeFilterDetails>(); _dynamicFormWorkFlowSectionNoWorkFlowSectionItems = new List<DynamicFormWorkFlowSection>();
        if (_userEmployee != null)
        {
            _longInCompany = _userEmployee.CompanyName;
        }
        if (_dynamicform != null)
        {
            await PermissionCheckFor();
            AddEnabled = true; plantIds = new List<long>(); plantCode = null;
            ActiveTabIndex = 0; isApproval = false; isApproved = true; IsSendApproval = false; IsSendApprovalVisible = false; ApproveRejectName = "Approve"; isButtonClick = "";
            IsApprovalApproved = false; IsApprovalRejected = false; IsApprovalSave = false; IsDescriptionOpen = false; isSubmit = false; isWorkflowEnabled = false; isSaveEnabled = true;
            dynamicFormApproval = new DynamicFormApproved(); dynamicFormData = new DynamicFormData(); isApprovalEnabled = false;
            _dynamicformData = null; isVisibleButton = true; IsSave = true; IsUploadEnabled = false; //_dynamicFormWorkFlowFormList = new List<DynamicFormWorkFlowForm>();
            if (SessionId != null)
            {

                if (_dynamicform != null)
                {

                    plantCode = string.IsNullOrEmpty(_dynamicform.CompanyName) ? null : _dynamicform.CompanyName.ToLower();


                    if (_dynamicform.IsApproval == true)
                    {
                        isApprovalEnabled = true;
                        StateHasChanged();
                    }
                    FileProfileSessionId = _dynamicform.FileProfileSessionId;
                    FileProfileTypeId = _dynamicform.FileProfileTypeId;
                    if (SessionIds != null)
                    {
                        _dynamicformData = await Mediator.Send(new GetDynamicFormDataBySessionAllId(SessionIds));
                        if (_dynamicformData != null)
                        {
                            isUserLocked = true; emailEnabled = true; EditEnabled = true;
                            if (_dynamicformData.IsLocked == true && _dynamicformData.LockedUserId > 0)
                            {
                                LockedName = "UnLock"; fafaunlock = "fa fa-unlock";
                                if (_dynamicformData.LockedUserId != applicationUser.UserID)
                                {
                                    emailEnabled = false;
                                    isLocked = true; isUserLocked = false;
                                }
                            }
                            _longInAddedBy = _dynamicformData?.AddedBy; _longInDateTime = Application.Common.Helper.Helper.FormatDateTime(_dynamicformData?.AddedDate == null ? DateTime.Now : _dynamicformData?.AddedDate);
                            var _dynamicFormWorkFlowFormListss = Task.Factory.StartNew(() => Mediator.Send(new GetDynamicFormWorkFlowFormList(_dynamicformData.DynamicFormId, _dynamicformData.DynamicFormDataId)));
                            var _dynamicFormApprovedLists = Task.Factory.StartNew(() => Mediator.Send(new GetDynamicFormApprovedList(_dynamicformData.DynamicFormDataId)));
                            var _dynamicFormWorkFlowSections = Task.Factory.StartNew(() => Mediator.Send(new GetDynamicFormWorkFlowExits(_dynamicform.ID, applicationUser.UserID, _dynamicformData?.DynamicFormDataId)));
                            var _dynamicFormSectionLists = Task.Factory.StartNew(() => Mediator.Send(new GetDynamicFormSectionById(_dynamicformData.DynamicFormId, applicationUser.UserID, _dynamicformData.DynamicFormDataId)));
                            var _dynamicFormWorkFlowApprovedFormLists = Task.Factory.StartNew(() => Mediator.Send(new GetDynamicFormWorkFlowApprovedFormList(_dynamicformData.DynamicFormDataId)));
                            await Task.WhenAll(_dynamicFormWorkFlowFormListss, _dynamicFormApprovedLists, _dynamicFormWorkFlowSections, _dynamicFormSectionLists, _dynamicFormWorkFlowApprovedFormLists);
                            _dynamicFormWorkFlowFormList = await _dynamicFormWorkFlowFormListss.Result;
                            _dynamicFormApprovedList = await _dynamicFormApprovedLists.Result;
                            _dynamicFormWorkFlowSection = await _dynamicFormWorkFlowSections.Result;
                            _dynamicFormSectionList = await _dynamicFormSectionLists.Result;
                            _dynamicFormWorkFlowApprovedFormList = await _dynamicFormWorkFlowApprovedFormLists.Result;
                            Datas.ProfileNo = _dynamicformData?.ProfileNo;
                            IsUploadEnabled = true;

                            CheckedApprovalData();

                        }
                        else
                        {
                            AddEnabled = false; ActiveTabIndex = 0; isApproval = false; isApproved = false; IsSendApproval = false; IsSendApprovalVisible = false; ApproveRejectName = "Approve"; isButtonClick = "";
                            IsApprovalApproved = false; IsApprovalRejected = false; IsApprovalSave = false; IsDescriptionOpen = false; isSubmit = false; isWorkflowEnabled = false; isSaveEnabled = false;
                            isApprovalEnabled = false; isVisibleButton = false; IsSave = false; IsUploadEnabled = false;
                            deleted = true;
                        }
                    }
                    else
                    {
                        if (_dynamicform.IsApproval == true && _dynamicform.DynamicFormApproval != null && _dynamicform.DynamicFormApproval.Count > 0)
                        {
                            var isNotApproved = _dynamicform.DynamicFormApproval.OrderBy(o => o.SortOrderBy).FirstOrDefault(f => f.ApprovalUserId == applicationUser.UserID)?.ApprovalUserId;
                            if (isNotApproved == applicationUser.UserID)
                            {
                                isApproval = false;
                            }
                        }
                    }

                }
                workflowStyle = "display:none;";
                IsWorkflowApprovalApproved = false; IsWorkflowApprovalRejected = false;
                if (deleted == false)
                {
                    if (_dynamicform != null)
                    {
                        if (_dynamicformData == null)
                        {
                            isSaveEnabled = true;
                        }
                        if (_dynamicformData != null)
                        {
                            if (_dynamicFormWorkFlowSection != null && _dynamicFormWorkFlowSection.Count() > 0)
                            {
                                bool? isGoWorkFlow = true;
                                var Completed = _dynamicFormWorkFlowSection.Where(w => w.IsWorkFlowDone == 1).OrderBy(x => x.SequenceNo).ToList();
                                if (Completed.Count() > 0)
                                {
                                    var first = Completed.FirstOrDefault();
                                    if (first != null)
                                    {
                                        var _dynamicFormWorkFlowApprovedFormListItems = _dynamicFormWorkFlowApprovedFormList.Where(w => w.DynamicFormWorkFlowFormID == first.DynamicFormWorkFlowFormId).ToList();
                                        if (_dynamicFormWorkFlowApprovedFormListItems != null && _dynamicFormWorkFlowApprovedFormListItems.Count() > 0)
                                        {
                                            var totalApp = _dynamicFormWorkFlowApprovedFormListItems.Count();
                                            var pendingApproval = _dynamicFormWorkFlowApprovedFormListItems.Where(w => w.IsApproved != true).Count();
                                            var completedApproval = _dynamicFormWorkFlowApprovedFormListItems.Where(w => w.IsApproved == true).Count();
                                            if (pendingApproval > 0)
                                            {
                                                if (totalApp != completedApproval)
                                                {
                                                    isGoWorkFlow = false;
                                                }
                                            }
                                        }
                                    }
                                }
                                // if (isGoWorkFlow == true)
                                //{
                                _sequenceNoList = _dynamicFormWorkFlowSection.Where(w => w.IsWorkFlowFormDone == 0).Select(q => q.SequenceNo).Distinct().OrderBy(x => x).ToList();
                                var notCompleted = _dynamicFormWorkFlowSection.Where(w => w.IsWorkFlowFormDone == 0).OrderBy(x => x.SequenceNo).ToList();
                                if (_sequenceNoList.Count() > 0)
                                {

                                    var IsParallelWorkflowCount = _dynamicFormWorkFlowSection.Where(w => w.IsParallelWorkflow == true).Count();
                                    if (IsParallelWorkflowCount > 0)
                                    {
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = notCompleted.Where(w => w.SequenceNo == itemss && w.IsParallelWorkflow == true).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                notdata.ForEach(n =>
                                                {
                                                    if (n.FlowStatusID == 0)
                                                    {
                                                        _dynamicFormWorkFlowSectionNoWorkFlow.Add(n);
                                                    }
                                                    if (n.FlowStatusID == 1 && n.DynamicFormWorkFlowFormTotalCount > 0 && n.DynamicFormWorkFlowFormTotalCount != n.DynamicFormWorkFlowFormCount)
                                                    {
                                                        _dynamicFormWorkFlowSectionNoWorkFlow.Add(n);
                                                    }
                                                });
                                            }
                                        }
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = notCompleted.Where(w => w.SequenceNo == itemss && w.IsParallelWorkflow == false).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                _dynamicFormWorkFlowSectionNoWorkFlow.AddRange(notdata);
                                                break;

                                            }
                                        }
                                    }
                                    else
                                    {
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = notCompleted.Where(w => w.SequenceNo == itemss).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                _dynamicFormWorkFlowSectionNoWorkFlow = notdata;
                                                break;

                                            }
                                        }
                                    }
                                }
                                isWorkflowEnabled = false; isSaveEnabled = false; isApprovalEnabled = false; isVisibleButton = false; IsUploadEnabled = false;
                                if (notCompleted != null && notCompleted.Count() > 0)
                                {
                                    if (_dynamicform.IsApproval == true)
                                    {
                                        isApprovalEnabled = true;
                                        isVisibleButton = true;
                                        if (_dynamicformData != null)
                                        {
                                            CheckedApprovalData();
                                        }
                                    }
                                    if (_dynamicformData == null)
                                    {
                                        isSaveEnabled = true;
                                    }
                                    var IsParallelWorkflowCount = notCompleted.Where(w => w.IsParallelWorkflow == true).Count();
                                    if (IsParallelWorkflowCount > 0)
                                    {
                                        bool shouldEnableWorkflow = false;
                                        var exitss = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0);
                                        if (exitss != null && exitss?.IsMultipleUser == true && exitss?.IsWorkFlowDone == 0 && exitss?.DynamicFormWorkFlowMultipleUsers?.Any(q => q.UserId == applicationUser.UserID) == true)
                                        {
                                            shouldEnableWorkflow = true;
                                        }
                                        else
                                        {
                                            var exitsUser = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.UserId == applicationUser.UserID);
                                            if (exitsUser != null)
                                            {
                                                shouldEnableWorkflow = true;
                                            }
                                            else
                                            {
                                                var isAnomalous = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.IsAnomalyStatus == true);
                                                if (isAnomalous != null)
                                                {
                                                    shouldEnableWorkflow = true;
                                                }
                                            }
                                        }

                                        // Apply common actions
                                        if (shouldEnableWorkflow)
                                        {
                                            isWorkflowEnabled = true;
                                            isSaveEnabled = true;

                                            if (_dynamicformData != null)
                                            {
                                                IsUploadEnabled = true;
                                            }
                                        }

                                    }
                                    else
                                    {
                                        bool shouldEnableWorkflow = false;
                                        var exitss = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0);
                                        if (exitss != null)
                                        {
                                            if (exitss?.IsMultipleUser == true && exitss?.DynamicFormWorkFlowMultipleUsers?.Any(q => q.UserId == applicationUser.UserID) == true)
                                            {
                                                shouldEnableWorkflow = true;
                                            }
                                            else
                                            {
                                                var exitsUser = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.UserId == applicationUser.UserID);
                                                if (exitsUser != null)
                                                {
                                                    shouldEnableWorkflow = true;
                                                }
                                                else
                                                {
                                                    var isAnomalous = notCompleted.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.IsAnomalyStatus == true);
                                                    if (isAnomalous != null)
                                                    {
                                                        shouldEnableWorkflow = true;
                                                    }
                                                }
                                            }

                                            // Apply common actions if eligible
                                            if (shouldEnableWorkflow)
                                            {
                                                isWorkflowEnabled = true;
                                                isSaveEnabled = true;

                                                if (_dynamicformData != null)
                                                {
                                                    IsUploadEnabled = true;
                                                }
                                            }
                                        }
                                    }
                                }

                                // }
                                _dynamicFormWorkFlowApprovedFormOne = new DynamicFormWorkFlowApprovedForm();
                                if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count() > 0)
                                {
                                    var IsParallelWorkflowss = _dynamicFormWorkFlowSectionNoWorkFlow.Where(f => f.IsWorkFlowFormDone == 0 && f.IsParallelWorkflow == true).Count();
                                    if (IsParallelWorkflowss > 0)
                                    {
                                        var notapprovalExits = _dynamicFormWorkFlowApprovedFormList.FirstOrDefault(f => f.IsApproved != true);
                                        if (notapprovalExits != null && notapprovalExits.FlowStatusID == 1)
                                        {
                                            _dynamicFormWorkFlowApprovedFormOne = notapprovalExits;
                                            if (notapprovalExits.UserID == applicationUser.UserID)
                                            {
                                                workflowStyle = "";
                                                IsWorkflowApprovalApproved = true;
                                                IsWorkflowApprovalRejected = true;
                                            }
                                        }
                                        // var notapprovalExits = _dynamicFormWorkFlowApprovedFormList.FirstOrDefault(f => f.IsApproved != true && f.FlowStatusID == 1 && f.UserID == applicationUser.UserID);
                                        // if (notapprovalExits != null)
                                        // {
                                        //     if (notapprovalExits.UserID == applicationUser.UserID)
                                        //     {
                                        //         _dynamicFormWorkFlowApprovedFormOne = notapprovalExits;
                                        //         workflowStyle = "";
                                        //         IsWorkflowApprovalApproved = true;
                                        //         IsWorkflowApprovalRejected = true;
                                        //     }
                                        // }
                                    }
                                    else
                                    {
                                        var notapprovalExits = _dynamicFormWorkFlowApprovedFormList.FirstOrDefault(f => f.IsApproved != true);
                                        if (notapprovalExits != null && notapprovalExits.FlowStatusID == 1)
                                        {
                                            _dynamicFormWorkFlowApprovedFormOne = notapprovalExits;
                                            if (notapprovalExits.UserID == applicationUser.UserID)
                                            {
                                                workflowStyle = "";
                                                IsWorkflowApprovalApproved = true;
                                                IsWorkflowApprovalRejected = true;
                                            }
                                        }
                                    }
                                }
                                if (isGoWorkFlow == false)
                                {
                                    // _dynamicFormWorkFlowSectionNoWorkFlow = new List<DynamicFormWorkFlowSection>();
                                }
                            }
                        }
                        else
                        {
                            if (_dynamicFormWorkFlowFormList != null && _dynamicFormWorkFlowFormList.Count() > 0)
                            {
                                _dynamicFormWorkFlowSectionNoWorkFlow = new List<DynamicFormWorkFlowSection>();
                                _sequenceNoList = _dynamicFormWorkFlowFormList.Select(q => q.SequenceNo).Distinct().OrderBy(x => x).ToList();
                                if (_sequenceNoList.Count() > 0)
                                {
                                    var IsParallelWorkflowCount = _dynamicFormWorkFlowFormList.Where(w => w.IsParallelWorkflow == true).Count();
                                    if (IsParallelWorkflowCount > 0)
                                    {
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = _dynamicFormWorkFlowFormList.Where(w => w.SequenceNo == itemss && w.IsParallelWorkflow == true).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                notdata.ForEach(n =>
                                                {
                                                    bool shoulEnabled = false;
                                                    if (n.IsMultipleUser == true && n.DynamicFormWorkFlowMultipleUsers != null && n.DynamicFormWorkFlowMultipleUsers.Any(q => q.UserId == applicationUser.UserID) == true)
                                                    {
                                                        shoulEnabled = true;
                                                    }
                                                    else
                                                    {
                                                        if (n.UserId == applicationUser.UserID)
                                                        {
                                                            shoulEnabled = true;
                                                        }
                                                        else
                                                        {
                                                            if (n.IsAnomalyStatus == true)
                                                            {
                                                                shoulEnabled = true;
                                                            }
                                                        }
                                                    }
                                                    if (shoulEnabled)
                                                    {
                                                        DynamicFormWorkFlowSection dynamicFormWorkFlowSectionDatas = new DynamicFormWorkFlowSection();
                                                        dynamicFormWorkFlowSectionDatas.DynamicFormSectionId = n.DynamicFormSectionId;
                                                        dynamicFormWorkFlowSectionDatas.UserId = n.DynamicFormWorkFlowUserId;
                                                        dynamicFormWorkFlowSectionDatas.SectionName = n.SectionName;
                                                        dynamicFormWorkFlowSectionDatas.IsAnomalyStatus = n.IsAnomalyStatus;
                                                        dynamicFormWorkFlowSectionDatas.IsMultipleUser = n.IsMultipleUser;
                                                        dynamicFormWorkFlowSectionDatas.IsParallelWorkflow = n.IsParallelWorkflow;
                                                        dynamicFormWorkFlowSectionDatas.IsAllowDelegateUser = n.IsAllowDelegateUser;
                                                        dynamicFormWorkFlowSectionDatas.IsWorkFlowDone = 0;
                                                        dynamicFormWorkFlowSectionDatas.SequenceNo = n.SequenceNo;
                                                        dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormId = n.DynamicFormWorkFlowId;
                                                        dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowMultipleUsers = n.DynamicFormWorkFlowMultipleUsers;
                                                        dynamicFormWorkFlowSectionDatas.CurrentApprovalUserName = n.CurrentApprovalUserName;
                                                        dynamicFormWorkFlowSectionDatas.IsDynamicFormWorkFlowApproval = n.IsDynamicFormWorkFlowApproval;
                                                        dynamicFormWorkFlowSectionDatas.ApprovedStatus = n.ApprovedStatus;
                                                        dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormCount = n.DynamicFormWorkFlowFormCount;
                                                        dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormTotalCount = n.DynamicFormWorkFlowFormTotalCount;
                                                        _dynamicFormWorkFlowSectionNoWorkFlow.Add(dynamicFormWorkFlowSectionDatas);
                                                    }

                                                });
                                                isWorkflowEnabled = true;
                                            }
                                        }
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = _dynamicFormWorkFlowFormList.Where(w => w.SequenceNo == itemss && w.IsParallelWorkflow == false).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                notdata.ForEach(n =>
                                                {
                                                    DynamicFormWorkFlowSection dynamicFormWorkFlowSectionDatas = new DynamicFormWorkFlowSection();
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormSectionId = n.DynamicFormSectionId;
                                                    dynamicFormWorkFlowSectionDatas.UserId = n.DynamicFormWorkFlowUserId;
                                                    dynamicFormWorkFlowSectionDatas.SectionName = n.SectionName;
                                                    dynamicFormWorkFlowSectionDatas.IsAnomalyStatus = n.IsAnomalyStatus;
                                                    dynamicFormWorkFlowSectionDatas.IsMultipleUser = n.IsMultipleUser;
                                                    dynamicFormWorkFlowSectionDatas.IsParallelWorkflow = n.IsParallelWorkflow;
                                                    dynamicFormWorkFlowSectionDatas.IsAllowDelegateUser = n.IsAllowDelegateUser;
                                                    dynamicFormWorkFlowSectionDatas.IsWorkFlowDone = 0;
                                                    dynamicFormWorkFlowSectionDatas.SequenceNo = n.SequenceNo;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowMultipleUsers = n.DynamicFormWorkFlowMultipleUsers;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormId = n.DynamicFormWorkFlowId;
                                                    dynamicFormWorkFlowSectionDatas.CurrentApprovalUserName = n.CurrentApprovalUserName;
                                                    dynamicFormWorkFlowSectionDatas.IsDynamicFormWorkFlowApproval = n.IsDynamicFormWorkFlowApproval;
                                                    dynamicFormWorkFlowSectionDatas.ApprovedStatus = n.ApprovedStatus;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormCount = n.DynamicFormWorkFlowFormCount;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormTotalCount = n.DynamicFormWorkFlowFormTotalCount;
                                                    _dynamicFormWorkFlowSectionNoWorkFlow.Add(dynamicFormWorkFlowSectionDatas);

                                                });
                                                isWorkflowEnabled = true;
                                                break;

                                            }
                                        }
                                    }
                                    else
                                    {
                                        foreach (var itemss in _sequenceNoList)
                                        {
                                            var notdata = _dynamicFormWorkFlowFormList.Where(w => w.SequenceNo == itemss).ToList();
                                            if (notdata != null && notdata.Count > 0)
                                            {
                                                notdata.ForEach(n =>
                                                {
                                                    DynamicFormWorkFlowSection dynamicFormWorkFlowSectionDatas = new DynamicFormWorkFlowSection();
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormSectionId = n.DynamicFormSectionId;
                                                    dynamicFormWorkFlowSectionDatas.UserId = n.DynamicFormWorkFlowUserId;
                                                    dynamicFormWorkFlowSectionDatas.SectionName = n.SectionName;
                                                    dynamicFormWorkFlowSectionDatas.IsAnomalyStatus = n.IsAnomalyStatus;
                                                    dynamicFormWorkFlowSectionDatas.IsMultipleUser = n.IsMultipleUser;
                                                    dynamicFormWorkFlowSectionDatas.IsParallelWorkflow = n.IsParallelWorkflow;
                                                    dynamicFormWorkFlowSectionDatas.IsAllowDelegateUser = n.IsAllowDelegateUser;
                                                    dynamicFormWorkFlowSectionDatas.IsWorkFlowDone = 0;
                                                    dynamicFormWorkFlowSectionDatas.SequenceNo = n.SequenceNo;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowMultipleUsers = n.DynamicFormWorkFlowMultipleUsers;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormId = n.DynamicFormWorkFlowId;
                                                    dynamicFormWorkFlowSectionDatas.CurrentApprovalUserName = n.CurrentApprovalUserName;
                                                    dynamicFormWorkFlowSectionDatas.IsDynamicFormWorkFlowApproval = n.IsDynamicFormWorkFlowApproval;
                                                    dynamicFormWorkFlowSectionDatas.ApprovedStatus = n.ApprovedStatus;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormCount = n.DynamicFormWorkFlowFormCount;
                                                    dynamicFormWorkFlowSectionDatas.DynamicFormWorkFlowFormTotalCount = n.DynamicFormWorkFlowFormTotalCount;
                                                    _dynamicFormWorkFlowSectionNoWorkFlow.Add(dynamicFormWorkFlowSectionDatas);

                                                });
                                                break;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count > 0)
                        {
                            var isParr = _dynamicFormWorkFlowSectionNoWorkFlow.Where(w => w.IsParallelWorkflow == true).Count();
                            if (isParr > 0)
                            {
                                var _dynamicFormWorkFlowSectionNoWorkFlows = new List<DynamicFormWorkFlowSection>();
                                var seqList = _dynamicFormWorkFlowSectionNoWorkFlow.OrderBy(o => o.SequenceNo).Select(s => s.SequenceNo).Distinct().ToList();
                                if (seqList != null && seqList.Count() > 0)
                                {
                                    foreach (var a in seqList)
                                    {
                                        var appExits = _dynamicFormWorkFlowSectionNoWorkFlow.Where(w => w.SequenceNo == a).ToList();
                                        if (appExits != null && appExits.Count() > 0)
                                        {
                                            var ex1 = appExits.FirstOrDefault();
                                            if (ex1 != null)
                                            {
                                                if (ex1.DynamicFormWorkFlowFormTotalCount == 0)
                                                {
                                                    _dynamicFormWorkFlowSectionNoWorkFlows.AddRange(appExits);
                                                }
                                                else
                                                {
                                                    if (ex1.DynamicFormWorkFlowFormTotalCount > 0 && ex1.DynamicFormWorkFlowFormCount != ex1.DynamicFormWorkFlowFormTotalCount)
                                                    {
                                                        _dynamicFormWorkFlowSectionNoWorkFlows.AddRange(appExits);
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    _dynamicFormWorkFlowSectionNoWorkFlow = _dynamicFormWorkFlowSectionNoWorkFlows;
                                }
                            }
                            isSaveEnabled = true; isWorkflowEnabled = true;
                            if (_dynamicformData != null)
                            {
                                IsUploadEnabled = true;
                            }
                        }
                        else
                        {
                            if (_dynamicformData == null)
                            {
                                isSaveEnabled = true; isWorkflowEnabled = true;
                            }
                            else
                            {
                                isSaveEnabled = true; IsUploadEnabled = true; isWorkflowEnabled = true;
                            }
                        }
                        _dynamicFormWorkFlowFormListItems = new List<DynamicFormWorkFlowForm>();
                        if (_dynamicFormWorkFlowFormList != null && _dynamicFormWorkFlowFormList.Count() > 0)
                        {
                            var dynamicFormWorkFlowIds = _dynamicFormWorkFlowFormList.Select(z => z.DynamicFormWorkFlowId).Distinct().ToList();
                            if (dynamicFormWorkFlowIds != null && dynamicFormWorkFlowIds.Count() > 0)
                            {
                                EditEnabledApproval = true;
                                dynamicFormWorkFlowIds.ForEach(e =>
                                {
                                    DynamicFormWorkFlowForm dynamicFormWorkFlowForm = new DynamicFormWorkFlowForm();
                                    var listsItems = _dynamicFormWorkFlowFormList.Where(z => z.DynamicFormWorkFlowId == e).ToList();
                                    dynamicFormWorkFlowForm.SectionName = string.Join(",", listsItems.Select(aa => aa.SectionName).ToList());
                                    dynamicFormWorkFlowForm.DynamicFormWorkFlowId = listsItems[0].DynamicFormWorkFlowId;
                                    dynamicFormWorkFlowForm.SequenceNo = listsItems[0].SequenceNo;
                                    dynamicFormWorkFlowForm.DynamicFormWorkFlowUser = listsItems[0].DynamicFormWorkFlowUser;
                                    dynamicFormWorkFlowForm.CompletedDate = listsItems[0].FlowStatusID == 1 ? listsItems[0].CompletedDate : null;
                                    dynamicFormWorkFlowForm.CompletedBy = listsItems[0].FlowStatusID == 1 ? listsItems[0].CompletedBy : null;
                                    dynamicFormWorkFlowForm.FlowStatusID = listsItems[0].FlowStatusID;
                                    dynamicFormWorkFlowForm.UserId = listsItems[0].UserId;
                                    dynamicFormWorkFlowForm.IsAllowDelegateUser = listsItems[0].IsAllowDelegateUser;
                                    dynamicFormWorkFlowForm.DynamicFormWorkFlowFormId = listsItems[0].DynamicFormWorkFlowFormId;
                                    dynamicFormWorkFlowForm.DelegateSectionUserId = listsItems[0].DelegateSectionUserId;
                                    dynamicFormWorkFlowForm.DelegateSectionUserName = listsItems[0].DelegateSectionUserName;
                                    dynamicFormWorkFlowForm.ActualUserId = listsItems[0].ActualUserId;
                                    dynamicFormWorkFlowForm.ActualUserName = listsItems[0].ActualUserName;
                                    dynamicFormWorkFlowForm.IsAnomalyStatus = listsItems[0].IsAnomalyStatus;
                                    dynamicFormWorkFlowForm.DynamicFormWorkFlowApprovalFormCompleted = listsItems[0].DynamicFormWorkFlowApprovalFormCompleted;
                                    dynamicFormWorkFlowForm.IsMultipleUser = listsItems[0].IsMultipleUser;
                                    dynamicFormWorkFlowForm.DynamicFormWorkFlowMultipleUsers = listsItems[0].DynamicFormWorkFlowMultipleUsers;
                                    _dynamicFormWorkFlowFormListItems.Add(dynamicFormWorkFlowForm);
                                });
                            }
                        }
                        // if(_dynamicFormWorkFlowFormList!=null && _dynamicFormWorkFlowFormList.Count()>0)
                        // {
                        //     var isAnalomys=_dynamicFormWorkFlowFormList.Where(f=>f.IsAnomalyStatus==true).FirstOrDefault();
                        //     if (isAnalomys!=null)
                        //     {
                        //         isWorkflowEnabled = true;
                        //     }
                        // }
                        List<DynamicFormWorkFlowSection> _dynamicFormWorkFlowSectionNoWorkFlowSections = new List<DynamicFormWorkFlowSection>();
                        if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count() > 0)
                        {
                            _dynamicFormWorkFlowSectionNoWorkFlowSections = new List<DynamicFormWorkFlowSection>();
                            _dynamicFormWorkFlowSectionNoWorkFlow.ForEach(item =>
                            {
                                bool shouldEnableWorkflow = false;
                                if (item.IsWorkFlowDone == 0)
                                {
                                    if (item?.IsMultipleUser == true && item?.DynamicFormWorkFlowMultipleUsers?.Any(q => q.UserId == applicationUser.UserID) == true)
                                    {
                                        shouldEnableWorkflow = true;
                                    }
                                    else
                                    {
                                        if (item.UserId == applicationUser.UserID)
                                        {
                                            shouldEnableWorkflow = true;
                                        }
                                        else
                                        {
                                            if (item.IsAnomalyStatus == true)
                                            {
                                                shouldEnableWorkflow = true;
                                            }
                                        }
                                    }
                                }

                                if (shouldEnableWorkflow)
                                {
                                    _dynamicFormWorkFlowSectionNoWorkFlowSections.Add(item);
                                }

                            });
                        }
                        _dynamicFormWorkFlowSectionNoWorkFlowSectionItems.AddRange(_dynamicFormWorkFlowSectionNoWorkFlowSections);
                        var screenId = _dynamicform.ScreenID.Replace(" ", "_");
                        _AttributeHeader = await Mediator.Send(new GetAllAttributeNameList(_dynamicform, applicationUser.UserID, true, true, false));
                        _DynamicFormSectionIds = _AttributeHeader.DynamicFormSectionAttributeSections.Select(s => s.DynamicFormSectionId).Distinct().ToList();
                        if (_AttributeHeader.DynamicFormSectionAttribute != null && _AttributeHeader.DynamicFormSectionAttribute.Count > 0)
                        {
                            IsDynamicGridForm = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.ControlTypeId == 2712).Count() > 0 ? true : false;
                            if (!string.IsNullOrEmpty(_dynamicformData?.DynamicFormItem))
                            {
                                if (IsValidJson(_dynamicformData.DynamicFormItem))
                                {
                                    jsonObjs = JsonConvert.DeserializeObject(_dynamicformData.DynamicFormItem);
                                }
                            }
                            var IsRadioCheckRemarksData = _AttributeHeader.DynamicFormSectionAttribute.Where(s => s.IsRadioCheckRemarks != null).ToList();
                            var typesLists = _AttributeHeader.DynamicFormSectionAttribute.Select(s => s.DataType).ToList();
                            var SpinobjectNameLists = new List<string>(); var SpintypesLists = new List<Type>();
                            var DataGridobjectNameLists = new List<string>(); var DataGridtypesLists = new List<Type>();
                            var objectNameLists = _AttributeHeader.DynamicFormSectionAttribute.Select(s => s.DynamicAttributeName).ToList();
                            List<string?> dataSourceTableIds = new List<string?>() { "Plant" };
                            var DataSourceTablelists = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.AttributeHeaderDataSource.Count > 0).SelectMany(a => a.AttributeHeaderDataSource.Select(s => s.DataSourceTable)).ToList().Distinct().ToList();
                            dataSourceTableIds.AddRange(DataSourceTablelists); List<long?> ApplicationMasterIds = new List<long?>(); List<long?> ApplicationMasterParentIds = new List<long?>();
                            ApplicationMasterIds = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.ApplicationMaster.Count > 0).SelectMany(a => a.ApplicationMaster.Select(s => (long?)s.ApplicationMasterId)).ToList().Distinct().ToList();
                            ApplicationMasterParentIds = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.ApplicationMasterParents.Count > 0).SelectMany(a => a.ApplicationMasterParents.Select(s => (long?)s.ApplicationMasterParentCodeId)).ToList().Distinct().ToList();
                            if (ApplicationMasterIds.Count > 0)
                            {
                                dataSourceTableIds.Add("ApplicationMaster");
                            }
                            if (ApplicationMasterParentIds.Count() > 0)
                            {
                                dataSourceTableIds.Add("ApplicationMasterParent");
                            }
                            PlantDependencySubAttributeDetails = await Mediator.Send(new GetDataSourceDropDownList(null, dataSourceTableIds, plantCode, ApplicationMasterIds, ApplicationMasterParentIds));
                            ApplicationMasterParentDetails = new List<AttributeDetails>();
                            if (PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0 && ApplicationMasterParentIds.Count() > 0)
                            {
                                ApplicationMasterParentDetails = PlantDependencySubAttributeDetails.Where(w => ApplicationMasterParentIds.Contains(w.ApplicationMasterParentCodeId)).ToList();
                            }
                            _AttributeHeader.DynamicFormSectionAttribute.ForEach(a =>
                            {
                                AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                addTempSectionAttribute.DataType = a.DataType;
                                addTempSectionAttribute.DynamicAttributeName = a.DynamicAttributeName;
                                addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + a.DisplayName;
                                addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_";
                                addTempSectionAttribute.ID = a.DynamicFormSectionAttributeId;
                                addTempSectionAttribute.ControlType = a.ControlType;
                                addTempSectionAttributes.Add(addTempSectionAttribute);
                                if (a.ControlTypeId == 2704)
                                {
                                    SpinobjectNameLists.Add(a.DynamicAttributeName); SpintypesLists.Add(typeof(string));
                                }
                                if (a.DataSourceTable == "ApplicationMaster" && a.ApplicationMaster != null && a.ApplicationMaster.Count() > 0)
                                {
                                    a.ApplicationMaster.ForEach(ab =>
                                    {
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
                                        typesLists.Add(a.DataType);
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = a.DataType;
                                        addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster_" + ab.ApplicationMasterName;
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster_";
                                        addTempSectionAttribute.ControlType = a.ControlType;
                                        addTempSectionAttributes.Add(addTempSectionAttributess);
                                        if (a.IsDynamicFormGridDropdown == true && a.GridDropDownDynamicFormID > 0)
                                        {
                                            Type dataTypess = a.IsDynamicFormGridDropdownMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
                                            var nameDataGrid = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster";
                                            typesLists.Add(dataTypess);
                                            objectNameLists.Add(nameDataGrid);
                                            AddTempSectionAttribute addTempSectionAttributesss = new AddTempSectionAttribute();
                                            addTempSectionAttributesss.DataType = dataTypess;
                                            addTempSectionAttributesss.DynamicAttributeName = nameDataGrid;
                                            addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster_";
                                            addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster_" + ab.ApplicationMasterName;
                                            addTempSectionAttribute.ControlType = a.IsDynamicFormGridDropdownMultiple == true ? "TagBox" : "ComboBox";
                                            addTempSectionAttributes.Add(addTempSectionAttributesss);
                                        }
                                    });
                                }
                                if (a.ControlTypeId == 2715)
                                {
                                    var _attributeGroupCheckBoxes = _AttributeHeader.AttributeGroupCheckBoxes.Where(s => s.AttributeId == a.AttributeId).ToList();
                                    if (_attributeGroupCheckBoxes.Count() > 0)
                                    {
                                        _attributeGroupCheckBoxes.ForEach(r =>
                                        {
                                            if (r.IsTextBox == true)
                                            {
                                                if (r.SubAttributeHeaders != null && r.SubAttributeHeaders.Count() > 0)
                                                {
                                                    r.SubAttributeHeaders.ForEach(d =>
                                                    {
                                                        AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                                        addTempSectionAttribute.DataType = d.SubDataType;
                                                        addTempSectionAttribute.DynamicAttributeName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                                                        addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + d.Description;
                                                        addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_";
                                                        addTempSectionAttribute.ControlType = d.ControlType;
                                                        addTempSectionAttributes.Add(addTempSectionAttribute);
                                                        typesLists.Add(d.SubDataType);
                                                        objectNameLists.Add(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                        if (d.SubApplicationMaster != null && d.SubApplicationMaster.Count > 0)
                                                        {
                                                            d.SubApplicationMaster.ForEach(ab =>
                                                            {
                                                                AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                                                                var appendAppMaster = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                                                addTempSectionAttributeSub.DataType = d.SubDataType;
                                                                addTempSectionAttributeSub.ControlType = d.ControlType;
                                                                addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                                                                addTempSectionAttributeSub.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_";
                                                                addTempSectionAttributeSub.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_" + ab.ApplicationMasterName;
                                                                addTempSectionAttributes.Add(addTempSectionAttributeSub);
                                                                typesLists.Add(d.SubDataType);
                                                                objectNameLists.Add(appendAppMaster);
                                                            });

                                                        }
                                                        else
                                                        {

                                                        }
                                                    });
                                                }
                                            }
                                            else
                                            {
                                                var nameData = a.DynamicFormSectionAttributeId + "_" + a.AttributeId + "_" + r.AttributeGroupCheckBoxId + "_GroupCheckBox";
                                                typesLists.Add(r.IsTextBox == true ? typeof(string) : a.DataType);
                                                objectNameLists.Add(nameData);
                                                AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                                addTempSectionAttributess.DataType = r.IsTextBox == true ? typeof(string) : a.DataType;
                                                addTempSectionAttributess.DynamicAttributeName = nameData;
                                                addTempSectionAttribute.DynamicAttributeFieldName = nameData;
                                                addTempSectionAttribute.UniqueId = nameData;
                                                addTempSectionAttribute.ControlType = r.IsTextBox == true ? "Memo" : "GroupCheckBox";
                                                addTempSectionAttributes.Add(addTempSectionAttributess);
                                            }

                                        });
                                    }
                                }
                                if (a.DataSourceTable == "DynamicGrid")
                                {
                                    var dynamicGridFormIds = a.DynamicGridDynamicFormData.Select(s => s.DynamicFormDataGridFormId).Distinct().ToList();
                                    if (dynamicGridFormIds.Count() > 0)
                                    {
                                        dynamicGridFormIds.ForEach(r =>
                                        {
                                            var nameData = a.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                                            typesLists.Add(a.DataType);
                                            objectNameLists.Add(nameData);
                                            AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                            addTempSectionAttributess.DataType = a.DataType;
                                            addTempSectionAttributess.DynamicAttributeName = nameData;
                                            addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid" + a.DisplayName;
                                            addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid_";
                                            addTempSectionAttribute.ControlType = a.ControlType;
                                            addTempSectionAttributes.Add(addTempSectionAttributess);
                                        });
                                    }
                                }
                                if (a.DataSourceTable == "ApplicationMasterParent" && a.ApplicationMasterParents != null && a.ApplicationMasterParents.Count() > 0)
                                {
                                    a.ApplicationMasterParents.ForEach(ab =>
                                    {
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
                                        typesLists.Add(a.DataType);
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = a.DataType;
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar_" + ab.ApplicationMasterName;
                                        addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar_";
                                        addTempSectionAttribute.ControlType = a.ControlType;
                                        addTempSectionAttributes.Add(addTempSectionAttributess);
                                        loadApplicationMasterParentDataList(a, ab, typesLists, objectNameLists);
                                        if (a.IsDynamicFormGridDropdown == true && a.GridDropDownDynamicFormID > 0)
                                        {
                                            Type dataTypess = a.IsDynamicFormGridDropdownMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
                                            var nameDataGrid = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster";
                                            typesLists.Add(dataTypess);
                                            objectNameLists.Add(nameDataGrid);
                                            AddTempSectionAttribute addTempSectionAttributesss = new AddTempSectionAttribute();
                                            addTempSectionAttributesss.DataType = dataTypess;
                                            addTempSectionAttributesss.DynamicAttributeName = nameDataGrid;
                                            addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster_" + ab.ApplicationMasterName;
                                            addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_" + a.GridDropDownDynamicFormID + "_GridAppMaster_";
                                            addTempSectionAttribute.ControlType = a.IsDynamicFormGridDropdownMultiple == true ? "TagBox" : "ComboBox";
                                            addTempSectionAttributes.Add(addTempSectionAttributesss);
                                        }
                                    });
                                }
                                if (a.ControlType == "ComboBox" && a.IsPlantLoadDependency == true && a.AttributeHeaderDataSource.Count() > 0)
                                {
                                    List<string?> DataSourceTableIdsNew = new List<string?>();
                                    Type dataTypes = a.IsDependencyMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
                                    a.AttributeHeaderDataSource.ForEach(dd =>
                                    {
                                        DataSourceTableIdsNew.Add(dd.DataSourceTable);
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + dd.AttributeHeaderDataSourceId + "_" + dd.DataSourceTable + "_Dependency";
                                        typesLists.Add(dataTypes);
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = dataTypes;
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttributess.DynamicAttributeFieldName = nameData;
                                        addTempSectionAttributess.UniqueId = nameData + "_";
                                        addTempSectionAttribute.ControlType = a.IsDependencyMultiple == true ? "TagBox" : "ComboBox";
                                        addTempSectionAttributes.Add(addTempSectionAttributess);
                                    });
                                    if (a.IsSetDefaultValue == true)
                                    {
                                        loadDependencyDataList(applicationUser.UserID, DataSourceTableIdsNew, a);
                                    }
                                }
                                if (jsonObjs != null)
                                {
                                    var Namess = jsonObjs.ContainsKey(a.DynamicAttributeName);
                                    if (Namess == true)
                                    {
                                        if (a.ControlType == "CheckBox" && a.SubAttributeHeaders != null && a.SubAttributeHeaders.Count > 0)
                                        {
                                            var itemGetSubValue = jsonObjs[a.DynamicAttributeName];
                                            bool? itemGetSubValues = itemGetSubValue == null ? false : (bool)itemGetSubValue;
                                            if (itemGetSubValues == true)
                                            {
                                                a.SubAttributeHeaders.ForEach(d =>
                                                {
                                                    var SubNamess = jsonObjs.ContainsKey(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                    if (SubNamess == true || SubNamess == false)
                                                    {
                                                        AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                                        addTempSectionAttribute.DataType = d.SubDataType;
                                                        addTempSectionAttribute.DynamicAttributeName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                                                        addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + d.Description;
                                                        addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_";
                                                        addTempSectionAttribute.ControlType = d.ControlType;
                                                        addTempSectionAttributes.Add(addTempSectionAttribute);
                                                        typesLists.Add(d.SubDataType);
                                                        objectNameLists.Add(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                        if (d.SubApplicationMaster != null && d.SubApplicationMaster.Count > 0)
                                                        {
                                                            d.SubApplicationMaster.ForEach(ab =>
                                                            {
                                                                AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                                                                var appendAppMaster = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                                                addTempSectionAttributeSub.DataType = d.SubDataType;
                                                                addTempSectionAttributeSub.ControlType = d.ControlType;
                                                                addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                                                                addTempSectionAttributeSub.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_";
                                                                addTempSectionAttributeSub.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_" + ab.ApplicationMasterName;
                                                                addTempSectionAttributes.Add(addTempSectionAttributeSub);
                                                                typesLists.Add(d.SubDataType);
                                                                objectNameLists.Add(appendAppMaster);
                                                            });
                                                        }
                                                    }
                                                    else
                                                    {

                                                    }
                                                });
                                            }
                                        }
                                        if (a.ControlType == "Radio" || a.ControlType == "RadioGroup")
                                        {
                                            var itemGetSubValue = jsonObjs[a.DynamicAttributeName];
                                            long? itemGetSubValues = itemGetSubValue == null ? null : (long)itemGetSubValue;
                                            if (itemGetSubValues > 0)
                                            {
                                                var listDetails = _AttributeHeader.AttributeDetails.Where(w => w.AttributeDetailID == itemGetSubValues && w.DropDownTypeId == null).FirstOrDefault();
                                                if (listDetails != null && listDetails.SubAttributeHeaders != null && listDetails.SubAttributeHeaders.Count > 0)
                                                {
                                                    listDetails.SubAttributeHeaders.ForEach(d =>
                                                    {

                                                        var SubNamess = jsonObjs.ContainsKey(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                        if (SubNamess == true || SubNamess == false)
                                                        {
                                                            AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                                            addTempSectionAttribute.DataType = d.SubDataType;
                                                            addTempSectionAttribute.ControlType = d.ControlType;
                                                            addTempSectionAttribute.DynamicAttributeName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                                                            addTempSectionAttribute.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_";
                                                            addTempSectionAttribute.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + d.Description;
                                                            addTempSectionAttributes.Add(addTempSectionAttribute);
                                                            typesLists.Add(d.SubDataType);
                                                            objectNameLists.Add(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                            if (d.SubApplicationMaster != null && d.SubApplicationMaster.Count > 0)
                                                            {
                                                                d.SubApplicationMaster.ForEach(ab =>
                                                                {
                                                                    AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                                                                    var appendAppMaster = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                                                    addTempSectionAttributeSub.DataType = d.SubDataType;
                                                                    addTempSectionAttributeSub.ControlType = d.ControlType;
                                                                    addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                                                                    addTempSectionAttributeSub.DynamicAttributeFieldName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_" + ab.ApplicationMasterName;
                                                                    addTempSectionAttributeSub.UniqueId = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster_";
                                                                    addTempSectionAttributes.Add(addTempSectionAttributeSub);
                                                                    typesLists.Add(d.SubDataType);
                                                                    objectNameLists.Add(appendAppMaster);
                                                                });
                                                            }
                                                        }
                                                        else
                                                        {

                                                        }
                                                    });
                                                }
                                            }
                                        }

                                    }
                                }
                            });
                            if (IsRadioCheckRemarksData != null && IsRadioCheckRemarksData.Count > 0)
                            {
                                IsRadioCheckRemarksData.ForEach(d =>
                                {
                                    if (d.ControlTypeId == 2705 || d.ControlTypeId == 2711 || d.ControlTypeId == 2710)
                                    {
                                        if (d.IsRadioCheckRemarks == "TextBox" || d.IsRadioCheckRemarks == "Memo")
                                        {
                                            typesLists.Add(typeof(string));
                                            var appendNames = d.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + d.AttributeName;
                                            AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                            addTempSectionAttribute.DataType = typeof(string);
                                            addTempSectionAttribute.ControlType = "TextBox";
                                            addTempSectionAttribute.DynamicAttributeName = appendNames;
                                            addTempSectionAttribute.DynamicAttributeFieldName = appendNames;
                                            addTempSectionAttribute.UniqueId = appendNames + "_";
                                            addTempSectionAttributes.Add(addTempSectionAttribute);
                                            objectNameLists.Add(appendNames);
                                        }
                                    }
                                });
                            }
                            DataClassTypeList = typesLists;
                            DataClassObjectNameList = objectNameLists;
                            Type[] typesList = typesLists.ToArray();
                            string[] objectNameList = objectNameLists.ToArray();
                            MyClassBuilder MCB = new MyClassBuilder(screenId);
                            Data = MCB.CreateObject(objectNameList, typesList);
                            if (SpinobjectNameLists.Count > 0)
                            {
                                MyClassBuilder SpinMCB = new MyClassBuilder(screenId);
                                SpinData = SpinMCB.CreateObject(SpinobjectNameLists.ToArray(), SpintypesLists.ToArray());
                            }
                            if (DataClassObjectNameList != null && DataClassObjectNameList.Count() > 0)
                            {
                                DataGridobjectNameLists = DataClassObjectNameList; DataGridtypesLists = new List<Type>();
                                DataClassObjectNameList.ForEach(d =>
                                {
                                    DataGridtypesLists.Add(typeof(object));
                                });
                                MyClassBuilder GridMCB = new MyClassBuilder(screenId);
                                DataGridObject = GridMCB.CreateObject(DataGridobjectNameLists.ToArray(), DataGridtypesLists.ToArray());
                            }
                            if (_dynamicformData != null)
                            {
                                dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
                                dynamicFormData.SessionId = _dynamicformData.SessionId;
                                dynamicFormData.AddedDate = _dynamicformData.AddedDate;
                                dynamicFormData.AddedByUserID = _dynamicformData.AddedByUserID;
                                dynamicFormData.DynamicFormCurrentItem = _dynamicformData.DynamicFormItem;
                                dynamicFormData.DynamicFormId = _dynamicformData.DynamicFormId;

                                _AttributeHeader.DynamicFormSectionAttribute.ForEach(a =>
                                {
                                    var Names = jsonObjs.ContainsKey(a.DynamicAttributeName);
                                    if (a.ControlTypeId == 2705 || a.ControlTypeId == 2711 || a.ControlTypeId == 2710)
                                    {
                                        var appendGetNames = a.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + a.AttributeName;
                                        if (Data.GetType().GetProperty(appendGetNames) != null)
                                        {
                                            var AppNames = jsonObjs.ContainsKey(appendGetNames);
                                            if (AppNames == true)
                                            {
                                                var itemGetValue = (string)jsonObjs[appendGetNames];
                                                if (a.IsRadioCheckRemarks == "TextBox")
                                                {
                                                    Data.GetType().GetProperty(appendGetNames).SetValue(Data, itemGetValue);
                                                }
                                                if (a.IsRadioCheckRemarks == "Memo")
                                                {
                                                    Data.GetType().GetProperty(appendGetNames).SetValue(Data, itemGetValue);
                                                }
                                            }
                                        }
                                    }
                                    if (Names == true)
                                    {
                                        if (Data.GetType().GetProperty(a.DynamicAttributeName) != null)
                                        {
                                            //var valueType = jsonObj[a.DynamicAttributeName].Type;
                                            var itemValue = jsonObjs[a.DynamicAttributeName];
                                            if (itemValue is JArray)
                                            {
                                                var values = (JArray)itemValue;
                                                List<long?> listData = values.ToObject<List<long?>>();
                                                Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, listData);
                                                if (a.ControlType == "TagBox")
                                                {
                                                    if (listData != null && listData.Count() > 0)
                                                    {
                                                        listData.ForEach(w =>
                                                        {
                                                            if (w > 0)
                                                            {
                                                                var valuess = "Attr_" + w;
                                                                if (!string.IsNullOrEmpty(a.DataSourceTable))
                                                                {
                                                                    valuess = a.DataSourceTable + "_" + w;
                                                                }
                                                                var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == a.DynamicFormSectionAttributeId).ToList();
                                                                if (valeExits != null && valeExits.Count() > 0)
                                                                {
                                                                    dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);

                                                                }
                                                            }
                                                        });

                                                    }
                                                }
                                            }
                                            else if (a.ControlType == "ListBox" && a.IsMultiple == false)
                                            {
                                                long? values = itemValue == null ? null : (long)itemValue;
                                                Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                            }
                                            else
                                            {
                                                if (a.ControlType == "GroupCheckBox")
                                                {
                                                    var _attributeGroupCheckBoxes = _AttributeHeader.AttributeGroupCheckBoxes.Where(s => s.AttributeId == a.AttributeId).ToList();
                                                    if (_attributeGroupCheckBoxes.Count() > 0)
                                                    {
                                                        _attributeGroupCheckBoxes.ForEach(r =>
                                                        {
                                                            var nameData = a.DynamicFormSectionAttributeId + "_" + a.AttributeId + "_" + r.AttributeGroupCheckBoxId + "_GroupCheckBox";
                                                            if (r.IsTextBox == true)
                                                            {
                                                                loadSubHeaders(r.SubAttributeHeaders, a);
                                                            }
                                                            else
                                                            {
                                                                var NamesA = jsonObjs.ContainsKey(nameData);
                                                                if (NamesA == true)
                                                                {
                                                                    var itemValueA = jsonObjs[nameData];
                                                                    bool? valuesA = itemValueA == null ? false : (bool?)itemValueA;
                                                                    Data.GetType().GetProperty(nameData).SetValue(Data, valuesA);

                                                                }
                                                            }
                                                        });
                                                    }
                                                }
                                                List<AttributeHeader> SubAttrsHeader = new List<AttributeHeader>();
                                                if (a.ControlType == "TextBox" || a.ControlType == "Memo" || a.ControlType == "Password")
                                                {
                                                    var values = (string)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);

                                                }
                                                else if (a.ControlType == "ComboBox" || a.ControlType == "Radio" || a.ControlType == "RadioGroup")
                                                {
                                                    long? values = itemValue == null ? null : (long)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);

                                                    if (values > 0)
                                                    {
                                                        var attrDetails = _AttributeHeader.AttributeDetails.Where(mm => mm.AttributeDetailID == values && mm.DropDownTypeId == null).FirstOrDefault()?.SubAttributeHeaders;
                                                        if (attrDetails != null && attrDetails.Count > 0)
                                                        {
                                                            SubAttrsHeader = attrDetails;
                                                        }
                                                    }
                                                    if (a.ControlType == "ComboBox" && values > 0)
                                                    {

                                                        var valuess = "Attr_" + values;
                                                        if (!string.IsNullOrEmpty(a.DataSourceTable))
                                                        {
                                                            valuess = a.DataSourceTable + "_" + values;
                                                        }
                                                        var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == a.DynamicFormSectionAttributeId).ToList();
                                                        if (valeExits != null && valeExits.Count() > 0)
                                                        {
                                                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                                                        }

                                                    }
                                                    if (a.ControlType == "ComboBox" && a.IsPlantLoadDependency == true && a.AttributeHeaderDataSource.Count() > 0)
                                                    {
                                                        List<string?> DataSourceTableIdss = new List<string?>();
                                                        a.AttributeHeaderDataSource.ForEach(dd =>
                                                        {
                                                            DataSourceTableIdss.Add(dd.DataSourceTable);
                                                            var nameData = a.DynamicFormSectionAttributeId + "_" + dd.AttributeHeaderDataSourceId + "_" + dd.DataSourceTable + "_Dependency";
                                                            var itemDepExits = jsonObjs.ContainsKey(nameData);
                                                            if (itemDepExits == true)
                                                            {
                                                                var itemDepValue = jsonObjs[nameData];
                                                                if (Data.GetType().GetProperty(nameData) != null)
                                                                {
                                                                    if (a.IsDependencyMultiple == true)
                                                                    {
                                                                        if (itemDepValue is JArray)
                                                                        {
                                                                            var values = (JArray)itemDepValue;
                                                                            List<long?> listData = values.ToObject<List<long?>>();
                                                                            Data.GetType().GetProperty(nameData).SetValue(Data, listData);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        long? valuesDep = itemDepValue == null ? null : (long)itemDepValue;
                                                                        Data.GetType().GetProperty(nameData).SetValue(Data, valuesDep);
                                                                    }
                                                                }
                                                            }
                                                        });
                                                        loadDependencyDataList(values, DataSourceTableIdss, a);


                                                    }
                                                }
                                                else if (a.ControlType == "CheckBox")
                                                {
                                                    bool? values = itemValue == null ? false : (bool)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    if (values == true)
                                                    {
                                                        SubAttrsHeader = a.SubAttributeHeaders;
                                                    }
                                                }
                                                else if (a.ControlType == "DateEdit")
                                                {
                                                    DateTime? values = itemValue == null ? null : (DateTime)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                }
                                                else if (a.ControlType == "TimeEdit")
                                                {
                                                    TimeSpan? values = itemValue == null ? null : (TimeSpan)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                }

                                                else if (a.ControlType == "SpinEdit")
                                                {
                                                    if (a.IsSpinEditType == "decimal")
                                                    {
                                                        decimal? values = itemValue == null ? null : (decimal)itemValue;
                                                        Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    }
                                                    else
                                                    {
                                                        int? values = itemValue == null ? null : (int)itemValue;
                                                        Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    }
                                                }
                                                else if (a.ControlType == "QR Code")
                                                {
                                                    var values = (string)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);

                                                }
                                                loadSubHeaders(SubAttrsHeader, a);

                                            }
                                            if (a.DataSourceTable == "ApplicationMaster")
                                            {
                                                loadApplicationMasterDataList(a);
                                            }
                                            if (a.DataSourceTable == "ApplicationMasterParent")
                                            {
                                                loadApplicationMasterParentSetItemDataList(a);
                                            }
                                            if (a.DataSourceTable == "DynamicGrid")
                                            {
                                                var dynamicGridFormIds = a.DynamicGridDynamicFormData.Select(s => s.DynamicFormDataGridFormId).Distinct().ToList();
                                                if (dynamicGridFormIds.Count() > 0)
                                                {
                                                    dynamicGridFormIds.ForEach(r =>
                                                    {
                                                        var nameData = a.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                                                        var itemDepExits = jsonObjs.ContainsKey(nameData);
                                                        if (itemDepExits == true)
                                                        {
                                                            var itemDepValue = jsonObjs[nameData];
                                                            if (Data.GetType().GetProperty(nameData) != null)
                                                            {
                                                                if (itemDepValue is JArray)
                                                                {
                                                                    var values = (JArray)itemDepValue;
                                                                    List<long?> listData = values.ToObject<List<long?>>();
                                                                    Data.GetType().GetProperty(nameData).SetValue(Data, listData);
                                                                }
                                                                else
                                                                {
                                                                    long? valuesDep = itemDepValue == null ? null : (long)itemDepValue;
                                                                    Data.GetType().GetProperty(nameData).SetValue(Data, valuesDep);
                                                                }
                                                            }
                                                        }
                                                    });
                                                }
                                            }
                                        }
                                    }
                                });

                            }

                        }
                        else
                        {
                            if (_dynamicformData != null)
                            {
                                dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
                                dynamicFormData.SessionId = _dynamicformData.SessionId;
                                dynamicFormData.AddedDate = _dynamicformData.AddedDate;
                                dynamicFormData.AddedByUserID = _dynamicformData.AddedByUserID;
                                dynamicFormData.DynamicFormCurrentItem = _dynamicformData.DynamicFormItem;
                                dynamicFormData.DynamicFormId = _dynamicformData.DynamicFormId;
                            }
                        }
                    }
                    if (_dynamicform != null && _dynamicformData == null)
                    {
                        if (_dynamicform.ProfileId > 0)
                        {
                            await loadData(_dynamicform.ProfileId);
                        }
                    }
                    if (_dynamicform != null && _dynamicformData != null)
                    {
                        if (_dynamicformData.ProfileId > 0)
                        {
                        }
                        else
                        {
                            if (_dynamicform.ProfileId > 0)
                            {
                                await loadData(_dynamicform.ProfileId);
                            }
                        }
                    }
                }

            }

        }
        else
        {
            AddEnabled = false;
        }
        await updateIpirApp();
        StateHasChanged();
    }
    void OpenLock()
    {
        if (dynamicFormData != null)
        {
            var sectionLock = _dynamicformData?.DynamicFormDataSectionLock.Count(dc => dc.IsLocked == true);
            if (sectionLock > 0)
            {
                toastService.ShowToast("Section Already Locked.", AC.SD.Core.Services.ToastLevel.Info);
            }
            else
            {
                lockpopup = true;
            }
        }
    }
    void EulaPopupLockClosed(PopupClosedEventArgs args)
    {
        imageUploadPopup = false;
        createAuditpopup = false;
        lockpopup = false;
        IsSectionLockOpen = false; WithWorkFlowStartPopup = false;
        StateHasChanged();
    }
    async Task bulkSectionLock()
    {
        if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0)
        {
            DynamicFormDataSectionLock dynamicFormData = new DynamicFormDataSectionLock();
            dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
            dynamicFormData.DynamicFormSectionId = dynamicFormSectionData.DynamicFormSectionId;
            dynamicFormData.IsLocked = dynamicFormSectionData.DynamicFormDataSectionLock?.IsLocked == false ? true : false;
            if (dynamicFormData.IsLocked == true)
            {
                dynamicFormData.LockedUserId = applicationUser.UserID;
                dynamicFormData.LockedUser = applicationUser.UserName;
            }
            var result = await Mediator.Send(new UpdateDynamicFormDataSectionLock(dynamicFormData));
            IsSectionLockOpen = false;
            if (result.DynamicFormDataId > 0)
            {

                if (dynamicFormData.IsLocked == true)
                {
                    toastService.ShowToast("Lock successfully.", AC.SD.Core.Services.ToastLevel.Success);
                    await loadDynamicForm();
                }
                else
                {
                    toastService.ShowToast("Unlock successfully.", AC.SD.Core.Services.ToastLevel.Success);
                    await loadDynamicForm();
                }

            }

        }
        StateHasChanged();
    }
    async Task bulkLock()
    {
        if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0)
        {
            DynamicFormData dynamicFormData = new DynamicFormData();
            dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
            dynamicFormData.IsLocked = LockedName == "UnLock" ? null : true;
            if (dynamicFormData.IsLocked == true)
            {
                dynamicFormData.LockedUserId = applicationUser.UserID;
                dynamicFormData.LockedUser = applicationUser.UserName;
            }
            var result = await Mediator.Send(new UpdateDynamicFormLocked(dynamicFormData));
            lockpopup = false;
            if (result.DynamicFormDataId > 0)
            {

                if (dynamicFormData.IsLocked == true)
                {
                    toastService.ShowToast("Lock successfully.", AC.SD.Core.Services.ToastLevel.Success);
                    await loadDynamicForm();
                }
                else
                {
                    toastService.ShowToast("Unlock successfully.", AC.SD.Core.Services.ToastLevel.Success);
                    await loadDynamicForm();
                }

            }

        }
        StateHasChanged();
    }
    void loadApplicationMasterParentDataList(DynamicFormSectionAttribute dynamicFormSectionAttribute, ApplicationMasterParent applicationMasterParent, List<Type?> typesLists, List<string?> objectNameLists)
    {
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar";
            typesLists.Add(dynamicFormSectionAttribute.DataType);
            objectNameLists.Add(nameData);
            AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
            addTempSectionAttributess.DataType = dynamicFormSectionAttribute.DataType;
            addTempSectionAttributess.ControlType = dynamicFormSectionAttribute.ControlType;
            addTempSectionAttributess.DynamicAttributeName = nameData;
            addTempSectionAttributess.UniqueId = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar_";
            addTempSectionAttributess.DynamicAttributeFieldName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar_" + dataList.ApplicationMasterName;
            addTempSectionAttributes.Add(addTempSectionAttributess);
            loadApplicationMasterParentDataList(dynamicFormSectionAttribute, dataList, typesLists, objectNameLists);
        }
    }
    void loadApplicationMasterDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (jsonObjs != null)
        {
            if (dynamicFormSectionAttributes.ApplicationMaster != null && dynamicFormSectionAttributes.ApplicationMaster.Count() > 0)
            {
                dynamicFormSectionAttributes.ApplicationMaster.ForEach(ab =>
                {
                    var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
                    if (Data.GetType().GetProperty(nameData) != null)
                    {
                        var SubNamess = jsonObjs.ContainsKey(nameData);
                        if (SubNamess == true)
                        {
                            var itemValues = jsonObjs[nameData];
                            if (itemValues is JArray)
                            {
                                var values = (JArray)itemValues;
                                List<long?> listDatas = values.ToObject<List<long?>>();
                                if (dynamicFormSectionAttributes.IsMultiple == true || dynamicFormSectionAttributes.ControlType == "TagBox")
                                {
                                    Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                                }
                                if (listDatas != null && listDatas.Count() > 0)
                                {
                                    listDatas.ForEach(w =>
                                    {
                                        if (w > 0)
                                        {
                                            var valuess = dynamicFormSectionAttributes.DataSourceTable + "_" + w;
                                            var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).ToList();
                                            if (valeExits != null && valeExits.Count() > 0)
                                            {
                                                dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                                            }
                                        }
                                    });
                                }
                            }
                            else
                            {
                                if (dynamicFormSectionAttributes.ControlType == "ComboBox")
                                {
                                    long? values = itemValues == null ? null : (long)itemValues;
                                    Data.GetType().GetProperty(nameData).SetValue(Data, values);
                                    if (values > 0)
                                    {
                                        var valuess = dynamicFormSectionAttributes.DataSourceTable + "_" + values;
                                        var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).ToList();
                                        if (valeExits != null && valeExits.Count() > 0)
                                        {
                                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                                        }
                                    }
                                }
                                else
                                {
                                    if (dynamicFormSectionAttributes.ControlType == "ListBox" && dynamicFormSectionAttributes.IsMultiple == false)
                                    {
                                        long? values = itemValues == null ? null : (long)itemValues;
                                        Data.GetType().GetProperty(nameData).SetValue(Data, values);
                                    }
                                }
                            }
                            if (dynamicFormSectionAttributes.IsDynamicFormGridDropdown == true && dynamicFormSectionAttributes.GridDropDownDynamicFormID > 0)
                            {
                                var nameDataGrid = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_" + dynamicFormSectionAttributes.GridDropDownDynamicFormID + "_GridAppMaster";
                                if (Data.GetType().GetProperty(nameDataGrid) != null)
                                {
                                    var SubNamesss = jsonObjs.ContainsKey(nameDataGrid);
                                    if (SubNamesss == true)
                                    {
                                        var itemValuess = jsonObjs[nameDataGrid];
                                        if (itemValuess is JArray)
                                        {
                                            var values = (JArray)itemValuess;
                                            List<long?> listDatas = values.ToObject<List<long?>>();
                                            Data.GetType().GetProperty(nameDataGrid).SetValue(Data, listDatas);
                                        }
                                        else
                                        {
                                            long? values = itemValuess == null ? null : (long)itemValuess;
                                            Data.GetType().GetProperty(nameDataGrid).SetValue(Data, values);
                                        }
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }
    }
    void loadApplicationMasterParentSetItemDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (jsonObjs != null)
        {
            if (dynamicFormSectionAttributes.ApplicationMasterParents != null && dynamicFormSectionAttributes.ApplicationMasterParents.Count() > 0)
            {
                dynamicFormSectionAttributes.ApplicationMasterParents.ForEach(ab =>
                {
                    loadApplicationMasterParentSetDataList(dynamicFormSectionAttributes, ab);
                    if (dynamicFormSectionAttributes.IsDynamicFormGridDropdown == true && dynamicFormSectionAttributes.GridDropDownDynamicFormID > 0)
                    {
                        var nameDataGrid = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_" + dynamicFormSectionAttributes.GridDropDownDynamicFormID + "_GridAppMaster";

                        if (Data.GetType().GetProperty(nameDataGrid) != null)
                        {
                            var SubNamess = jsonObjs.ContainsKey(nameDataGrid);
                            if (SubNamess == true)
                            {
                                var itemValues = jsonObjs[nameDataGrid];
                                if (itemValues is JArray)
                                {
                                    var values = (JArray)itemValues;
                                    List<long?> listDatas = values.ToObject<List<long?>>();
                                    Data.GetType().GetProperty(nameDataGrid).SetValue(Data, listDatas);
                                }
                                else
                                {
                                    long? values = itemValues == null ? null : (long)itemValues;
                                    Data.GetType().GetProperty(nameDataGrid).SetValue(Data, values);
                                }
                            }
                        }
                    }
                });
            }
        }
    }
    void loadApplicationMasterParentSetDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes, ApplicationMasterParent ab)
    {
        var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
        if (Data.GetType().GetProperty(nameData) != null)
        {
            var SubNamess = jsonObjs.ContainsKey(nameData);
            if (SubNamess == true)
            {
                var itemValues = jsonObjs[nameData];
                if (itemValues is JArray)
                {
                    var values = (JArray)itemValues;
                    List<long?> listDatas = values.ToObject<List<long?>>();
                    if (dynamicFormSectionAttributes.IsMultiple == true || dynamicFormSectionAttributes.ControlType == "TagBox")
                    {
                        Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                        List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
                        nameDatas.Add(ab);
                        RemoveApplicationMasterParentSingleAllItem(ab, dynamicFormSectionAttributes, nameDatas);
                        setApplicationMasterParentData(nameDatas, dynamicFormSectionAttributes);
                    }
                    if (listDatas != null && listDatas.Count() > 0)
                    {
                        listDatas.ForEach(w =>
                        {
                            if (w > 0)
                            {
                                var valuess = "Attr_" + w;
                                if (!string.IsNullOrEmpty(dynamicFormSectionAttributes.DataSourceTable))
                                {
                                    valuess = dynamicFormSectionAttributes.DataSourceTable + "_" + w;
                                }
                                var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).ToList();
                                if (valeExits != null && valeExits.Count() > 0)
                                {
                                    dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                                }
                            }
                        });
                    }
                }
                else
                {
                    if (dynamicFormSectionAttributes.ControlType == "ComboBox")
                    {
                        long? values = itemValues == null ? null : (long)itemValues;
                        Data.GetType().GetProperty(nameData).SetValue(Data, values);
                        loadApplicationMasterParentDataLoad(values, dynamicFormSectionAttributes);
                        if (values > 0)
                        {
                            var valuess = dynamicFormSectionAttributes.DataSourceTable + "_" + values;
                            var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).ToList();
                            if (valeExits != null && valeExits.Count() > 0)
                            {
                                dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                            }
                        }
                    }
                    else
                    {
                        if (dynamicFormSectionAttributes.ControlType == "ListBox" && dynamicFormSectionAttributes.IsMultiple == false)
                        {
                            long? values = itemValues == null ? null : (long)itemValues;
                            Data.GetType().GetProperty(nameData).SetValue(Data, values);
                            loadApplicationMasterParentDataLoad(values, dynamicFormSectionAttributes);
                        }
                    }
                }
            }
        }
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == ab.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            loadApplicationMasterParentSetDataList(dynamicFormSectionAttributes, dataList);
        }
    }
    void setApplicationMasterParentData(List<ApplicationMasterParent> apar, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (apar != null && apar.Count() > 0)
        {
            var preData = new List<long?>();
            apar.ForEach(e =>
            {
                var curData = new List<long?>();
                var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + e.ApplicationMasterParentCodeId + "_AppMasterPar";
                if (Data.GetType().GetProperty(nameData) != null)
                {
                    var SubNamess = jsonObjs.ContainsKey(nameData);
                    if (SubNamess == true)
                    {
                        var itemValues = jsonObjs[nameData];
                        if (itemValues is JArray)
                        {
                            var values = (JArray)itemValues;
                            List<long?> listDatas = values.ToObject<List<long?>>();
                            Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                            if (listDatas != null && listDatas.Count() > 0 && PlantDependencySubAttributeDetails != null)
                            {
                                curData = listDatas;
                            }
                            if (preData.Count() > 0)
                            {
                                preData.ForEach(t =>
                            {
                                loadApplicationMasterParentDataLoad(t, dynamicFormSectionAttributes);
                            });
                            }

                        }
                    }
                }
                preData = curData;
            });
        }
    }
    void loadApplicationMasterParentDataLoad(long? values, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0)
        {
            var plt = PlantDependencySubAttributeDetails.Where(w => w.ParentId == values).ToList();
            if (plt != null && plt.Count() > 0)
            {
                plt.ForEach(a =>
                {
                    var exitss = a.ApplicationMasterParentSectionIds.Where(w => w == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).Count();
                    if (exitss == 0)
                    {
                        a.ApplicationMasterParentSectionIds.Add(dynamicFormSectionAttributes.DynamicFormSectionAttributeId);
                    }
                });
                if (ApplicationMasterParentDetails == null)
                {
                    ApplicationMasterParentDetails = new List<AttributeDetails>();
                    ApplicationMasterParentDetails.AddRange(plt);
                }
                else
                {
                    var exitsData = ApplicationMasterParentDetails.Where(w => w.ParentId == values).Count();
                    if (exitsData == 0)
                    {
                        ApplicationMasterParentDetails.AddRange(plt);
                    }
                }

            }
        }
    }
    void loadDependencyDataList(long? values, List<string?> DataSourceTableIdss, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        var plantDepIds = new List<long?>();
        if (values > 0)
        {
            plantDepIds.Add((long?)values);
            var plantDatas = _plantItems.FirstOrDefault(p => p.PlantID == values);
            if (plantDatas != null)
            {
                if (!string.IsNullOrEmpty(plantDatas.PlantCode) && plantDatas.PlantCode.ToLower() == "SWGP".ToLower())
                {
                    plantDepIds = new List<long?>();
                    if (_plantItems != null && _plantItems.Count() > 0)
                    {
                        plantDepIds = _plantItems.Where(w => plantNames.Contains(w.PlantCode)).Select(s => (long?)s.PlantID).ToList();
                    }
                }
            }
            if (PlantDependencySubAttributeDetails != null && DataSourceTableIdss.Count > 0)
            {
                List<AttributeDetails> attributeDepDetails = new List<AttributeDetails>();
                attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => plantDepIds.Contains(v.CompanyId) && DataSourceTableIdss.Contains(v.DropDownTypeId)).ToList());
                var soCustomerList = soCustomerType.Intersect(DataSourceTableIdss).ToList();
                if (soCustomerList.Count > 0)
                {
                    // attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => soCustomerList.Contains(v.DropDownTypeId)).ToList());
                }
                dynamicFormSectionAttributes.SubAttributeDetails = attributeDepDetails;
            }
        }
    }
    void loadSubHeaders(List<AttributeHeader>? SubAttrsHeader, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        if (jsonObjs != null)
        {
            if (SubAttrsHeader != null && SubAttrsHeader.Count > 0)
            {
                SubAttrsHeader.ForEach(d =>
             {
                 var subAttrName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                 if (Data.GetType().GetProperty(subAttrName) != null)
                 {
                     var SubNamess = jsonObjs.ContainsKey(subAttrName);
                     if (SubNamess == true)
                     {
                         var itemValues = jsonObjs[subAttrName];
                         if (itemValues is JArray)
                         {
                             var values = (JArray)itemValues;
                             List<long?> listDatas = values.ToObject<List<long?>>();
                             if (d.IsMultiple == true || d.ControlType == "TagBox")
                             {
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, listDatas);
                             }
                         }
                         else if (d.ControlType == "ListBox" && d.IsMultiple == false)
                         {
                             long? values = itemValues == null ? null : (long)itemValues;
                             Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                         }
                         else
                         {
                             if (d.ControlType == "TextBox" || d.ControlType == "Memo")
                             {
                                 var values = (string)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);

                             }
                             else if (d.ControlType == "QR Code")
                             {
                                 var values = (string)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);

                             }
                             else if (d.ControlType == "ComboBox" || d.ControlType == "Radio" || d.ControlType == "RadioGroup")
                             {
                                 long? values = itemValues == null ? null : (long)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "CheckBox")
                             {
                                 bool? values = itemValues == null ? false : (bool)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "DateEdit")
                             {
                                 DateTime? values = itemValues == null ? null : (DateTime)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "TimeEdit")
                             {
                                 TimeSpan? values = itemValues == null ? null : (TimeSpan)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "SpinEdit")
                             {
                                 if (d.IsAttributeSpinEditType == "decimal")
                                 {
                                     decimal? values = itemValues == null ? null : (decimal)itemValues;
                                     Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                                 }
                                 else
                                 {
                                     int? values = itemValues == null ? null : (int)itemValues;
                                     Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                                 }
                             }
                         }
                         if (d.DataSourceTable == "ApplicationMaster" && d.SubApplicationMaster != null && d.SubApplicationMaster.Count() > 0)
                         {
                             d.SubApplicationMaster.ForEach(ab =>
                             {
                                 var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                 var SubNamesss = jsonObjs.ContainsKey(appendAppMaster);
                                 if (SubNamesss == true)
                                 {
                                     var itemValues = jsonObjs[appendAppMaster];
                                     if (itemValues is JArray)
                                     {
                                         var values = (JArray)itemValues;
                                         List<long?> listDatas = values.ToObject<List<long?>>();
                                         if (d.IsMultiple == true || d.ControlType == "TagBox")
                                         {
                                             Data.GetType().GetProperty(appendAppMaster).SetValue(Data, listDatas);
                                         }
                                     }
                                     else
                                     {
                                         if (d.ControlType == "ComboBox")
                                         {
                                             long? values = itemValues == null ? null : (long)itemValues;
                                             Data.GetType().GetProperty(appendAppMaster).SetValue(Data, values);
                                         }
                                         else
                                         {
                                             if (d.ControlType == "ListBox" && d.IsMultiple == false)
                                             {
                                                 long? values = itemValues == null ? null : (long)itemValues;
                                                 Data.GetType().GetProperty(appendAppMaster).SetValue(Data, values);
                                             }
                                         }
                                     }
                                 }
                             });
                         }
                     }
                 }
             });
            }

        }
    }
    public void CheckedApprovalData()
    {
        if (_dynamicform != null && _dynamicform.IsApproval == true)
        {
            if (_dynamicformData != null)
            {
                IsSendApproval = _dynamicformData.IsSendApproval == true ? true : false;
                if (_dynamicformData.IsApproval == true)
                {
                    if (_dynamicformData.IsSendApproval == true)
                    {
                        IsSendApprovalVisible = false; IsApprovalSave = false;
                        isVisibleButton = false; IsSave = false; //IsUploadEnabled = false;
                    }
                    else
                    {
                        IsSendApprovalVisible = true; IsApprovalSave = true;
                    }
                }
            }

            CheckApproval();
        }
    }
    public async Task loadData(long? profileID)
    {
        _editContexts = new EditContext(Datas);
        isPlant = false; isMainHeader = false;
        isDivision = false; isDepartment = false;
        isSection = false; isSubSection = false; PlantValue = null;
        Datas.PlantId = 0; Datas.DepartmentId = 0; Datas.ProfileId = 0; Datas.ProfileNo = null;
        Datas.DivisionId = 0; Datas.SectionId = 0; Datas.SubSectionId = 0;
        if (profileID > 0)
        {
            Datas.ProfileId = profileID;
            Datas.UserId = applicationUser.UserID;
            documentProfileNoSeriesData = await Mediator.Send(new GetDocumentProfileNoSeriesById(profileID));
            if (documentProfileNoSeriesData != null)
            {
                if (!string.IsNullOrEmpty(documentProfileNoSeriesData.Abbreviation1))
                {
                    dynamic? abbreviation = JsonConvert.DeserializeObject(documentProfileNoSeriesData.Abbreviation1);
                    if (abbreviation != null)
                    {
                        foreach (var item in abbreviation)
                        {
                            var itemsId = item.Id;
                            if (itemsId == 1)
                            {
                                isPlant = true; isMainHeader = true;
                                Datas.PlantId = null;
                            }
                            if (itemsId == 2)
                            {
                                isDepartment = true; isDivision = true;
                                Datas.DepartmentId = null;
                                Datas.DivisionId = null;
                            }
                            if (itemsId == 3)
                            {
                                isSection = true;
                                Datas.SectionId = null;
                            }
                            if (itemsId == 4)
                            {
                                isSubSection = true;
                                Datas.SubSectionId = null;
                            }
                        }
                    }
                }
            }
        }

        await SelectedItemChanged(0);
        await SelectedItemDivisionChanged(0);
        await SelectedItemDepartementChanged(0);
        await SelectedItemSectionChanged(0);
        StateHasChanged();
    }
    string? QueryPlantText(DropDownBoxQueryDisplayTextContext arg)
    {
        Datas.PlantId = isPlant == false ? 0 : null;
        Datas.DivisionId = isDivision == false ? 0 : null;
        Datas.DepartmentId = isDepartment == false ? 0 : null;
        Datas.SectionId = isSection == false ? 0 : null;
        Datas.SubSectionId = isSubSection == false ? 0 : null;
        DivisionValue = null; DepartmentValue = null; SectionValue = null; SubSectionValue = null;
        string? returnData = string.Empty;
        if (arg.Value is ViewPlants value)
        {
            if (value != null)
            {
                Datas.PlantId = value.PlantID;
                returnData = value?.PlantCode;
            }
        }
        InvokeAsync(SelectedItemPlantChanged);
        return returnData;
    }
    async Task SelectedItemPlantChanged()
    {
        await SelectedItemChanged(Datas.PlantId);
    }
    void GridSelectedDataItemChanged(object item, IDropDownBox dropDownBox)
    {
        if (item != null)
        {
            PlantValue = item as ViewPlants;
        }
        dropDownBox.HideDropDown();
    }
    async Task SelectedItemChanged(long? plantID)
    {
        _divisionItems = new List<ViewDivision>();
        _departmentItems = new List<ViewDepartment>();
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (plantID > 0)
        {
            _divisionItems = await Mediator.Send(new GetDivisionByCompany(plantID));
        }
    }
    void GridDivisionSelectedDataItemChanged(object item, IDropDownBox dropDownBox)
    {
        if (item != null)
        {
            DivisionValue = item as ViewDivision;
        }
        dropDownBox.HideDropDown();
    }
    string? QueryDivisionText(DropDownBoxQueryDisplayTextContext arg)
    {
        Datas.DivisionId = isDivision == false ? 0 : null;
        Datas.DepartmentId = isDepartment == false ? 0 : null;
        Datas.SectionId = isSection == false ? 0 : null;
        Datas.SubSectionId = isSubSection == false ? 0 : null;
        string? returnData = string.Empty; DepartmentValue = null; SectionValue = null; SubSectionValue = null;
        if (arg.Value is ViewDivision value)
        {
            if (value != null)
            {
                Datas.DivisionId = value.DivisionID;
                returnData = value?.Name;
            }
        }
        InvokeAsync(SelectedItemDivisionChangeds);
        return returnData;
    }
    async Task SelectedItemDivisionChangeds()
    {
        await SelectedItemDivisionChanged(Datas.DivisionId);
    }
    async Task SelectedItemDivisionChanged(long? divisionId)
    {
        _departmentItems = new List<ViewDepartment>();
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (divisionId > 0)
        {
            _departmentItems = await Mediator.Send(new GetDepartmentByDivision(divisionId));
        }
    }

    void GridDepartmentSelectedDataItemChanged(object item, IDropDownBox dropDownBox)
    {
        if (item != null)
        {
            DepartmentValue = item as ViewDepartment;
        }
        dropDownBox.HideDropDown();
    }
    string? QueryDepartmentText(DropDownBoxQueryDisplayTextContext arg)
    {

        Datas.DepartmentId = isDepartment == false ? 0 : null;
        Datas.SectionId = isSection == false ? 0 : null;
        Datas.SubSectionId = isSubSection == false ? 0 : null;
        string? returnData = string.Empty; SectionValue = null; SubSectionValue = null;
        if (arg.Value is ViewDepartment value)
        {
            if (value != null)
            {
                Datas.DepartmentId = value.DepartmentId;
                returnData = value?.DepartmentName;
            }
        }
        InvokeAsync(SelectedItemDepartementChangeds);
        return returnData;
    }
    async Task SelectedItemDepartementChangeds()
    {
        await SelectedItemDepartementChanged(Datas.DepartmentId);
    }

    async Task SelectedItemDepartementChanged(long? departmentId)
    {
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (departmentId > 0)
        {
            _sectionItems = await Mediator.Send(new GetSectionByDepartment(departmentId));
        }
    }

    void GridSectionSelectedDataItemChanged(object item, IDropDownBox dropDownBox)
    {
        if (item != null)
        {
            SectionValue = item as ViewSection;
        }
        dropDownBox.HideDropDown();
    }
    string? QuerySectionText(DropDownBoxQueryDisplayTextContext arg)
    {
        Datas.SectionId = isSection == false ? 0 : null;
        Datas.SubSectionId = isSubSection == false ? 0 : null;
        SubSectionValue = null;
        string? returnData = string.Empty;
        if (arg.Value is ViewSection value)
        {
            if (value != null)
            {
                Datas.SectionId = value.SectionId;
                returnData = value?.SectionName;
            }
        }
        InvokeAsync(SelectedItemSectionChangeds);
        return returnData;
    }
    async Task SelectedItemSectionChangeds()
    {
        await SelectedItemSectionChanged(Datas.SectionId);
    }

    async Task SelectedItemSectionChanged(long? sectionId)
    {
        _subSectionItems = new List<ViewSubSection>();
        if (sectionId > 0)
        {
            _subSectionItems = await Mediator.Send(new GetSubSectionBySection(sectionId));
        }
    }
    string? QuerySubSectionText(DropDownBoxQueryDisplayTextContext arg)
    {
        Datas.SubSectionId = isSubSection == false ? 0 : null;
        string? returnData = string.Empty;
        if (arg.Value is ViewSubSection value)
        {
            if (value != null)
            {
                Datas.SubSectionId = value.SubSectionId;
                returnData = value?.SubSectionName;
            }
        }
        return returnData;
    }
    void GridSubSectionSelectedDataItemChanged(object item, IDropDownBox dropDownBox)
    {
        if (item != null)
        {
            SubSectionValue = item as ViewSubSection;
        }
        dropDownBox.HideDropDown();
    }
    public async Task CloseFilterFormPopup(AttributeFilterDetails ab)
    {
        if (_attributeFilterDetailsList == null)
        {
            _attributeFilterDetailsList = new List<AttributeFilterDetails>();
        }
        var exits = _attributeFilterDetailsList.Where(w => w.AttributeName == ab.AttributeName).FirstOrDefault();
        if (exits == null)
        {
            _attributeFilterDetailsList.Add(ab);
        }
        else
        {
            int index = _attributeFilterDetailsList.FindIndex(a => a.AttributeName == ab.AttributeName);
            _attributeFilterDetailsList[index] = ab;
        }
        DynamicFormFilterBypopup = false;
        CreateEditFormFields();
        StateHasChanged();
    }
    void CheckApproval()
    {
        if (_dynamicFormApprovedList != null && _dynamicFormApprovedList.Count > 0)
        {
            var notApproved = _dynamicFormApprovedList.Where(z => z.IsApproved != true).OrderBy(o => o.DynamicFormApprovedId).ToList();
            var isApprovedListData = _dynamicFormApprovedList.Where(z => z.IsApproved == true).OrderBy(o => o.DynamicFormApprovedId).ToList();
            var isNotApproved = notApproved.OrderBy(o => o.DynamicFormApprovedId).FirstOrDefault()?.UserId;
            if (isNotApproved == applicationUser.UserID)
            {
                var UserApproveData = notApproved.FirstOrDefault(a => a.UserId == applicationUser.UserID);
                if (UserApproveData != null)
                {
                    dynamicFormApproval.ApprovedDescription = UserApproveData?.ApprovedDescription;
                    dynamicFormApproval.DynamicFormApprovalId = UserApproveData?.DynamicFormApprovalId;
                    dynamicFormApproval.DynamicFormApprovedId = UserApproveData.DynamicFormApprovedId;
                    dynamicFormApproval.DynamicFormDataId = UserApproveData.DynamicFormDataId;
                    if (IsSendApproval == true)
                    {
                        if (UserApproveData.IsApproved == false)
                        {
                            IsApprovalApproved = true;
                            IsApprovalRejected = false;
                        }
                        else if (UserApproveData.IsApproved == true)
                        {
                            IsApprovalApproved = false;
                            IsApprovalRejected = true;
                        }
                        else
                        {
                            IsApprovalApproved = true;
                            IsApprovalRejected = true;
                        }

                    }
                }
                else
                {
                    isVisibleButton = false; IsSave = false;
                    isApproval = true;
                }
            }
            else
            {
                var isnotApproved = notApproved.FirstOrDefault(f => f.IsApproved == null);
                if (isnotApproved != null)
                {
                    isApproval = false;
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true;
                    }
                    else
                    {
                        var approvedPending = _dynamicFormApprovedList.Where(w => w.IsApproved == null).ToList();
                        var approved = _dynamicFormApprovedList.Where(w => w.IsApproved == true).ToList();
                        var appPre = 0;
                        if (approvedPending != null && approvedPending.Count > 0)
                        {
                            if (approved != null && approved.Count() > 0)
                            {
                                var isapproved = approved.OrderByDescending(o => o.DynamicFormApprovedId).FirstOrDefault(w => w.IsApproved == true);
                                if (isapproved != null)
                                {
                                    appPre = 1;
                                }
                            }
                            var isapprovedPending = approvedPending.OrderBy(o => o.DynamicFormApprovedId).FirstOrDefault(w => w.IsApproved == null);
                            if (isapprovedPending != null)
                            {

                                if (appPre == 1)
                                {
                                    // isVisibleButton = "display:none;"; IsSave = false;
                                }
                            }
                        }
                    }
                }
                else
                {
                    isVisibleButton = false; IsSave = false;
                    isApproval = false;
                }
            }
            var isApprovedAs = isApprovedListData.FirstOrDefault(f => f.UserId == applicationUser.UserID);
            if (isApprovedAs != null)
            {
                isVisibleButton = false; IsSave = false;
                isApproval = true;
            }
            else
            {
                var rejectedStatus = _dynamicFormApprovedList.Where(z => z.IsApproved == false).FirstOrDefault();
                if (rejectedStatus != null)
                {
                    if (rejectedStatus.UserId != applicationUser.UserID)
                    {
                        isVisibleButton = false; IsSave = false;
                    }
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true; isVisibleButton = false; IsSave = false;
                    }
                }
                else
                {
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true; isVisibleButton = false; IsSave = false;
                    }
                }
            }
        }
    }
    void onClickApprove()
    {
        ApproveRejectName = "Approve";
        IsDescriptionOpen = true; IsWokFlowDescriptionOpen = false;
        dynamicFormApproval.IsApproved = true;
    }
    void onClickReject()
    {
        ApproveRejectName = "Reject";
        IsDescriptionOpen = true; IsWokFlowDescriptionOpen = false;
        dynamicFormApproval.IsApproved = false;
    }
    async Task OnUpdateDescription()
    {
        await UpdateStatusApproval();
        IsDescriptionOpen = false; IsWokFlowDescriptionOpen = false;
    }
    async Task UpdateStatusApproval()
    {
        dynamicFormApproval.ApprovedByUserId = applicationUser.UserID;
        dynamicFormApproval.ApprovedDate = DateTime.Now;
        var response = await Mediator.Send(new UpdateDynamicFormApprovedByStaus(dynamicFormApproval));
        if (response != null)
        {
            if (response.IsApproved == true)
            {
                toastService.ShowToast("Satus Approved Successfully", AC.SD.Core.Services.ToastLevel.Success);
            }
            if (response.IsApproved == false)
            {
                toastService.ShowToast("Satus Rejected Successfully", AC.SD.Core.Services.ToastLevel.Success);
            }
            dynamicFormApproval = new DynamicFormApproved();
            await loadDynamicForm();
        }
    }
    void OnTabClick(TabClickEventArgs e)
    {
        if (e.TabIndex == 0)
        {
            InvokeAsync(loadDynamicForm);
        }
    }
    private static bool IsValidJson(string strInput)
    {
        if (string.IsNullOrWhiteSpace(strInput)) { return false; }
        strInput = strInput.Trim();
        if ((strInput.StartsWith("{") && strInput.EndsWith("}")) || //For object
            (strInput.StartsWith("[") && strInput.EndsWith("]"))) //For array
        {
            try
            {
                var obj = JToken.Parse(strInput);
                return true;
            }
            catch (JsonReaderException jex)
            {
                //Exception in parsing json
                return false;
            }
            catch (Exception ex) //some other exception
            {
                return false;
            }
        }
        else
        {
            return false;
        }
    }
    void backUrl()
    {
        string str = NavigationManager.Uri;
        string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();
        string[] UrlList = rep1.Split("/");
        string names = "DynamicMasterSetupList";
        if (UrlList[0].ToLower() == "DynamicFormWorkFlowList".ToLower())
        {
            NavigationManager.NavigateTo("DynamicFormWorkFlowList");
        }
        else if (UrlList[0].ToLower() == "DynamicFormApprovedMainList".ToLower())
        {
            NavigationManager.NavigateTo("DynamicFormApprovedMainList/DynamicFormApprovedList/" + SessionId);
        }
        else if (UrlList[0].ToLower() == "dynamicFormMenuList".ToLower())
        {
            NavigationManager.NavigateTo("dynamicFormMenuList/dynamicFormMenuList/" + SessionId);
        }
        else if (UrlList[0].ToLower() == "DynamicFormWorkFlowSectionApprovalLists".ToLower())
        {
            NavigationManager.NavigateTo("DynamicFormWorkFlowSectionApprovalLists");
        }
        else
        {
            if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names.ToLower())
            {
                NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicFormList/" + SessionId);
            }
            else
            {
                NavigationManager.NavigateTo("DynamicMasterSetup/dynamicFormMasterList/" + SessionId);

            }
        }
    }
    void ResetForm()
    {

    }
    async void addNew()
    {
        if (SessionIds != null)
        {
            SessionIds = null;
            _dynamicformData = null;
            string str = NavigationManager.Uri;
            string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();
            string[] UrlList = rep1.Split("/");
            string names = "DynamicMasterSetupList";
            if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names.ToLower())
            {
                NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId);
            }
            else if (UrlList[0].ToLower() == "dynamicFormMenuList".ToLower())
            {
                NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId);
            }
            else
            {
                NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId);

            }
        }
        else
        {
            await loadDynamicForm();
        }
    }
    private async Task SubmitApproveFormExternally()
    {
        IsSendApproval = true;
        if (_editContext.Validate() && _editContexts.Validate())
        {
            IsSendApproval = true;
            await this.HandleFormValidApprovalSubmit();
        }
    }
    async Task SubmitFormExternallyWithWorkFlow()
    {
        if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count > 0)
        {
            if (_editContext.Validate() && _editContexts.Validate())
            {
                var _dynamicFormWorkFlowFormListItems = await Mediator.Send(new GetDynamicFormWorkFlowFormList(_dynamicform?.ID, _dynamicformData?.DynamicFormDataId));
                _dynamicFormWorkFlowFormListItems = _dynamicFormWorkFlowFormListItems != null ? _dynamicFormWorkFlowFormListItems : new List<DynamicFormWorkFlowForm>();
                _dynamicFormWorkFlowSectionNoWorkFlowSection = new List<DynamicFormWorkFlowSection>();
                if (_dynamicFormWorkFlowSectionNoWorkFlowSectionItems != null && _dynamicFormWorkFlowSectionNoWorkFlowSectionItems.Count() > 0)
                {
                    var seQlist = _dynamicFormWorkFlowSectionNoWorkFlowSectionItems.Select(s => s.SequenceNo).Distinct().ToList();
                    if (seQlist != null && seQlist.Count() > 0)
                    {

                        seQlist.ForEach(q =>
                        {
                            var seNo = _dynamicFormWorkFlowFormListItems.Where(w => w.SequenceNo == q).FirstOrDefault();
                            var name = _dynamicFormWorkFlowSectionNoWorkFlowSectionItems.Where(w => w.SequenceNo == q).Select(a => a.SectionName).ToList();
                            var n1 = _dynamicFormWorkFlowSectionNoWorkFlowSectionItems.Where(w => w.SequenceNo == q).FirstOrDefault();
                            n1.CurrentApprovalUserName = seNo?.CurrentApprovalUserName;
                            n1.ApprovedStatus = seNo?.ApprovedStatus;
                            n1.IsDynamicFormWorkFlowApproval = seNo?.DynamicFormWorkFlowFormTotalCount > 0 ? true : false;
                            n1.SectionName = string.Join(',', name);
                            _dynamicFormWorkFlowSectionNoWorkFlowSection.Add(n1);
                        });
                    }
                    WithWorkFlowStartPopup = true;
                    StateHasChanged();
                }
            }
        }
        else
        {
            await SubmitFormExternally();
        }
    }
    async Task SubmitFormExternallyWorkFlowSubmitNo()
    {
        await SubmitFormExternally();

    }
    async Task SubmitFormExternallyWorkFlowSubmitYes()
    {

        if (_dynamicFormWorkFlowSectionNoWorkFlowSection != null && _dynamicFormWorkFlowSectionNoWorkFlowSection.Count() > 0)
        {
            var isChecked = _dynamicFormWorkFlowSectionNoWorkFlowSection.Where(w => w.Checked == true).ToList();

            if (isChecked.Count() > 0)
            {
                await SubmitFormExternally();
                await Task.Delay(2000);
                await addWorlflowAdd();
            }
            else
            {
                toastService.ShowToast("Workflow Seqno must select", AC.SD.Core.Services.ToastLevel.Warning);
            }
        }
    }
    private async Task SubmitFormExternally()
    {
        IsSendApproval = false;
        if (_editContext.Validate() && _editContexts.Validate())
        {
            IsSendApproval = false;

            await this.HandleValidSubmit();
        }
    }
    void formSubmitEnabled()
    {
        if (isVisibleButton == true)
        {
            isVisibleButton = false;
        }
        if (IsSendApprovalVisible == true)
        {
            IsSendApprovalVisible = false;
        }
        if (IsApprovalApproved == true)
        {
            IsApprovalApproved = false;
        }
        if (IsApprovalRejected == true)
        {
            IsApprovalRejected = false;
        }
        if (IsUploadEnabled == true)
        {
            IsUploadEnabled = false;
        }
        if (isWorkflowEnabled == true)
        {
            isWorkflowEnabled = false;
        }
        if (isSaveEnabled == true)
        {
            isSaveEnabled = false;
        }
    }
    async Task HandleFormValidApprovalSubmit()
    {
        isSubmit = true;
        if (isRequiredCount == 0)
        {
            if (IsSave == true || IsApprovalSave == true)
            {
                formSubmitEnabled();
                var datas = Data;
                string strJson = JsonConvert.SerializeObject(datas);
                loading = true;
                dynamicFormData.DynamicFormId = _dynamicform.ID;
                if (dynamicFormData.DynamicFormDataId > 0)
                {
                    var editReq = new InsertOrUpdateDynamicFormData
                    {
                        AddTempSectionAttributes = addTempSectionAttributes,
                        DynamicFormProfile = Datas,
                        ProfileId = _dynamicformData.ProfileId,
                        ProfileNo = _dynamicformData.ProfileNo,
                        DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                        DynamicFormId = _dynamicform.ID,
                        DynamicFormItem = strJson,
                        SessionId = dynamicFormData.SessionId,
                        ModifiedByUserID = applicationUser.UserID,
                        AddedByUserID = dynamicFormData.AddedByUserID,
                        ModifiedDate = DateTime.Now,
                        StatusCodeID = 1,
                        AddedDate = dynamicFormData.AddedDate,
                        AttributeHeader = _AttributeHeader,
                        ObjectData = Data,
                        IsSendApproval = IsSendApproval,
                        FileProfileSessionID = FileProfileSessionId,
                        DynamicFormDataGridId = _dynamicformData.DynamicFormDataGridId,
                    };

                    var result = await Mediator.Send(editReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        //if (IsSendApproval == true)
                        // {
                        if (_dynamicFormApprovedList == null)
                        {
                            await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                            await loadDynamicForm();
                        }
                        else
                        {
                            if (_dynamicFormApprovedList.Count == 0)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                        }
                        //}
                        // else
                        //{
                        //      await loadDynamicForm();
                        // }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            _dynamicformData.ProfileId = result.ProfileId; _dynamicformData.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        toastService.ShowToast("Record updated Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        loading = false;
                        //await onApproved();
                    }
                    StateHasChanged();
                }
                else
                {
                    var createReq = new InsertOrUpdateDynamicFormData
                    {
                        AddTempSectionAttributes = addTempSectionAttributes,
                        DynamicFormProfile = Datas,
                        ProfileId = dynamicFormData.ProfileId,
                        DynamicFormItem = strJson,
                        DynamicFormId = _dynamicform.ID,
                        SessionId = Guid.NewGuid(),
                        AddedByUserID = applicationUser.UserID,
                        ModifiedByUserID = applicationUser.UserID,
                        ModifiedDate = DateTime.Now,
                        StatusCodeID = 1,
                        AddedDate = DateTime.Now,
                        AttributeHeader = _AttributeHeader,
                        ObjectData = Data,
                        IsSendApproval = IsSendApproval,
                    };
                    var result = await Mediator.Send(createReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        toastService.ShowToast("Record save Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        dynamicFormDataId = result.DynamicFormDataId;
                        dynamicFormData.DynamicFormDataId = dynamicFormDataId.Value;
                        // if (IsSendApproval == true)
                        // {
                        if (_dynamicFormApprovedList == null)
                        {
                            await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                            await loadDynamicForm();
                        }
                        else
                        {
                            if (_dynamicFormApprovedList.Count == 0)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                        }
                        // }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        loading = false;
                        // await onApproved();
                    }
                    loading = false;
                    redirectToPage(SessionId, createReq.SessionId);
                    StateHasChanged();
                }
            }
        }
        else
        {
            toastService.ShowToast("Validation error occured.Please check the required field values!.", AC.SD.Core.Services.ToastLevel.Warning);
        }
    }
    async Task HandleFormValidSubmit()
    {
        isSubmit = true;
        if (isRequiredCount == 0)
        {
            if (IsSave == true || IsApprovalSave == true)
            {
                formSubmitEnabled();
                var datas = Data;
                string strJson = JsonConvert.SerializeObject(datas);
                loading = true;
                dynamicFormData.DynamicFormId = _dynamicform.ID;
                if (dynamicFormData.DynamicFormDataId > 0)
                {
                    var editReq = new InsertOrUpdateDynamicFormData
                    {
                        AddTempSectionAttributes = addTempSectionAttributes,
                        DynamicFormProfile = Datas,
                        ProfileId = _dynamicformData.ProfileId,
                        ProfileNo = _dynamicformData.ProfileNo,
                        DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                        DynamicFormId = _dynamicform.ID,
                        DynamicFormItem = strJson,
                        SessionId = dynamicFormData.SessionId,
                        ModifiedByUserID = applicationUser.UserID,
                        AddedByUserID = dynamicFormData.AddedByUserID,
                        ModifiedDate = DateTime.Now,
                        StatusCodeID = 1,
                        AddedDate = dynamicFormData.AddedDate,
                        AttributeHeader = _AttributeHeader,
                        ObjectData = Data,
                        IsSendApproval = IsSendApproval,
                        FileProfileSessionID = FileProfileSessionId,
                        DynamicFormDataGridId = _dynamicformData.DynamicFormDataGridId,
                        DynamicFormSectionGridAttributeId = _dynamicformData.DynamicFormSectionGridAttributeId,
                        GridSortOrderByNo = _dynamicformData.GridSortOrderByNo,
                    };

                    var result = await Mediator.Send(editReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        if (IsSendApproval == true)
                        {
                            if (_dynamicFormApprovedList == null)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                            else
                            {
                                if (_dynamicFormApprovedList.Count == 0)
                                {
                                    await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                    await loadDynamicForm();
                                }
                            }
                        }
                        else
                        {
                            await loadDynamicForm();
                        }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            _dynamicformData.ProfileId = result.ProfileId; _dynamicformData.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        toastService.ShowToast("Record updated Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        loading = false; WithWorkFlowStartPopup = false;
                        //await onApproved();
                    }
                    StateHasChanged();
                }
                else
                {
                    var createReq = new InsertOrUpdateDynamicFormData
                    {
                        AddTempSectionAttributes = addTempSectionAttributes,
                        DynamicFormProfile = Datas,
                        ProfileId = dynamicFormData.ProfileId,
                        DynamicFormItem = strJson,
                        DynamicFormId = _dynamicform.ID,
                        SessionId = Guid.NewGuid(),
                        AddedByUserID = applicationUser.UserID,
                        ModifiedByUserID = applicationUser.UserID,
                        ModifiedDate = DateTime.Now,
                        StatusCodeID = 1,
                        AddedDate = DateTime.Now,
                        AttributeHeader = _AttributeHeader,
                        ObjectData = Data,
                        IsSendApproval = IsSendApproval,
                    };
                    var result = await Mediator.Send(createReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        toastService.ShowToast("Record save Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        dynamicFormDataId = result.DynamicFormDataId;
                        dynamicFormData.DynamicFormDataId = dynamicFormDataId.Value;
                        if (IsSendApproval == true)
                        {
                            if (_dynamicFormApprovedList == null)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                            else
                            {
                                if (_dynamicFormApprovedList.Count == 0)
                                {
                                    await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                    await loadDynamicForm();
                                }
                            }
                        }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        loading = false; WithWorkFlowStartPopup = false;
                        // await onApproved();
                    }
                    loading = false;
                    redirectToPage(SessionId, createReq.SessionId);
                    StateHasChanged();
                }
            }
        }
        else
        {
            toastService.ShowToast("Validation error occured.Please check the required field values!.", AC.SD.Core.Services.ToastLevel.Warning);
        }
    }
    void redirectToPage(Guid? SessionId1, Guid? createReqSessionId)
    {
        string str = NavigationManager.Uri;
        string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();
        string[] UrlList = rep1.Split("/");
        string names = "DynamicMasterSetupList"; string names1 = "dynamicFormMenuList";
        string? IpirSessionId = GetQueryParm("SessionId");
        string? IpirTypeName = GetQueryParm("Type");
        if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names.ToLower())
        {
            if (!string.IsNullOrEmpty(IpirTypeName))
            {
                long? IpirType = (long?)Convert.ToInt64(IpirTypeName);
                if (IpirType > 0)
                {
                    if (!string.IsNullOrEmpty(IpirSessionId))
                    {
                        bool isValid = Guid.TryParse(IpirSessionId, out _);
                        if (isValid == true)
                        {
                            NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId1 + "/" + createReqSessionId + "?SessionId=" + IpirSessionId + "&&Type=" + IpirTypeName);
                        }
                        else
                        {
                            NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                        }
                    }
                    else
                    {
                        NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                    }
                }
                else
                {
                    NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                }
            }
            else
            {
                NavigationManager.NavigateTo("DynamicMasterSetupList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
            }
        }
        else if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names1.ToLower())
        {
            if (!string.IsNullOrEmpty(IpirTypeName))
            {
                long? IpirType = (long?)Convert.ToInt64(IpirTypeName);
                if (IpirType > 0)
                {
                    if (!string.IsNullOrEmpty(IpirSessionId))
                    {
                        bool isValid = Guid.TryParse(IpirSessionId, out _);
                        if (isValid == true)
                        {
                            NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId1 + "/" + createReqSessionId + "?SessionId=" + IpirSessionId + "&&Type=" + IpirTypeName);
                        }
                        else
                        {
                            NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                        }
                    }
                    else
                    {
                        NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                    }
                }
                else
                {
                    NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                }
            }
            else
            {
                NavigationManager.NavigateTo("dynamicFormMenuList/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
            }
        }
        else
        {
            if (!string.IsNullOrEmpty(IpirTypeName))
            {
                long? IpirType = (long?)Convert.ToInt64(IpirTypeName);
                if (IpirType > 0)
                {
                    if (!string.IsNullOrEmpty(IpirSessionId))
                    {
                        bool isValid = Guid.TryParse(IpirSessionId, out _);
                        if (isValid == true)
                        {
                            NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId1 + "/" + createReqSessionId + "?SessionId=" + IpirSessionId + "&&Type=" + IpirTypeName);
                        }
                        else
                        {
                            NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                        }
                    }
                    else
                    {
                        NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                    }
                }
                else
                {
                    NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
                }
            }
            else
            {
                NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId1 + "/" + createReqSessionId);
            }
        }
    }
    async Task InsertOrUpdateDynamicFormApprovedData(DynamicFormData dynamicFormData)
    {
        var response = await Mediator.Send(new InsertOrUpdateDynamicFormApproved(dynamicFormData));
    }
    async Task HandleValidSubmit()
    {
        if (_dynamicformData == null)
        {
            //if (isButtonClick == "Yes")
            // {
            // toastService.ShowToast("You must save record", AC.SD.Core.Services.ToastLevel.Error);
            //}
            //else
            // {
            if (isApproval == true && dynamicFormApproval.IsApproved == true)
            {
                isApprovedPopup = true;
            }
            else
            {
                await HandleFormValidSubmit();
            }
            //}
        }
        else
        {
            if (isApproval == true && dynamicFormApproval.IsApproved == true)
            {
                isApprovedPopup = true;
            }
            else
            {
                await HandleFormValidSubmit();
            }
        }
    }
    async Task onApproved()
    {
        if (isApproval == true)
        {
            if (dynamicFormApproval.IsApproved == true)
            {
                var createReq = new InsertDynamicFormApproved
                {
                    DynamicFormId = _dynamicform.ID,
                    DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                    DynamicFormApprovedId = dynamicFormApproval.DynamicFormApprovedId,
                    DynamicFormApprovalId = dynamicFormApproval.DynamicFormApprovalId,
                    ApprovedDescription = dynamicFormApproval.ApprovedDescription,
                    IsApproved = dynamicFormApproval.IsApproved,
                };
                var result = await Mediator.Send(createReq);
                if (result.DynamicFormApprovedId > 0)
                {
                    dynamicFormApproval.DynamicFormApprovedId = result.DynamicFormApprovedId;
                    isApprovedPopup = false;

                    isApproved = false; isVisibleButton = false;
                }
            }
        }
    }
    async Task OnApprovedForm()
    {
        await HandleFormValidSubmit();
    }
    void EulaPopupClosed(PopupClosedEventArgs args)
    {
        BackUpload();
        isApprovedPopup = false;
    }
    void backImageUpload()
    {
        imageUploadPopup = false;
        StateHasChanged();
    }
    void addUploadDocument()
    {
        var _DynamicFormDataUploadByPermission = DynamicFormDataUploadByPermissions;
        PopupUpload = true;
        StateHasChanged();
    }
    void BackUpload()
    {
        InvokeAsync(loadDynamicForm);
        PopupUpload = false;
        StateHasChanged();

    }

    void EulaPopupWorkFlowClosed()
    {
        isButtonClick = "";
        wokrFlowpopup = false;
        StateHasChanged();
    }
    void OnWorkFlowNo()
    {
        isButtonClick = "";
        wokrFlowpopup = false;
        StateHasChanged();
    }
    async Task OnWorkFlowYes()
    {
        await addWorlflowAdd();
    }
    void addWorlflow()
    {
        if (_dynamicformData == null)
        {
            toastService.ShowToast("You must save record", AC.SD.Core.Services.ToastLevel.Error);
        }
        else
        {
            wokrFlowpopup = true;
        }
    }
    async Task addWorlflowAdd()
    {
        isButtonClick = "Yes";

        if (dynamicFormData != null && dynamicFormData.DynamicFormDataId > 0 && _dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count() > 0)
        {
            bool exitsEnabled = false;
            if (_dynamicFormWorkFlowSectionNoWorkFlowSection != null && _dynamicFormWorkFlowSectionNoWorkFlowSection.Count() > 0)
            {
                var isChecked = _dynamicFormWorkFlowSectionNoWorkFlowSection.Where(w => w.Checked == true).ToList();

                if (isChecked.Count() > 0)
                {
                    foreach (var item in _dynamicFormWorkFlowSectionNoWorkFlow)
                    {
                        var exitsItems = isChecked.Where(w => w.SequenceNo == item.SequenceNo).FirstOrDefault();
                        if (exitsItems != null)
                        {
                            List<DynamicFormWorkFlowSection> ItemData = new List<DynamicFormWorkFlowSection>();
                            ItemData.Add(item);
                            bool shouldEnableWorkflow = false;
                            if (item.IsParallelWorkflow == true)
                            {
                                shouldEnableWorkflow = true;
                            }
                            else
                            {
                                var exitss = ItemData.FirstOrDefault(f => f.IsWorkFlowDone == 0);
                                if (exitss?.IsMultipleUser == true && exitss?.DynamicFormWorkFlowMultipleUsers?.Any(q => q.UserId == applicationUser.UserID) == true)
                                {
                                    shouldEnableWorkflow = true;
                                }
                                else
                                {
                                    var exitsUser = ItemData.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.UserId == applicationUser.UserID);
                                    if (exitsUser != null)
                                    {
                                        shouldEnableWorkflow = true;
                                    }
                                    else
                                    {
                                        var isAnomalous = ItemData.FirstOrDefault(f => f.IsWorkFlowDone == 0 && f.IsAnomalyStatus == true);
                                        if (isAnomalous != null)
                                        {
                                            shouldEnableWorkflow = true;
                                        }
                                    }
                                }
                            }
                            if (shouldEnableWorkflow)
                            {
                                var resultData = await Mediator.Send(new GetDynamicFormWorkFlowFormExits(item.DynamicFormWorkFlowSectionId, applicationUser.UserID, dynamicFormData.DynamicFormDataId));
                                if (resultData == null)
                                {

                                    var response = await Mediator.Send(new InsertOrUpdateFormWorkFlowSectionNoWorkFlow(ItemData, dynamicFormData.DynamicFormDataId, applicationUser.UserID));
                                    if (response != null)
                                    {
                                        exitsEnabled = true;
                                    }
                                }
                                else
                                {
                                    toastService.ShowToast(item.SequenceNo + "-Workflow Already Completed", AC.SD.Core.Services.ToastLevel.Error);
                                }
                            }
                        }
                    }

                    if (exitsEnabled == true)
                    {
                        wokrFlowpopup = false; isWorkflowEnabled = false; isSaveEnabled = false;
                        isVisibleButton = false;
                        IsUploadEnabled = false; IsSendApprovalVisible = false; IsApprovalApproved = false; IsApprovalRejected = false;
                        toastService.ShowToast("Workflow completed successfully", AC.SD.Core.Services.ToastLevel.Success);
                        await loadDynamicForm();
                        StateHasChanged();

                    }
                }
            }
        }
        else
        {
            await loadDynamicForm();
            StateHasChanged();
        }
    }
    async Task OnToastClick(long? Id)
    {
        isButtonClick = "Yes";

        if (dynamicFormData != null && dynamicFormData.DynamicFormDataId > 0 && _dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count() > 0)
        {
            var response = await Mediator.Send(new InsertOrUpdateFormWorkFlowSectionNoWorkFlow(_dynamicFormWorkFlowSectionNoWorkFlow, dynamicFormData.DynamicFormDataId, applicationUser.UserID));
            StateHasChanged();
        }
        else
        {
            StateHasChanged();
        }
    }
    void OnSectionUploadInfoClick()
    {
        addUploadDocument();
        // if (dynamicFormSection1 != null)
        // {
        //     if (dynamicFormSection1.DynamicFormDataUploadId > 0 && dynamicFormSection1.UploadSessionID != null && dynamicFormSection1.FileProfileSessionID != null && dynamicFormSection1.IsFileExits == "Yes")
        //     {
        //         var url = NavigationManager.BaseUri.ToString() + "fileprofiletype/" + dynamicFormSection1.FileProfileSessionID + "/" + dynamicFormSection1.UploadSessionID;
        //         await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
        //     }
        // }
    }
    void OnSectionInfoClick(DynamicFormSection dynamicFormSection)
    {
        IsSectionInfoOpen = true;
        DynamicFormInfoSection = dynamicFormSection;
        StateHasChanged();
    }
    void OnSectionLockClick(DynamicFormSection dynamicFormSection)
    {
        dynamicFormSectionData = dynamicFormSection;
        dynamicFormData.IsLocked = dynamicFormSectionData.DynamicFormDataSectionLock?.IsLocked == false ? true : false;
        SectionLockedName = "Unlock";
        if (dynamicFormData.IsLocked == true)
        {
            SectionLockedName = "Lock";
        }
        IsSectionLockOpen = true;
        StateHasChanged();
    }
    async Task addDetailEmailCreate()
    {
        _dynamicformData = await Mediator.Send(new GetDynamicFormDataBySessionId(SessionIds));
        if (_dynamicformData != null)
        {
            if (_dynamicformData.IsDraft == null)
            {
                createEmailpopup = true;
            }
            if (_dynamicformData.IsDraft == true)
            {
                var url = NavigationManager.BaseUri + "EmailDrafts";
                await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
            }
            if (_dynamicformData.IsDraft == false)
            {
                var url = NavigationManager.BaseUri + "ViewEmail/" + _dynamicformData.EmailTopicSessionId + "/Email";
                await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
            }
        }
    }
    async Task createEmailYes()
    {
        string str = NavigationManager.Uri;
        string rep1 = str.Replace(NavigationManager.BaseUri, "").ToLower();

        if (_dynamicformData != null)
        {
            string backurl = rep1;
            string[] UrlList = rep1.Split("/");
            string names1 = "dynamicFormMenuList";
            if (UrlList.Count() > 0 && UrlList[0] != null && UrlList[0].ToLower() == names1.ToLower())
            {
                backurl = "DynamicMasterSetupList/dynamicforms/" + SessionId + "/" + SessionIds;
            }
            var result = await refDynamicFormDataEmailAddSubContent?.saveEmailSubjectContent();
            if (result == true)
            {
                var insertData = new DynamicFormData
                {
                    AddedByUserID = applicationUser.UserID,
                    ModifiedByUserID = applicationUser.UserID,
                    AddedDate = DateTime.Now,
                    ModifiedDate = DateTime.Now,
                    SessionId = _dynamicformData.SessionId,
                    ProfileNo = _dynamicformData.ProfileNo,
                    StatusCodeID = 1,
                    DynamicFormDataId = _dynamicformData.DynamicFormDataId,
                    BackUrl = backurl
                };
                var response = await Mediator.Send(new InsertCreateEmailFormData(insertData));
                if (response.DynamicFormDataId > 0)
                {
                    toastService.ShowToast("Email created successfully.", AC.SD.Core.Services.ToastLevel.Success);
                    createEmailpopup = false;
                    var url = NavigationManager.BaseUri + "CreateEmail/" + dynamicFormData.SessionId;
                    await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
                    await loadDynamicForm();
                }
            }
        }
        StateHasChanged();
    }
    async Task OnShowImageUploadClick(DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        _filterDynamicFormSectionAttribute = dynamicFormSectionAttribute;
        imageUploadPopup = true;
        StateHasChanged();
    }
    void OnTooltipsClick(string? attrName, string? toolTips)
    {
        _tooltipShowId = attrName;
        _tooltipInstruction = toolTips;
        IsTooltipInfoOpen = true;
        StateHasChanged();
    }
    void OnDynamicFormFilterBypopup(string? attrName, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute, string? dataSourceName)
    {
        _filterDynamicFormSection = dynamicFormSection;
        _dataSourceName = dataSourceName;
        _filterDynamicFormSectionAttribute = dynamicFormSectionAttribute;
        _filterAttrName = attrName;
        _PlantLoadDependencyId = null;
        if (dynamicFormSectionAttribute.IsPlantLoadDependency == true && dynamicFormSectionAttribute.AttributeHeaderDataSource.Count > 0)
        {
            if (Data.GetType().GetProperty(dynamicFormSectionAttribute.DynamicAttributeName) != null)
            {
                var plantIdss = (long?)Data.GetType().GetProperty(dynamicFormSectionAttribute.DynamicAttributeName).GetValue(Data);
                if (plantIdss > 0)
                {
                    _PlantLoadDependencyId = plantIdss;
                    DynamicFormFilterBypopup = true;
                }
                else
                {
                    toastService.ShowToast("Must Select " + dynamicFormSectionAttribute.DisplayName, AC.SD.Core.Services.ToastLevel.Error);
                }
            }
        }
        else
        {
            DynamicFormFilterBypopup = true;
        }
        StateHasChanged();
    }
    void FormulaCalulationValues(DynamicFormSection dynamicFormSection)
    {
        var res = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.FormulaTextBox != null && w.FormulaTextBox != "").OrderBy(o => o.SortOrderBy).ToList();
        if (res != null && res.Count() > 0)
        {
            res.ForEach(s =>
            {
                var property = Data.GetType().GetProperty(s.DynamicAttributeName);
                if (property != null)
                {
                    FormatValesSetData(property, dynamicFormSection, s);
                    var dynamicFormSectionAttribute = s;
                }
            });
        }
    }
    void OnSpinEditChangedItem(decimal? str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        FormulaCalulationValues(dynamicFormSection);
    }
    void OnSpinEditChangedItem1(int? str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        FormulaCalulationValues(dynamicFormSection);
    }
    void OnSpinTextChangedItem(Microsoft.AspNetCore.Components.Web.MouseEventArgs str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute, DynamicFormSectionAttrFormulaFunction colorCodeExitss)
    {
        dynamicFormSectionAttrFormulaFunction1 = colorCodeExitss;
        dynamicFormSectionAttrFormulaFunction1.FormulaTextBox = dynamicFormSectionAttribute.FormulaTextBox;
        dynamicFormSectionAttrFormulaEnabled = true;
    }
    void OnTextChangedItem(Microsoft.AspNetCore.Components.Web.MouseEventArgs str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        //property.SetValue(Data, str);
        FormatValesSetData(property, dynamicFormSection, dynamicFormSectionAttribute);
    }
    void FormatValesSetData(PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        try
        {
            if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.FormulaTextBox))
            {
                List<DropDownOptionsModel> dropDownOptionsModels = new List<DropDownOptionsModel>();
                string str2 = dynamicFormSectionAttribute.FormulaTextBox;
                if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.FormulaTextBox))
                {
                    for (int i = 20001; i-- > 0;)
                    {
                        str2 = str2.Replace("^" + i, "");
                        str2 = str2.Replace("-" + i, "");
                        str2 = str2.Replace("/" + i, "");
                    }
                }
                var values = str2.Split("$");
                var formulaText = dynamicFormSectionAttribute.FormulaTextBox;
                List<string> list = new List<string>();
                if (values.Length > 0)
                {
                    foreach (var item in values)
                    {
                        if (!string.IsNullOrEmpty(item))
                        {
                            var names = Regex.Replace(item, @"[^0-9a-zA-Z_]+", "").Split("_").ToList();
                            if (names.Count() > 0)
                            {
                                var name1 = names.ElementAtOrDefault(0) != null;
                                var name2 = names.ElementAtOrDefault(1) != null;
                                if (name1 == true)
                                {
                                    if (name2 == true)
                                    {
                                        list.Add(names[0]);
                                        DropDownOptionsModel dropDownOptionsModel = new DropDownOptionsModel();
                                        dropDownOptionsModel.Id = (long?)Convert.ToInt64(names[0]);
                                        dropDownOptionsModel.Text = dropDownOptionsModel.Id + "_" + Regex.Replace(names[1], @"[^0-9a-zA-Z_]+", "");
                                        dropDownOptionsModel.Value = names[0];
                                        dropDownOptionsModels.Add(dropDownOptionsModel);
                                    }
                                }
                            }
                        }
                    }
                }
                list = list.Distinct().ToList();
                if (list.Count > 0)
                {
                    int i = 65;
                    list.ForEach(s =>
                    {
                        if (!string.IsNullOrEmpty(s))
                        {
                            string strAlpha = ((char)i).ToString();
                            var SData = dropDownOptionsModels.FirstOrDefault(f => f.Value == s)?.Text;
                            if (SData != null)
                            {
                                formulaText = formulaText.Replace("$" + SData, strAlpha.ToUpper() + strAlpha.ToUpper());
                                i++;
                            }
                        }
                    });
                    ExpressionMathEval expressions = new ExpressionMathEval(formulaText);
                    int j = 65;
                    list.ForEach(s =>
                    {
                        if (!string.IsNullOrEmpty(s))
                        {
                            string strAlpha = ((char)j).ToString();
                            var attrNames = _AttributeHeader.DynamicFormSectionAttribute.FirstOrDefault(f => f.DynamicFormSectionAttributeId == (long?)Convert.ToInt64(s))?.DynamicAttributeName;
                            if (Data.GetType().GetProperty(attrNames) != null)
                            {
                                var avluess = Data.GetType().GetProperty(attrNames).GetValue(Data);
                                expressions.Bind(strAlpha.ToUpper() + strAlpha.ToUpper(), avluess == null ? 0 : avluess);
                            }
                            else
                            {
                                expressions.Bind(strAlpha.ToUpper() + strAlpha.ToUpper(), 0);
                            }
                            j++;

                        }
                    });
                    List<String> errors = expressions.GetError();

                    if (errors.Count == 0)
                    {
                        Object valuess = expressions.Eval();
                        var objectValue = (decimal?)valuess;
                        if (objectValue > 0)
                        {
                            if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.ControlType))
                            {
                                if (dynamicFormSectionAttribute.ControlType.ToLower() == "TextBox".ToLower())
                                {
                                    property.SetValue(Data, objectValue.ToString());
                                }
                                else
                                {
                                    if (dynamicFormSectionAttribute.ControlType.ToLower() == "SpinEdit".ToLower())
                                    {
                                        if (dynamicFormSectionAttribute.IsSpinEditType == "decimal")
                                        {
                                            property.SetValue(Data, objectValue);
                                        }
                                        if (dynamicFormSectionAttribute.IsSpinEditType == "int")
                                        {
                                            property.SetValue(Data, (int?)objectValue);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else
                    {
                        toastService.ShowToast(errors[0], AC.SD.Core.Services.ToastLevel.Error);
                    }
                }
            }
        }
        catch (Exception ex)
        {
            toastService.ShowToast(ex.Message, AC.SD.Core.Services.ToastLevel.Error);
        }
    }
    public static string FormatSize(decimal bytes)
    {
        string[] suffixes = { "Bytes", "KB", "MB", "GB", "TB", "PB" };
        int counter = 0;
        decimal number = (decimal)bytes;
        while (Math.Round(number / 1024) >= 1)
        {
            number = number / 1024;
            counter++;
        }
        return string.Format("{0:n1} {1}", number, suffixes[counter]);
    }
    async Task revokeDynamicFormUploadImageList(DynamicFormDataAttrUpload dynamicFormDataAttrUploads)
    {
        var indexof = _DynamicFormDataAttrUploadList.IndexOf(dynamicFormDataAttrUploads);
        _DynamicFormDataAttrUploadList.RemoveAt(indexof);
    }
    async Task OnFilesUploading(FilesUploadingEventArgs args, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {

        if (_dynamicformData == null)
        {
            foreach (var file in args.Files)
            {
                using var stream = new System.IO.MemoryStream();
                await file.OpenReadStream(file.Size).CopyToAsync(stream);
            }
            toastService.ShowToast("Save Form after upload Image", AC.SD.Core.Services.ToastLevel.Error);
        }
        else
        {
            if (_DynamicFormDataAttrUploadList == null)
            {
                _DynamicFormDataAttrUploadList = new List<DynamicFormDataAttrUpload>();
            }
            foreach (var file in args.Files)
            {
                var fileName = file.Name.ToLower();
                var exits = _DynamicFormDataAttrUploadList.Where(w => w.FileName.ToLower() == fileName && w.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).FirstOrDefault();
                if (exits == null)
                {
                    using var stream = new System.IO.MemoryStream();
                    await file.OpenReadStream(file.Size).CopyToAsync(stream);
                    byte[] imageArray = stream.ToArray();
                    var imgBase64Str = Convert.ToBase64String(imageArray);
                    DynamicFormDataAttrUpload dynamicFormDataAttrUpload = new DynamicFormDataAttrUpload();
                    dynamicFormDataAttrUpload.DynamicFormSectionAttributeId = dynamicFormSectionAttribute.DynamicFormSectionAttributeId;
                    dynamicFormDataAttrUpload.DynamicFormSectionAttributeSessionId = dynamicFormSectionAttribute.SessionId;
                    dynamicFormDataAttrUpload.SessionId = new Guid(file.Guid);
                    dynamicFormDataAttrUpload.ImageType = file.Type;
                    dynamicFormDataAttrUpload.FileName = file.Name;
                    dynamicFormDataAttrUpload.FileSize = file.Size;
                    dynamicFormDataAttrUpload.DynamicFormDataId = _dynamicformData != null ? _dynamicformData.DynamicFormDataId : null;
                    dynamicFormDataAttrUpload.FileSizes = file.Size > 0 ? FormatSize((long)file.Size) : "";
                    dynamicFormDataAttrUpload.ImageData = imageArray;
                    dynamicFormDataAttrUpload.UploadedUserId = applicationUser.UserID;
                    dynamicFormDataAttrUpload.UploadedUser = applicationUser.UserName;
                    dynamicFormDataAttrUpload.UploadDate = DateTime.Now;
                    //_DynamicFormDataAttrUploadList.Add(dynamicFormDataAttrUpload);
                    List<DynamicFormDataAttrUpload> dynamicFormDataAttrUploads = new List<DynamicFormDataAttrUpload>();
                    dynamicFormDataAttrUploads.Add(dynamicFormDataAttrUpload);
                    var result = await Mediator.Send(new InsertDynamicFormDataAttrUpload(dynamicFormDataAttrUploads));
                    if (result != null)
                    {
                        toastService.ShowToast("File Uploaded Success", AC.SD.Core.Services.ToastLevel.Success);
                    }
                }
                else
                {
                    using var stream = new System.IO.MemoryStream();
                    await file.OpenReadStream(file.Size).CopyToAsync(stream);
                    //byte[] imageArray = stream.ToArray();
                    toastService.ShowToast("This File already exits." + file.Name, AC.SD.Core.Services.ToastLevel.Error);
                }
            }
        }
    }
    void OnCheckedChangedItem(bool? str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        if (dynamicFormSectionAttribute.SubAttributeHeaders.Count > 0)
        {
            List<AttributeHeader> subAttributeHeadersLists = new List<AttributeHeader>();

            Object DatsOld = new Object();
            DatsOld = Data;
            var screenId = _dynamicform.ScreenID.Replace(" ", "_");
            MyClassBuilder MCB = new MyClassBuilder(screenId);
            if (str == true)
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                dynamicFormSectionAttribute.SubAttributeHeaders.ForEach(s =>
                {
                    AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                    addTempSectionAttribute.DataType = s.SubDataType;
                    addTempSectionAttribute.DynamicAttributeName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName;
                    addTempSectionAttributes.Add(addTempSectionAttribute);
                    if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                    {
                        s.SubApplicationMaster.ForEach(ab =>
                        {
                            AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                            var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                            addTempSectionAttributeSub.DataType = s.SubDataType;
                            addTempSectionAttribute.ControlType = s.ControlType;
                            addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                            addTempSectionAttributes.Add(addTempSectionAttributeSub);
                        });
                    }
                });

                addTempSectionAttributes.ForEach(s =>
                {
                    DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                });
                subAttributeHeadersLists = dynamicFormSectionAttribute.SubAttributeHeaders;
            }
            else
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                dynamicFormSectionAttribute.SubAttributeHeaders.ForEach(s =>
                {
                    addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName);
                    if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                    {
                        s.SubApplicationMaster.ForEach(ab =>
                        {
                            var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                            addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == appendAppMaster);
                        });
                    }
                });
                addTempSectionAttributes.ForEach(s =>
                {
                    DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                });
            }
            if (DataClassObjectNameList != null && DataClassObjectNameList.Count() > 0)
            {
                Type[] typesList = DataClassTypeList.ToArray();
                string[] objectNameList = DataClassObjectNameList.ToArray();
                Data = MCB.CreateObject(objectNameList, typesList);
                List<Type> DataGridtypesListss = new List<Type>();
                DataClassObjectNameList.ForEach(d =>
                {
                    DataGridtypesListss.Add(typeof(object));
                });
                DataGridObject = MCB.CreateObject(objectNameList, DataGridtypesListss.ToArray());
                if (DataClassObjectNameList.Count > 0)
                {
                    DataClassObjectNameList.ForEach(s =>
                    {
                        if (DatsOld.GetType().GetProperty(s) != null)
                        {
                            var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
                            Data.GetType().GetProperty(s).SetValue(Data, avluess);
                        }
                    });
                }
            }
            loadSubHeaders(subAttributeHeadersLists, dynamicFormSectionAttribute);
        }
    }
    void loadPlantDroDownList(long? str, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<AttributeDetails> attributeDetails)
    {
        dynamicFormSectionAttribute.SubAttributeDetails = new List<AttributeDetails>();
        List<string?> DataSourceTableIds = new List<string?>();
        if (dynamicFormSectionAttribute.ControlType == "ComboBox" && dynamicFormSectionAttribute.IsPlantLoadDependency == true && dynamicFormSectionAttribute.AttributeHeaderDataSource.Count > 0)
        {
            dynamicFormSectionAttribute.AttributeHeaderDataSource.ForEach(a =>
            {
                if (!string.IsNullOrEmpty(a.DataSourceTable))
                {
                    var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + a.AttributeHeaderDataSourceId + "_" + a.DataSourceTable + "_Dependency";
                    var exitsFilter = _attributeFilterDetailsList.Where(f => f.AttributeName == nameData && f.DataSourceName == a.DataSourceTable).FirstOrDefault();
                    if (exitsFilter != null)
                    {
                        int index = _attributeFilterDetailsList.FindIndex(a => a.AttributeName == nameData);
                        _attributeFilterDetailsList.RemoveAt(index);
                    }
                    DataSourceTableIds.Add(a.DataSourceTable);

                    var addexits = addTempSectionAttributes.FirstOrDefault(f => f.DynamicAttributeName == nameData);
                    if (addexits == null)
                    {
                        AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                        addTempSectionAttribute.DataType = dynamicFormSectionAttribute.IsDependencyMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
                        addTempSectionAttribute.DynamicAttributeName = nameData;
                        addTempSectionAttribute.ControlType = dynamicFormSectionAttribute.IsDependencyMultiple == true ? "TagBox" : "ComboBox";
                        addTempSectionAttributes.Add(addTempSectionAttribute);
                    }
                }
            });

            var listDetailsData = attributeDetails.Where(w => w.AttributeDetailID == str).FirstOrDefault();
            if (listDetailsData != null)
            {
                var plantDepIds = new List<long?>();
                plantDepIds.Add((long?)listDetailsData.AttributeDetailID);
                if (!string.IsNullOrEmpty(listDetailsData.AttributeDetailName) && listDetailsData.AttributeDetailName.ToLower() == "SWGP".ToLower())
                {
                    plantDepIds = new List<long?>();
                    if (attributeDetails != null && attributeDetails.Count() > 0)
                    {
                        plantDepIds = attributeDetails.Where(w => plantNames.Contains(w.AttributeDetailName)).Select(s => (long?)s.AttributeDetailID).ToList();
                    }
                }
                if (PlantDependencySubAttributeDetails != null && DataSourceTableIds.Count > 0)
                {
                    List<AttributeDetails> attributeDepDetails = new List<AttributeDetails>();
                    attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => plantDepIds.Contains(v.CompanyId) && DataSourceTableIds.Contains(v.DropDownTypeId)).ToList());
                    var soCustomerLists = soCustomerType.Intersect(DataSourceTableIds).ToList();
                    if (soCustomerLists.Count > 0)
                    {
                        //attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => soCustomerLists.Contains(v.DropDownTypeId)).ToList());
                    }
                    dynamicFormSectionAttribute.SubAttributeDetails = attributeDepDetails;
                }
            }
        }
    }
    void OnTagBoxChangedItem(IEnumerable<long?> str, PropertyInfo property, List<AttributeDetails> attributeDetails, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        if (dynamicFormSectionAttribute.DataSourceTable == "DynamicGrid")
        {
            var dynamicGridFormIds = dynamicFormSectionAttribute.DynamicGridDynamicFormData.Select(s => s.DynamicFormDataGridFormId).Distinct().ToList();
            if (dynamicGridFormIds.Count() > 0)
            {
                dynamicGridFormIds.ForEach(r =>
                {
                    var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                    if (Data.GetType().GetProperty(nameData) != null)
                    {
                        Data.GetType().GetProperty(nameData).SetValue(Data, null);
                    }

                });
            }
        }
        if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
        {
            List<DynamicFormSectionAttributeSection> dynamicFormSectionAttributeSections = new List<DynamicFormSectionAttributeSection>();
            dynamicFormSectionAttributeSections = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
            if (dynamicFormSectionAttributeSections != null && dynamicFormSectionAttributeSections.Count() > 0)
            {

                dynamicFormSectionAttributeSections.ForEach(r =>
                {
                    dynamicFormSectionAttributeSectionSelected.Remove(r);
                });

            }
        }
        if (str != null && str.Count() > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                str.ToList().ForEach(a =>
                {
                    if (a > 0)
                    {
                        var valuess = "Attr_" + a;
                        if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.DataSourceTable))
                        {
                            valuess = dynamicFormSectionAttribute.DataSourceTable + "_" + a;
                        }
                        var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                        if (valeExits != null && valeExits.Count() > 0)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                });
            }
        }
    }
    void OnRadioChangedItem(long? str, PropertyInfo property, List<AttributeDetails> attributeDetails, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        DynamicFormSectionAttributeSection dynamicFormSectionAttributeSection = new DynamicFormSectionAttributeSection();
        if (str > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var valuess = "Attr_" + str;
                if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.DataSourceTable))
                {
                    valuess = dynamicFormSectionAttribute.DataSourceTable + "_" + str;
                }
                var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                if (valeExits != null)
                {
                    var exits2 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                    if (exits2 != null && exits2.Count() > 0)
                    {
                        if (exits2 != null && exits2.Count() > 0)
                        {
                            exits2.ForEach(c =>
                            {
                                dynamicFormSectionAttributeSectionSelected.Remove(c);
                            });
                        }
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                    else
                    {
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                }
            }
        }
        else
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var exits1 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                if (exits1 != null && exits1.Count() > 0)
                {
                    exits1.ForEach(c =>
                    {
                        dynamicFormSectionAttributeSectionSelected.Remove(c);
                    });
                }
            }
        }
        var screenId = _dynamicform.ScreenID.Replace(" ", "_");
        MyClassBuilder MCB = new MyClassBuilder(screenId);
        if (dynamicFormSectionAttribute.DataSourceTable == "DynamicGrid")
        {
            var dynamicGridFormIds = dynamicFormSectionAttribute.DynamicGridDynamicFormData.Select(s => s.DynamicFormDataGridFormId).Distinct().ToList();
            if (dynamicGridFormIds.Count() > 0)
            {
                dynamicGridFormIds.ForEach(r =>
                {
                    var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                    if (Data.GetType().GetProperty(nameData) != null)
                    {
                        Data.GetType().GetProperty(nameData).SetValue(Data, null);
                    }

                });
            }
            // if (str > 0)
            // {
            //     List<long?> DynamicFormDataIds = new List<long?>();
            //     DynamicFormDataIds.Add(str);
            //     var results = await Mediator.Send(new GetDynamicGridNested(DynamicFormDataIds, applicationUser.UserID));
            //     if (results.DynamicFormData != null && results.DynamicFormData.Count() > 0)
            //     {
            //         var exitsData = DynamicGridDynamicFormData.Where(w => w.DynamicFormDataId == str).Count();
            //         if (exitsData == 0)
            //         {
            //             DynamicGridObjectData = results.ObjectData;
            //             DynamicGridDropDownGridOptionsModel = results.DropDownGridOptionsModel;
            //             DynamicGridDynamicFormData = results.DynamicFormData;
            //         }
            //         DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
            //         var DynamicGridDynamicFormIds = results.DynamicFormData.Where(w => w.DynamicFormDataId > 0 && w.DynamicFormDataId == str).Select(s => s.DynamicFormId).Distinct().ToList();
            //         if (DynamicGridDynamicFormIds.Count() > 0)
            //         {
            //             DynamicGridDynamicFormIds.ForEach(d =>
            //             {
            //                 AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
            //                 var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + d + "_DynamicGrid";
            //                 var exitsAttr = addTempSectionAttributes.FirstOrDefault(w => w.DynamicAttributeName == appendAppMaster);
            //                 if (exitsAttr == null)
            //                 {
            //                     addTempSectionAttributeSub.DataType = dynamicFormSectionAttribute.DataType;
            //                     addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
            //                     addTempSectionAttributes.Add(addTempSectionAttributeSub);
            //                 }
            //             });
            //             addTempSectionAttributes.ForEach(s =>
            //             {
            //                 DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
            //             });
            //             Type[] typesList = DataClassTypeList.ToArray();
            //             string[] objectNameList = DataClassObjectNameList.ToArray();
            //             Object DatsOld = new Object();
            //             DatsOld = Data;
            //             Data = MCB.CreateObject(objectNameList, typesList);

            //             if (DataClassObjectNameList.Count > 0)
            //             {
            //                 DataClassObjectNameList.ForEach(s =>
            //                 {
            //                     if (DatsOld.GetType().GetProperty(s) != null)
            //                     {
            //                         var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
            //                         Data.GetType().GetProperty(s).SetValue(Data, avluess);
            //                     }
            //                 });
            //             }
            //         }
            //     }
            // }
        }
        else
        {
            if (dynamicFormSectionAttribute.ControlType == "ComboBox" && dynamicFormSectionAttribute.IsPlantLoadDependency == true && dynamicFormSectionAttribute.AttributeHeaderDataSource.Count > 0)
            {
                dynamicFormSectionAttribute.AttributeHeaderDataSource.ForEach(a =>
                {
                    if (!string.IsNullOrEmpty(a.DataSourceTable))
                    {
                        var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + a.AttributeHeaderDataSourceId + "_" + a.DataSourceTable + "_Dependency";
                        if (Data.GetType().GetProperty(nameData) != null)
                        {
                            Data.GetType().GetProperty(nameData).SetValue(Data, null);
                        }
                    }
                });
            }

            List<AttributeHeader> subAttributeHeadersLists = new List<AttributeHeader>();
            var listDetails = attributeDetails.Where(w => w.AttributeDetailID == str && w.DropDownTypeId == null).FirstOrDefault();
            var listNotDetails = attributeDetails.Where(w => w.AttributeDetailID != str && w.DropDownTypeId == null).ToList();
            Object DatsOld = new Object();
            DatsOld = Data;

            DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
            loadPlantDroDownList(str, dynamicFormSectionAttribute, attributeDetails);
            if (listDetails != null && listDetails.SubAttributeHeaders != null && listDetails.SubAttributeHeaders.Count > 0)
            {
                subAttributeHeadersLists = listDetails.SubAttributeHeaders;
                listDetails.SubAttributeHeaders.ForEach(s =>
                {
                    AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                    addTempSectionAttribute.DataType = s.SubDataType;
                    addTempSectionAttribute.DynamicAttributeName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName;
                    addTempSectionAttributes.Add(addTempSectionAttribute);
                    if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                    {
                        s.SubApplicationMaster.ForEach(ab =>
                        {
                            AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                            var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                            addTempSectionAttributeSub.DataType = s.SubDataType;
                            addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                            addTempSectionAttribute.ControlType = s.ControlType;
                            addTempSectionAttributes.Add(addTempSectionAttributeSub);
                        });
                    }
                });

                addTempSectionAttributes.ForEach(s =>
                {
                    DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                });
            }
            if (listNotDetails != null && listNotDetails.Count > 0)
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                listNotDetails.ForEach(l =>
                {
                    if (l.SubAttributeHeaders != null && l.SubAttributeHeaders.Count > 0)
                    {
                        l.SubAttributeHeaders.ForEach(v =>
                        {
                            addTempSectionAttributes.RemoveAll(p => p.DynamicAttributeName == dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + v.SubDynamicAttributeName);
                            if (v.SubApplicationMaster != null && v.SubApplicationMaster.Count > 0)
                            {
                                v.SubApplicationMaster.ForEach(ab =>
                                {
                                    var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + v.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                    addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == appendAppMaster);
                                });
                            }
                        });
                    }
                });
                addTempSectionAttributes.ForEach(s =>
                 {
                     DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                 });
            }
            else
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                addTempSectionAttributes.ForEach(s =>
                 {
                     DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                 });
            }
            if (DataClassObjectNameList != null && DataClassObjectNameList.Count() > 0)
            {
                Type[] typesList = DataClassTypeList.ToArray();
                string[] objectNameList = DataClassObjectNameList.ToArray();
                Data = MCB.CreateObject(objectNameList, typesList);
                List<Type> DataGridtypesListss = new List<Type>();
                DataClassObjectNameList.ForEach(d =>
                {
                    DataGridtypesListss.Add(typeof(object));
                });
                DataGridObject = MCB.CreateObject(objectNameList, DataGridtypesListss.ToArray());
                if (DataClassObjectNameList.Count > 0)
                {
                    DataClassObjectNameList.ForEach(s =>
                    {
                        if (DatsOld.GetType().GetProperty(s) != null)
                        {
                            var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
                            Data.GetType().GetProperty(s).SetValue(Data, avluess);
                        }
                    });
                }
            }
            // Type[] typesList = DataClassTypeList.ToArray();
            // string[] objectNameList = DataClassObjectNameList.ToArray();
            // Data = MCB.CreateObject(objectNameList, typesList);
            // if (DataClassObjectNameList.Count > 0)
            // {
            //     DataClassObjectNameList.ForEach(s =>
            //     {
            //         if (DatsOld.GetType().GetProperty(s) != null)
            //         {
            //             var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
            //             Data.GetType().GetProperty(s).SetValue(Data, avluess);
            //         }
            //     });
            // }
            loadSubHeaders(subAttributeHeadersLists, dynamicFormSectionAttribute);
        }

    }
    string? QueryDisplayComboBoxText(DropDownBoxQueryDisplayTextContext arg)
    {
        string? returnData = string.Empty;
        if (arg.Value is AttributeDetails value)
        {
            if (value != null)
            {
                returnData = value?.AttributeDetailName;
            }
        }
        return returnData.TrimEnd(',');
    }
    string? QueryDisplayDynamicComboBoxText(DropDownBoxQueryDisplayTextContext arg)
    {
        string? returnData = string.Empty;
        if (arg.Value is ExpandoObject value)
        {
            if (value != null)
            {
                dynamic eod = value;
                returnData = (string)eod.DisplayItemsQuery;
            }
        }
        return returnData.TrimEnd(',');
    }
    string? QueryMultipleText(DropDownBoxQueryDisplayTextContext arg)
    {
        List<long?> ids = new List<long?>();
        string? returnData = string.Empty;
        if (arg.Value != null)
        {
            List<AttributeDetails> collection = (List<AttributeDetails>)arg.Value;

            if (collection != null && collection.Count() > 0)
            {
                foreach (var item in collection)
                {
                    returnData += item?.AttributeDetailName + ",";
                }

            }
        }

        return returnData.TrimEnd(',');
    }
    string? QueryMultipleDynamicFormText(DropDownBoxQueryDisplayTextContext arg)
    {
        List<long?> ids = new List<long?>();
        string? returnData = string.Empty;
        if (arg.Value != null)
        {
            List<ExpandoObject> collection = (List<ExpandoObject>)arg.Value;

            if (collection != null && collection.Count() > 0)
            {
                foreach (var item in collection)
                {
                    dynamic eod = item;
                    returnData += (string)eod.DisplayItemsQuery + ",";
                }

            }
        }

        return returnData.TrimEnd(',');
    }
    void OnMultipleValueChanged(object? newValue, string AttrName, string DataSource, object Data, object DataGridObject, PropertyInfo property, List<AttributeDetails> attributeDetails, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        List<long?> ids = new List<long?>();
        Data.GetType().GetProperty(AttrName).SetValue(Data, null);
        if (DataSource == "DynamicGrid")
        {
            List<ExpandoObject> collection = (List<ExpandoObject>)newValue;

            if (collection != null && collection.Count() > 0)
            {
                DataGridObject.GetType().GetProperty(AttrName).SetValue(DataGridObject, newValue);
                foreach (var item in collection)
                {
                    dynamic eod = item;
                    ids.Add((long)eod.AttributeDetailID);
                }

            }
        }
        else
        {
            if (newValue != null)
            {
                List<AttributeDetails> collection = (List<AttributeDetails>)newValue;
                if (collection != null && collection.Count() > 0)
                {
                    DataGridObject.GetType().GetProperty(AttrName).SetValue(DataGridObject, newValue);
                    foreach (var item in collection)
                    {
                        ids.Add(item.AttributeDetailID);
                    }
                }
            }
        }
        Data.GetType().GetProperty(AttrName).SetValue(Data, ids);
        if (dynamicFormSectionAttribute.DataSourceTable == "ApplicationMaster")
        {
            OnRadioAppMasterMultipleChangedItem(ids, property, dynamicFormSectionAttribute);
        }
        else
        {
            OnTagBoxChangedItem(ids, property, attributeDetails, dynamicFormSection, dynamicFormSectionAttribute);
        }
    }
    void OnGridValueChanged(object? newValue, string AttrName, string? DataSource, object Data, object DataGridObject, PropertyInfo property, List<AttributeDetails> attributeDetails, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        long? Id = null;
        if (DataSource == "DynamicGrid")
        {
            if (newValue is ExpandoObject value)
            {
                if (value != null)
                {
                    dynamic eod = value;
                    Id = (long?)eod.AttributeDetailID;
                }
            }
        }
        else
        {
            if (newValue is AttributeDetails value)
            {
                if (value != null)
                {
                    Id = value?.AttributeDetailID;
                }
            }
        }
        Data.GetType().GetProperty(AttrName).SetValue(Data, Id);
        DataGridObject.GetType().GetProperty(AttrName).SetValue(DataGridObject, newValue);
        if (dynamicFormSectionAttribute.DataSourceTable == "ApplicationMaster")
        {
            OnRadioAppMasterChangedItem(Id, property, dynamicFormSectionAttribute);
        }
        else
        {
            OnRadioChangedItem(Id, property, attributeDetails, dynamicFormSection, dynamicFormSectionAttribute);
        }

    }
    void CloseQrCodePopup()
    {
        QrCodePopupVisible = false;
        _QrCodeReader?.StopDecoding();
        StateHasChanged();
    }
    void OnButtonQrCodeClick(Microsoft.AspNetCore.Components.Web.MouseEventArgs str, PropertyInfo propertyInfo)
    {
        PropertyQrCodeInfo = propertyInfo;
        QrCodePopupVisible = true;
        StateHasChanged();
    }
    void TicketNoReceivedBarcodeText(BarcodeReceivedEventArgs args)
    {
        if (PropertyQrCodeInfo != null)
        {
            PropertyQrCodeInfo.SetValue(Data, args.BarcodeText);
            StateHasChanged();
            toastService.ShowToast("QrCode Scanned Successfully", AC.SD.Core.Services.ToastLevel.Success);
            PropertyQrCodeInfo = null;
            CloseQrCodePopup();
            StateHasChanged();
        }
    }
    private string ExpressionEvaluatorColorCode(DynamicFormSectionAttrFormulaFunction dynamicFormSectionAttrFormulaFunction, DynamicFormSectionAttribute DynamicFormSectionAttribute)
    {
        string? colorsData = null;
        if (Data.GetType().GetProperty(DynamicFormSectionAttribute.DynamicAttributeName) != null)
        {
            try
            {
                var itemValue = Data.GetType().GetProperty(DynamicFormSectionAttribute.DynamicAttributeName).GetValue(Data);
                string? values = string.Empty;
                if (!string.IsNullOrEmpty(DynamicFormSectionAttribute.ControlType))
                {
                    if (DynamicFormSectionAttribute.ControlType.ToLower() == "TextBox".ToLower())
                    {
                        values = itemValue == null ? null : (string)itemValue;
                    }
                    else
                    {
                        if (DynamicFormSectionAttribute.ControlType.ToLower() == "SpinEdit".ToLower())
                        {
                            if (DynamicFormSectionAttribute.IsSpinEditType == "decimal")
                            {
                                values = itemValue == null ? null : ((decimal?)itemValue)?.ToString();
                            }
                            if (DynamicFormSectionAttribute.IsSpinEditType == "int")
                            {
                                values = itemValue == null ? null : ((int?)itemValue)?.ToString();
                            }
                        }
                    }
                }
                if (values != null && dynamicFormSectionAttrFormulaFunction.AValue != null)
                {
                    ExpressionEvaluator evaluator = new ExpressionEvaluator();
                    string ab = dynamicFormSectionAttrFormulaFunction.FormulaFunctionName;
                    ab = ab.Replace("x", values);
                    string aValue = "" + dynamicFormSectionAttrFormulaFunction.AValue;
                    ab = ab.Replace("a", aValue);
                    if (dynamicFormSectionAttrFormulaFunction.IsBValueEnabled == true)
                    {
                        string bValue = "" + dynamicFormSectionAttrFormulaFunction.BValue;
                        ab = ab.Replace("b", bValue);
                    }
                    ab += "{ return ";
                    ab += "\"" + dynamicFormSectionAttrFormulaFunction.ColorValue + "\";";
                    ab += "}";
                    colorsData = (string?)evaluator.ScriptEvaluate(ab);
                }
            }
            catch (Exception ex)
            {

            }
        }
        return colorsData;
    }
    public RenderFragment CreateEditFormFields() => formLayoutBuilder =>
    {
        InvokeAsync(onshowLoading);
        isRequiredCount = 0;
        var _AttributeHeaders = _AttributeHeader;
        if (Data != null)
        {
            var propertyList = Data.GetType().GetProperties(); int i = 0; int k = 0; int sec = 0;
            if (_AttributeHeader != null && _AttributeHeader.DynamicFormSection != null && _AttributeHeader.DynamicFormSectionAttribute.Count > 0)
            {

                _AttributeHeader.DynamicFormSection.ForEach(a =>
    {
        //PanelVisible = true;
        var isReadonly = false;
        var isVisible = true; var isUploadReadonly = false;
        var isUploadVisible = false;
        if (isVisible == true)
        {
            formLayoutBuilder.OpenComponent<DxFormLayout>(i);

            formLayoutBuilder.AddAttribute(i + 1, "ChildContent", (RenderFragment)((layoutItemBuilder) =>
    {
        var isWorkSection = _dynamicFormWorkFlowSectionNoWorkFlow.Where(m => m.DynamicFormSectionId == a.DynamicFormSectionId).FirstOrDefault();
        layoutItemBuilder.OpenComponent<DxFormLayoutGroup>(i + 1);
        layoutItemBuilder.AddAttribute(i + 1, "ExpandButtonDisplayMode", GroupExpandButtonDisplayMode.Start);
        layoutItemBuilder.AddAttribute(i + 1, "Expanded", true);
        layoutItemBuilder.AddAttribute(i + 1, "AnimationType", LayoutAnimationType.Slide);
        layoutItemBuilder.AddAttribute(i + 1, "CssClass", "FormLayoutGroupCss");

        layoutItemBuilder.AddAttribute(i + 1, "HeaderContentTemplate", (RenderFragment<IFormLayoutGroupInfo>)((context) => (b) =>
    {
        b.OpenElement(i + 1, "div");
        if (isWorkSection != null)
        {
            if (isWorkSection.IsAnomalyStatus == true)
            {
                b.AddAttribute(i + 1, "style", "color:red;");
            }
            else
            {
                // if (isWorkSection.IsParallelWorkflow == true)
                // {
                //     b.AddAttribute(i + 1, "style", "color:red;");
                // }
                if (isWorkSection.UserId == applicationUser.UserID)
                {
                    b.AddAttribute(i + 1, "style", "color:red;");
                }
                if (isWorkSection.IsMultipleUser == true && isWorkSection.DynamicFormWorkFlowMultipleUsers.Count() > 0)
                {
                    var exits = isWorkSection.DynamicFormWorkFlowMultipleUsers.Where(w => w.UserId == applicationUser.UserID).Count();
                    if (exits > 0)
                    {
                        b.AddAttribute(i + 1, "style", "color:red;");
                    }
                }
            }
        }
        b.AddContent(i + 1, (a.SortOrderBy + ". " + a.SectionName));

        b.CloseElement();
        b.OpenElement(i + 1, "div");
        b.AddAttribute(i + 1, "style", "margin-left:auto;");
        if (isPrint == false)
        {
            if (isUploadReadonly == true)
            {
                if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0)
                {
                    // b.OpenElement(i + 1, "i");
                    // b.AddAttribute(i + 1, "class", "fa fa-paperclip");
                    // b.AddAttribute(i + 1, "style", "cursor: pointer;margin-right:10px;");
                    // b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionUploadInfoClick()));
                    // b.AddAttribute(i + 1, "aria-hidden", true);
                    // b.CloseElement();

                }
            }
            if (!string.IsNullOrEmpty(a.Instruction))
            {
                b.OpenElement(i + 1, "i");
                b.AddAttribute(i + 1, "class", "fa fa-info-circle");
                b.AddAttribute(i + 1, "style", "cursor: pointer;");
                b.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-SectionInfo-{randomNum}-{a.DynamicFormSectionId}"));
                // b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionInfoClick(a)));
                b.AddAttribute(i + 1, "title", "Click Here Show Instruction");
                b.AddAttribute(i + 1, "aria-hidden", true);
                b.CloseElement();
            }
            if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0)
            {
                var securityRelease = _dynamicformData?.DynamicFormDataSectionSecurityRelease.FirstOrDefault(dc => dc.DynamicFormSectionId == a.DynamicFormSectionId);

                bool IsRelease = a.IsReleaseCount > 0 ? a.IsReleaseUsers > 0 : true;
                if (IsRelease)
                {
                    if (securityRelease == null || securityRelease?.IsRelease == false)
                    {
                        b.OpenElement(i + 1, "i");
                        b.AddAttribute(i + 1, "title", "Click to release");
                        //b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormDataSectionSecurityReleaseClick(a, true)));
                        b.AddAttribute(i + 1, "style", "cursor: pointer;margin-right:10px;");
                        b.AddAttribute(i + 1, "class", "fa fa-refresh");
                        b.AddAttribute(i + 1, "aria-hidden", true);
                        b.CloseElement();
                    }
                    else
                    {
                        b.OpenElement(i + 1, "i");
                        b.AddAttribute(i + 1, "title",  $"Release By: {securityRelease?.ReleaseUser}\nDate: {securityRelease?.ModifiedDate?.ToString("dd-MMM-yyyy hh:mm:ss tt")}");
                        b.AddAttribute(i + 1, "style", "cursor: pointer;margin-right:10px;");
                        b.AddAttribute(i + 1, "class", "fa fa-check-square");
                        // b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormDataSectionSecurityReleaseClick(a, false)));
                        b.AddAttribute(i + 1, "aria-hidden", true);
                        b.CloseElement();
                    }
                }
                else
                {
                    if (securityRelease != null && securityRelease?.IsRelease == true)
                    {
                        b.OpenElement(i + 1, "i");
                        b.AddAttribute(i + 1, "title", $"Release By: {securityRelease?.ReleaseUser}\nDate: {securityRelease?.ModifiedDate?.ToString("dd-MMM-yyyy hh:mm:ss tt")}");
                        b.AddAttribute(i + 1, "style", "cursor: pointer;margin-right:10px;");
                        b.AddAttribute(i + 1, "class", "fa fa-check-square");
                        b.AddAttribute(i + 1, "aria-hidden", true);
                        b.CloseElement();
                    }
                }
                if (_dynamicformData.IsLocked != true)
                {
                    var sectionLock = _dynamicformData?.DynamicFormDataSectionLock.FirstOrDefault(dc => dc.DynamicFormSectionId == a.DynamicFormSectionId);
                    b.OpenElement(i + 1, "i");
                    if (sectionLock != null)
                    {
                        if (sectionLock.LockedUserId != applicationUser.UserID)
                        {
                            isReadonly = sectionLock.IsLocked == true ? true : isReadonly;
                            isReadonly = isReadonly == true ? false : isReadonly;
                        }
                        else
                        {
                            // b.AddAttribute(i + 1, "style", "cursor: pointer;");
                            // b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionLockClick(a)));
                        }
                        a.DynamicFormDataSectionLock = sectionLock;
                        b.AddAttribute(i + 1, "class", sectionLock.IsLocked == true ? "fa fa-lock" : "fa fa-unlock");
                    }
                    else
                    {
                        //  b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionLockClick(a)));
                        // b.AddAttribute(i + 1, "style", "cursor: pointer;");
                        //  b.AddAttribute(i + 1, "class", "fa fa-unlock");
                    }
                    if (sectionLock != null && sectionLock.IsLocked == true && !string.IsNullOrEmpty(sectionLock?.LockedUser))
                    {
                        b.AddAttribute(i + 1, "title", "Locked By:" + sectionLock?.LockedUser);
                    }
                    b.AddAttribute(i + 1, "aria-hidden", true);
                    b.CloseElement();
                }
            }
        }
        b.CloseElement();
    }));
        layoutItemBuilder.AddAttribute(i + 1, "Items", (RenderFragment)((itemBuilder) =>
    {
        var dynamicFormSectionAttributeData = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.DynamicFormSectionId == a.DynamicFormSectionId).OrderBy(o => o.SortOrderBy).ToList();

        if (dynamicFormSectionAttributeData != null && dynamicFormSectionAttributeData.Count > 0)
        {
            int dNo = 1;
            dynamicFormSectionAttributeData.ForEach(s =>
        {
            s.DummyNo = dNo;
            dNo++;
        });
            var dynamicFormSectionAttributeDataOne = new DynamicFormSectionAttribute();
            dynamicFormSectionAttributeData.ForEach(s =>
        {
            bool? isAccessOnly = true; bool? isViewFormatOnly = true;
            if (s.DynamicFormSectionAttributeSecurity.Count > 0)
            {
                isAccessOnly = false; isViewFormatOnly = false;
                var exitsAccess = s.DynamicFormSectionAttributeSecurity.FirstOrDefault(f => f.UserId == applicationUser.UserID && f.IsAccess == true);
                if (exitsAccess != null)
                {
                    isAccessOnly = true;
                }
                var IsViewFormatAll = s.DynamicFormSectionAttributeSecurity.Where(f => f.IsViewFormatOnly == true).Count();
                if (IsViewFormatAll > 0)
                {
                    var exitsIsViewFormat = s.DynamicFormSectionAttributeSecurity.FirstOrDefault(f => f.UserId == applicationUser.UserID && f.IsViewFormatOnly == true);
                    if (exitsIsViewFormat != null)
                    {
                        isViewFormatOnly = true;
                    }
                    else
                    {
                        isViewFormatOnly = false;
                        isAccessOnly = false;
                    }
                }
                else
                {
                    isViewFormatOnly = true;
                }
            }
            dynamicFormSectionAttributeDataOne = s;
            var property = Data.GetType().GetProperty(s.DynamicAttributeName);
            if (property != null)
            {
                var valueData = property.GetValue(Data);
                var propertyType = Nullable.GetUnderlyingType(property.PropertyType) ?? property.PropertyType;
                var dataLists = new List<AttributeDetails>();
                if (!string.IsNullOrEmpty(s.DropDownTypeId))
                {
                    if (s.DropDownTypeId == "Data Source")
                    {
                        var exitsFilter = _attributeFilterDetailsList.Where(f => f.AttributeName == s.DynamicAttributeName).FirstOrDefault();
                        if (exitsFilter == null)
                        {
                            dataLists = _AttributeHeader.AttributeDetails.Where(x => x.DropDownTypeId == s.DataSourceTable && x.ApplicationMasterId == s.ApplicationMasterId).ToList();
                        }
                        else
                        {
                            dataLists = exitsFilter.AttributeDetails.ToList();
                        }
                    }
                }
                else
                {
                    dataLists = _AttributeHeader.AttributeDetails.Where(x => x.AttributeID == s.AttributeId).ToList();
                }
                List<AttributeDetails> attributeDetailss = dataLists;
                if (s.DataSourceTable != "ApplicationMaster" && s.DataSourceTable != "ApplicationMasterParent")
                {
                    itemBuilder.OpenComponent<DxFormLayoutItem>(1);
                    if (s.ControlType != "Dynamic Grid Form")
                    {
                        //itemBuilder.AddAttribute(i++, "Caption", s.DisplayName);
                    }

                    itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : s.ColSpan);

                    var access = Expression.Property(Expression.Constant(Data), s.DynamicAttributeName);
                    var lambda = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), access);

                    // var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), s.DynamicAttributeName);
                    // var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                    // var Gridproperty = DataGridObject.GetType().GetProperty(s.DynamicAttributeName);
                    // var GridvalueData = Gridproperty.GetValue(DataGridObject);
                    // var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == s.DynamicAttributeName);
                    itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context) => ((editor) =>
                 {
                     //  if (s.ControlType != "Dynamic Grid Form")
                     // {
                     editor.OpenElement(i + 1, "div");
                     editor.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                     editor.AddContent(i + 1, (a.IsAutoNumberEnabled == true ? (s.DummyNo + ". ") : "") + s.DisplayName);
                     if (isPrint == false)
                     {
                         if (s.IsRequired == true)
                         {
                             editor.OpenElement(i + 1, "span");
                             editor.AddAttribute(i + 1, "style", "color: red;");
                             editor.AddContent(i + 1, "(*)");
                             editor.CloseElement();
                         }
                         if (!string.IsNullOrEmpty(s.FormToolTips))
                         {
                             editor.OpenElement(i + 1, "i");
                             editor.AddAttribute(i + 1, "class", "fa fa-info");
                             editor.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                             editor.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{s.DynamicAttributeName}"));
                             editor.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(s.DynamicAttributeName, s.FormToolTips)));
                             editor.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                             editor.AddAttribute(i + 1, "aria-hidden", true);
                             editor.CloseElement();
                         }
                         if (s.ControlType == "Upload Image")
                         {
                             editor.OpenElement(i + 1, "i");
                             editor.AddAttribute(i + 1, "class", "fa fa-image");
                             editor.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                             editor.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-ImageUpload-{s.DynamicFormSectionAttributeId}"));
                             editor.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnShowImageUploadClick(s)));
                             editor.AddAttribute(i + 1, "title", "Click Here Show Uploaded Images");
                             editor.AddAttribute(i + 1, "aria-hidden", true);
                             editor.CloseElement();
                         }
                         if (s.DropDownTypeId == "Data Source")
                         {
                             if (s.IsPlantLoadDependency == true && s.AttributeHeaderDataSource.Count() > 0)
                             {

                             }
                             else
                             {
                                 var FilterExits = _AttributeHeader.AttributeHeaderDataSource.Where(o => o.DataSourceTable == s.DataSourceTable).FirstOrDefault()?.IsDynamicFormFilterBy;
                                 if (FilterExits != null && FilterExits > 0)
                                 {
                                     editor.OpenElement(i + 1, "i");
                                     editor.AddAttribute(i + 1, "class", "fa fa-filter");
                                     editor.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                                     editor.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormFilterBypopup(s.DynamicAttributeName, a, s, s.DataSourceTable)));
                                     editor.AddAttribute(i + 1, "title", "Click Here Filter");
                                     editor.AddAttribute(i + 1, "aria-hidden", true);
                                     editor.CloseElement();
                                 }
                             }
                         }
                     }
                     editor.CloseElement();
                     // }
                     var j = 0;
                     if (s.ControlType == "Dynamic Grid Form")
                     {
                         if (IsPrintWithoutGridForm == false)
                         {
                             editor.OpenComponent<AC.SD.Core.Pages.Attribute.DynamicFormGridLists>(j + 1);
                             editor.AddAttribute(j + 1, "SessionId", s.DynamicFormSessionId);
                             editor.AddAttribute(j + 1, "DynamicFormSectionGridAttributeId", s.DynamicFormSectionAttributeId);
                             editor.AddAttribute(j + 1, "isMainLocked", isLocked);
                             if (isAccessOnly == true)
                             {
                                 editor.AddAttribute(j + 1, "IsReadonly", isReadonly);
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "IsReadonly", isAccessOnly);
                             }
                             editor.AddAttribute(j + 1, "MainSessionId", dynamicFormData?.SessionId);
                             editor.AddAttribute(j + 1, "DynamicFormDataGridId", dynamicFormData?.DynamicFormDataId);
                             editor.CloseComponent();
                         }
                     }
                     else if (s.ControlType == "Upload Image")
                     {
                         editor.OpenComponent<DxFileInput>(j + 1);
                         editor.AddAttribute(j + 1, "UploadMode", UploadMode.Instant);
                         editor.AddAttribute(j + 1, "AllowMultiFileUpload", true);
                         editor.AddAttribute(j + 1, "ShowFileList", false);
                         //editor.AddAttribute(j + 1, "Visible", _dynamicformData != null ? true : false);
                         editor.AddAttribute(j + 1, "AllowCancel", false);
                         editor.AddAttribute(j + 1, "AcceptedFileTypes", new List<string> { "image/*", "video/*" });
                         editor.AddAttribute(j + 1, "FilesUploading", EventCallback.Factory.Create<FilesUploadingEventArgs>(this, str => OnFilesUploading(str, s)));
                         editor.CloseComponent();
                     }
                     else if (s.ControlType == "QR Code")
                     {
                         editor.OpenComponent<DxTextBox>(j + 1);
                         if (isViewFormatOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Text", valueData);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Text", "******");
                         }

                         editor.AddAttribute(j + 1, "TextExpression", lambda);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }

                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                         editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { property.SetValue(Data, str); }));
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((dx) =>
                             {
                                 dx.OpenComponent<DxEditorButton>(j + 1);
                                 dx.AddAttribute(j + 1, "IconCssClass", "fa fa-qrcode");
                                 dx.AddAttribute(j + 1, "Tooltip", "Scan Qr Code");
                                 dx.AddAttribute(j + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnButtonQrCodeClick(str, property)));
                                 dx.CloseComponent();
                             }));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData))
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData) && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                     else if (s.ControlType == "TextBox")
                     {
                         editor.OpenComponent<DxTextBox>(j + 1);
                         if (isViewFormatOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Text", valueData);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Text", "******");
                         }

                         editor.AddAttribute(j + 1, "TextExpression", lambda);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }

                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                         //editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, (str) => OnTextChangedItem(str, property, a, s)));

                         var colorCodeExits = _AttributeHeader.DynamicFormSectionAttrFormulaFunctions.Where(w => w.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).FirstOrDefault();
                         if (!string.IsNullOrEmpty(s.FormulaTextBox) || colorCodeExits != null)
                         {
                             editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((dx) =>
                     {
                         if (colorCodeExits != null)
                         {
                             dx.OpenComponent<DxEditorButton>(j + 1);
                             dx.AddAttribute(j + 1, "IconCssClass", "fa fa-eye");
                             dx.AddAttribute(j + 1, "Tooltip", "Type:" + colorCodeExits.Type);
                             dx.AddAttribute(j + 1, "id", $"flyout-overview-target-container-SectionAttrFormula-{colorCodeExits.DynamicFormSectionAttributeId}");
                             dx.AddAttribute(j + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnSpinTextChangedItem(str, property, a, s, colorCodeExits)));
                             dx.CloseComponent();
                         }
                         if (!string.IsNullOrEmpty(s.FormulaTextBox))
                         {
                             dx.OpenComponent<DxEditorButton>(j + 1);
                             dx.AddAttribute(j + 1, "IconCssClass", "fa fa-calculator");
                             dx.AddAttribute(j + 1, "Tooltip", "Formula:" + s.FormulaTextBox);
                             dx.AddAttribute(j + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnTextChangedItem(str, property, a, s)));
                             dx.CloseComponent();
                         }

                     }));
                         }
                         if (colorCodeExits != null)
                         {
                             var colorExitsCode = ExpressionEvaluatorColorCode(colorCodeExits, s);
                             if (!string.IsNullOrEmpty(colorExitsCode))
                             {
                                 editor.AddAttribute(j + 1, "style", "color:" + colorExitsCode + ";");
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "style", "color:black;");
                             }
                         }

                         editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { property.SetValue(Data, str); }));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData))
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData) && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }

                     else if (s.ControlType == "DateEdit")
                     {
                         if (valueData == null && s.IsSetDefaultValue == true)
                         {
                             valueData = DateTime.Now;
                             property.SetValue(Data, valueData);
                         }
                         editor.OpenComponent<DxDateEdit<DateTime?>>(j + 1);
                         editor.AddAttribute(j + 1, "Date", valueData);
                         editor.AddAttribute(j + 1, "DateExpression", lambda);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                         editor.AddAttribute(j + 1, "DateChanged", EventCallback.Factory.Create<System.DateTime?>(this, str => { property.SetValue(Data, str); }));
                         if (s.IsDefaultReadOnly == false)
                         {
                             if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                             {
                                 if (valueData == null)
                                 {
                                     isRequiredCount += 1;
                                     if (isSubmit == true)
                                     {
                                         //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                     }
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsDefaultReadOnly == false)
                         {
                             if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                             {
                                 if (valueData == null && isSubmit == true)
                                 {
                                     editor.OpenElement(j + 1, "span");
                                     editor.AddAttribute(j + 1, "class", "text-danger");
                                     editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                     editor.CloseElement();
                                 }
                             }
                         }
                     }
                     else if (s.ControlType == "TimeEdit")
                     {
                         if (valueData == null && s.IsSetDefaultValue == true)
                         {
                             valueData = DateTime.Now.TimeOfDay;
                             property.SetValue(Data, valueData);
                         }
                         editor.OpenComponent<DxTimeEdit<TimeSpan?>>(j + 1);
                         editor.AddAttribute(j + 1, "Time", valueData);
                         editor.AddAttribute(j + 1, "TimeExpression", lambda);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                         editor.AddAttribute(j + 1, "TimeChanged", EventCallback.Factory.Create<System.TimeSpan?>(this, str => { property.SetValue(Data, str); }));
                         if (s.IsDefaultReadOnly == false)
                         {
                             if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                             {
                                 if (valueData == null)
                                 {
                                     isRequiredCount += 1;
                                     if (isSubmit == true)
                                     {
                                         //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                     }
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsDefaultReadOnly == false)
                         {
                             if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                             {
                                 if (valueData == null && isSubmit == true)
                                 {
                                     editor.OpenElement(j + 1, "span");
                                     editor.AddAttribute(j + 1, "class", "text-danger");
                                     editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                     editor.CloseElement();
                                 }
                             }
                         }
                     }
                     else if (s.ControlType == "Memo")
                     {
                         editor.OpenComponent<DxMemo>(j);
                         if (isViewFormatOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Text", valueData);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Text", "******");
                         }
                         editor.AddAttribute(j + 1, "TextExpression", lambda);
                         editor.AddAttribute(j + 1, "Rows", 5);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                         editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { property.SetValue(Data, str); }));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData))
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (string.IsNullOrEmpty((string)valueData) && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                     else if (s.ControlType == "SpinEdit")
                     {
                         if (isViewFormatOnly == true)
                         {
                             if (propertyType.Name == "Int32")
                             {
                                 editor.OpenComponent<DxSpinEdit<int?>>(j + 1);
                                 editor.AddAttribute(j + 1, "Value", valueData);
                                 // editor.AddAttribute(j + 1, "MinValue", 0);
                                 if (isAccessOnly == true)
                                 {
                                     editor.AddAttribute(j + 1, "Enabled", isReadonly);
                                 }
                                 else
                                 {
                                     editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                                 }
                                 editor.AddAttribute(j + 1, "BindValueMode", BindValueMode.OnInput);
                                 editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<int?>(this, str => OnSpinEditChangedItem1(str, property, a, s)));
                             }
                             if (propertyType.Name == "Decimal")
                             {
                                 editor.OpenComponent<DxSpinEdit<decimal?>>(j + 1);
                                 editor.AddAttribute(j + 1, "Value", valueData);
                                 editor.AddAttribute(j + 1, "Increment", 0.1M);
                                 if (isAccessOnly == true)
                                 {
                                     editor.AddAttribute(j + 1, "Enabled", isReadonly);
                                 }
                                 else
                                 {
                                     editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                                 }
                                 //editor.AddAttribute(j + 1, "MinValue", 0M);

                                 editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<decimal?>(this, str => OnSpinEditChangedItem(str, property, a, s)));
                             }
                             var colorCodeExits = _AttributeHeader.DynamicFormSectionAttrFormulaFunctions.Where(w => w.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).FirstOrDefault();
                             if (!string.IsNullOrEmpty(s.FormulaTextBox) || colorCodeExits != null)
                             {
                                 editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((dx) =>
                             {
                                 if (colorCodeExits != null)
                                 {
                                     dx.OpenComponent<DxEditorButton>(j + 1);
                                     dx.AddAttribute(j + 1, "IconCssClass", "fa fa-eye");
                                     dx.AddAttribute(j + 1, "Tooltip", "Type:" + colorCodeExits.Type);
                                     dx.AddAttribute(j + 1, "id", $"flyout-overview-target-container-SectionAttrFormula-{colorCodeExits.DynamicFormSectionAttributeId}");
                                     dx.AddAttribute(j + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnSpinTextChangedItem(str, property, a, s, colorCodeExits)));
                                     dx.CloseComponent();
                                 }
                                 if (!string.IsNullOrEmpty(s.FormulaTextBox))
                                 {
                                     dx.OpenComponent<DxEditorButton>(j + 1);
                                     dx.AddAttribute(j + 1, "IconCssClass", "fa fa-calculator");
                                     dx.AddAttribute(j + 1, "Tooltip", "Formula:" + s.FormulaTextBox);
                                     dx.AddAttribute(j + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnTextChangedItem(str, property, a, s)));
                                     dx.CloseComponent();
                                 }

                             }));
                             }
                             if (colorCodeExits != null)
                             {
                                 var colorExitsCode = ExpressionEvaluatorColorCode(colorCodeExits, s);
                                 if (!string.IsNullOrEmpty(colorExitsCode))
                                 {
                                     editor.AddAttribute(j + 1, "style", "color:" + colorExitsCode + ";");
                                 }
                                 else
                                 {
                                     editor.AddAttribute(j + 1, "style", "color:black;");
                                 }
                             }

                             editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                             editor.AddAttribute(j + 1, "ValueExpression", lambda);
                         }
                         else
                         {
                             var accessSpin = Expression.Property(Expression.Constant(SpinData), s.DynamicAttributeName);
                             var lambdaSpin = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(string)), accessSpin);
                             editor.OpenComponent<DxTextBox>(j + 1);
                             editor.AddAttribute(j + 1, "Text", "******");
                             editor.AddAttribute(j + 1, "Enabled", false);
                             editor.AddAttribute(j + 1, "TextExpression", lambdaSpin);
                         }

                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }

                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                     else if (s.ControlType == "GroupCheckBox")
                     {
                         var attrGroupCheckBox = _AttributeHeader.AttributeGroupCheckBoxes.Where(w => w.AttributeId == s.AttributeId).ToList();
                         if (attrGroupCheckBox.Count() > 0)
                         {
                             loadGroupCheckBox(s, attrGroupCheckBox, editor, j, a, isReadonly, isAccessOnly);
                         }

                     }
                     else if (s.ControlType == "CheckBox")
                     {
                         editor.OpenComponent<DxCheckBox<bool?>>(j + 1);
                         editor.AddAttribute(j + 1, "Checked", valueData ?? false);
                         editor.AddAttribute(j + 1, "CheckedExpression", lambda);
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, (str) => OnCheckedChangedItem(str, property, a, s)));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null || (bool)valueData == false)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null || (bool)valueData == false && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }

                     }
                     else if (s.ControlType == "RadioGroup")
                     {
                         editor.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(j + 1);
                         editor.AddAttribute(j + 1, "Items", attributeDetailss);
                         editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                         editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                         editor.AddAttribute(j + 1, "Value", valueData);
                         editor.AddAttribute(j + 1, "style", "margin-left:25px;");
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ValueExpression", lambda);
                         editor.AddAttribute(j + 1, "Layout", s.RadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                         editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                     else if (s.ControlType == "Radio")
                     {
                         editor.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(j + 1);
                         editor.AddAttribute(j + 1, "Items", attributeDetailss);
                         editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                         editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                         editor.AddAttribute(j + 1, "Value", valueData);
                         editor.AddAttribute(j + 1, "style", "margin-left:25px;");
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ValueExpression", lambda);
                         editor.AddAttribute(j + 1, "Layout", s.RadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                         editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "color:red;");
                                 }
                             }
                         }
                         editor.CloseComponent();
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                     else if (s.ControlType == "ComboBox")
                     {
                         if (s.DataSourceTable == "DynamicGrid")
                         {
                             string DataDynamicAttributeName = s.DynamicAttributeName;
                             var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                             if (propertyMain != null)
                             {
                                 var values = (long?)propertyMain.GetValue(Data);
                                 List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                 List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                 DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                 gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == s.DynamicFormGridDropDownId).FirstOrDefault()?.DropDownOptionsModels;
                                 var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                 if (collection != null)
                                 {
                                     foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                     {
                                         dynamic eod = v;
                                         var vv = eod.DynamicFormId;
                                         var AttributeDetailIds = eod.AttributeDetailID;
                                         string listone = string.Empty;
                                         if (gridlistss != null && gridlistss.Count() > 0)
                                         {
                                             var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                             g1.ForEach(q =>
                                                 {
                                                     var byName = (IDictionary<string, object>)v;
                                                     if (q.Value != null)
                                                     {
                                                         if (byName.ContainsKey(q.Value))
                                                         {
                                                             var names = (string)byName[q.Value]?.ToString();
                                                             listone += names + "|";
                                                         }
                                                     }
                                                 });
                                         }
                                         eod.DisplayItemsQuery = listone;
                                         if ((long?)vv == s.DynamicFormGridDropDownId)
                                         {
                                             _dynamicformObjectDataList.Add(eod);
                                         }
                                         if (values > 0)
                                         {
                                             if ((long?)values == (long?)AttributeDetailIds)
                                             {
                                                 DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, eod);
                                             }
                                         }
                                     }

                                 }


                                 var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                 var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                 var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                 var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                 var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);
                                 editor.OpenComponent<DxDropDownBox>(0);
                                 editor.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                 editor.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + s.DisplayName + "..");
                                 editor.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                 editor.AddAttribute(4, "QueryDisplayText", s.DataSourceTable == "DynamicGrid" ? QueryDisplayDynamicComboBoxText : QueryDisplayComboBoxText);
                                 editor.AddAttribute(5, "CssClass", "cw-480");
                                 editor.AddAttribute(6, "Value", GridvalueData);
                                 if (isAccessOnly == true)
                                 {
                                     editor.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                 }
                                 else
                                 {
                                     editor.AddAttribute(8, "Enabled", isAccessOnly);
                                 }
                                 editor.AddAttribute(9, "DropDownVisible", false);
                                 editor.AddAttribute(10, "ValueExpression", Gridlambda);
                                 editor.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnGridValueChanged(str, DataDynamicAttributeName, s.DataSourceTable, Data, DataGridObject, property, attributeDetailss, a, s)));
                                 if (s.IsDefaultReadOnly == false)
                                 {
                                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                     {
                                         if (valueData == null)
                                         {
                                             isRequiredCount += 1;
                                             if (isSubmit == true)
                                             {
                                             }
                                         }
                                     }
                                 }
                                 _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor, _DropDownBoxGridModel, GridDropBoxData, s.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, attributeDetailss, false);
                                 editor.CloseComponent();
                                 if (s.IsDefaultReadOnly == false)
                                 {
                                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                     {
                                         if (valueData == null && isSubmit == true)
                                         {
                                             editor.OpenElement(13, "span");
                                             editor.AddAttribute(14, "class", "text-danger");
                                             editor.AddContent(15, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                             editor.CloseElement();
                                         }
                                     }
                                 }
                             }
                         }
                         else
                         {
                             if (valueData == null && s.IsSetDefaultValue == true)
                             {
                                 if (s.DataSourceTable == "Employee")
                                 {
                                     var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                                     if (exitsDefaultData != null)
                                     {
                                         valueData = applicationUser.UserID;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                                 if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                                 {
                                     var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                                     if (exitsDefaultData != null)
                                     {
                                         valueData = _userEmployee.PlantID;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                             }
                             editor.OpenComponent<DxComboBox<AttributeDetails, long?>>(j + 1);
                             editor.AddAttribute(j + 1, "Data", attributeDetailss);
                             if (s.DataSourceTable == "Employee")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{3}{4}");
                             }
                             else if (s.DataSourceTable == "RawMatPurch")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{2}");
                             }
                             else if (s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "AllProdOrderLine")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}");
                             }



                             editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                             editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                             editor.AddAttribute(j + 1, "NullText", isPrint == true ? "" : "Select " + s.DisplayName + "..");
                             editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                             editor.AddAttribute(j + 1, "SearchMode", ListSearchMode.AutoSearch);
                             editor.AddAttribute(j + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                             editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                             editor.AddAttribute(j + 1, "Value", valueData);
                             if (isAccessOnly == true)
                             {
                                 editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                             }
                             editor.AddAttribute(j + 1, "ValueExpression", lambda);
                             editor.AddAttribute(i++, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                             if (s.IsDefaultReadOnly == false)
                             {
                                 if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                 {
                                     if (valueData == null)
                                     {
                                         isRequiredCount += 1;
                                         if (isSubmit == true)
                                         {
                                             //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                         }
                                     }
                                 }
                             }
                             editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                             {
                                 layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                                 layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                                 layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                                 layoutItemBuilders.CloseComponent();
                                 if (s.DataSourceTable != "SOP")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                                     layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DropDownTypeId == "Data Source")
                                 {
                                     if (s.DataSourceTable == "NavMethodCode" || s.DataSourceTable == "SOP" || s.DataSourceTable == "AllProdOrderLine" || s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "RawMatPurch" || s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                                     {
                                     }
                                     else
                                     {
                                         layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                         layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                                         layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                                         layoutItemBuilders.CloseComponent();
                                     }
                                 }

                                 if (s.DataSourceTable == "NavMethodCode")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                                     layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                                     layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                                     layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                                     layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "Zone" || s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                                     layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                                     layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                                     layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "SpecificArea")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                                     layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "SOP")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                                     layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                                     layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                     layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                                     layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                     layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                                     layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                     layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                                     layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "Employee")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                                     layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                     layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                                     layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                                     layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                                     layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                                     layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                                     layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "AllProdOrderLine")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                                     layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                                     layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                                     layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                                     layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                                     layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                                     layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                                     layoutItemBuilders.CloseComponent();
                                 }
                                 if (s.DataSourceTable == "RawMatPurch")
                                 {
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                                     layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                     layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                                     layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                                     layoutItemBuilders.CloseComponent();
                                     layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                     layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                                     layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                                     layoutItemBuilders.CloseComponent();
                                 }

                             }));
                             editor.CloseComponent();
                             if (s.IsDefaultReadOnly == false)
                             {
                                 if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                 {
                                     if (valueData == null && isSubmit == true)
                                     {
                                         editor.OpenElement(j + 1, "span");
                                         editor.AddAttribute(j + 1, "class", "text-danger");
                                         editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                         editor.CloseElement();
                                     }
                                 }
                             }

                         }
                     }
                     else if (s.ControlType == "TagBox")
                     {
                         if (s.DataSourceTable == "DynamicGrid")
                         {
                             string DataDynamicAttributeName = s.DynamicAttributeName;
                             var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                             if (propertyMain != null)
                             {
                                 DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                 var listData = propertyMain.GetValue(Data);
                                 IEnumerable<long?> valueDatas1 = (IEnumerable<long?>)listData;
                                 List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                 List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                 gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == s.DynamicFormGridDropDownId).FirstOrDefault()?.DropDownOptionsModels;
                                 var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                 List<long?> listDatas = new List<long?>();
                                 if (valueDatas1 != null)
                                 {
                                     listDatas = valueDatas1.ToList();
                                 }
                                 if (collection != null)
                                 {
                                     List<ExpandoObject>? _selecteddynamicformObjectDataList = new List<ExpandoObject>();
                                     foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                     {
                                         dynamic eod = v;
                                         var vv = eod.DynamicFormId;
                                         string listone = string.Empty;
                                         if (gridlistss != null && gridlistss.Count() > 0)
                                         {
                                             var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                             g1.ForEach(q =>
                                                 {
                                                     var byName = (IDictionary<string, object>)v;
                                                     if (q.Value != null)
                                                     {
                                                         if (byName.ContainsKey(q.Value))
                                                         {
                                                             var names = (string)byName[q.Value]?.ToString();
                                                             listone += names + "|";
                                                         }
                                                     }
                                                 });
                                         }
                                         eod.DisplayItemsQuery = listone;
                                         if ((long?)vv == s.DynamicFormGridDropDownId)
                                         {
                                             _dynamicformObjectDataList.Add(eod);
                                         }
                                         var AttributeDetailIds = eod.AttributeDetailID;
                                         if (listDatas.Contains((long?)AttributeDetailIds))
                                         {
                                             _selecteddynamicformObjectDataList.Add(eod);
                                         }
                                     }

                                     DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, _selecteddynamicformObjectDataList.Count() > 0 ? _selecteddynamicformObjectDataList : null);
                                 }



                                 var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                 var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                 var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                 var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                 var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);

                                 editor.OpenComponent<DxDropDownBox>(0);
                                 editor.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                 editor.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + s.DisplayName + "..");
                                 editor.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                 editor.AddAttribute(4, "QueryDisplayText", s.DataSourceTable == "DynamicGrid" ? QueryMultipleDynamicFormText : QueryMultipleText);
                                 editor.AddAttribute(5, "CssClass", "cw-480");
                                 editor.AddAttribute(6, "Value", GridvalueData);
                                 if (isAccessOnly == true)
                                 {
                                     editor.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                 }
                                 else
                                 {
                                     editor.AddAttribute(8, "Enabled", isAccessOnly);
                                 }
                                 editor.AddAttribute(9, "DropDownVisible", false);
                                 editor.AddAttribute(10, "ValueExpression", Gridlambda);
                                 editor.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnMultipleValueChanged(str, DataDynamicAttributeName, s.DataSourceTable, Data, DataGridObject, property, attributeDetailss, a, s)));

                                 if (s.IsDefaultReadOnly == false)
                                 {
                                     if (s.IsRequired == true && isReadonly == true)
                                     {
                                         if (valueData == null)
                                         {
                                             isRequiredCount += 1;
                                             if (isSubmit == true)
                                             {
                                             }
                                         }
                                         else
                                         {
                                             IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                             if (valueDatas != null)
                                             {
                                                 List<long?> listData1 = valueDatas.ToList();
                                                 if (listData1.Count() == 0)
                                                 {
                                                     isRequiredCount += 1;
                                                     if (isSubmit == true)
                                                     {
                                                     }
                                                 }
                                             }
                                         }
                                     }
                                 }
                                 _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor, _DropDownBoxGridModel, GridDropBoxData, s.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, attributeDetailss, true);

                                 editor.CloseComponent();
                                 if (s.IsDefaultReadOnly == false)
                                 {
                                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                     {
                                         if (valueData == null && isSubmit == true)
                                         {
                                             editor.OpenElement(12, "span");
                                             editor.AddAttribute(13, "class", "text-danger");
                                             editor.AddContent(14, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                             editor.CloseElement();
                                         }
                                         else
                                         {
                                             IEnumerable<long?> valueDatas2 = (IEnumerable<long?>)valueData;
                                             if (valueDatas2 != null)
                                             {
                                                 List<long?> listData2 = valueDatas2.ToList();
                                                 if (listData2.Count() == 0 && isSubmit == true)
                                                 {
                                                     editor.OpenElement(15, "span");
                                                     editor.AddAttribute(16, "class", "text-danger");
                                                     editor.AddContent(17, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                                     editor.CloseElement();
                                                 }
                                             }
                                         }
                                     }
                                 }
                             }
                         }
                         else
                         {
                             if (valueData == null && s.IsSetDefaultValue == true)
                             {
                                 if (s.DataSourceTable == "Employee")
                                 {
                                     var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                                     if (exitsDefaultData != null)
                                     {
                                         List<long?> valueDatads = new List<long?>();
                                         valueDatads.Add(applicationUser.UserID);
                                         valueData = valueDatads;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                                 if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                                 {
                                     var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                                     if (exitsDefaultData != null)
                                     {
                                         List<long?> valueDatads = new List<long?>();
                                         valueDatads.Add(_userEmployee.PlantID);
                                         valueData = valueDatads;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                             }
                             editor.OpenComponent<DxTagBox<AttributeDetails, long?>>(j + 1);
                             editor.AddAttribute(j + 1, "Data", attributeDetailss);
                             if (s.DataSourceTable == "Employee")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{3}{4}");
                             }
                             else if (s.DataSourceTable == "RawMatPurch")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{2}");
                             }
                             else if (s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "AllProdOrderLine")
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}");
                             }



                             editor.AddAttribute(j + 1, "NullText", isPrint == true ? "" : "Select " + s.DisplayName + "..");
                             editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                             editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                             editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                             editor.AddAttribute(j + 1, "SearchMode", ListSearchMode.AutoSearch);
                             editor.AddAttribute(j + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                             editor.AddAttribute(j + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                             editor.AddAttribute(j + 1, "Values", valueData);
                             editor.AddAttribute(j + 1, "ValuesExpression", lambda);
                             if (isAccessOnly == true)
                             {
                                 editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                             }
                             editor.AddAttribute(j + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => OnTagBoxChangedItem(str, property, attributeDetailss, a, s)));

                             editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                                {
                                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                                    layoutItemBuilders.CloseComponent();
                                    if (s.DataSourceTable != "SOP")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DropDownTypeId == "Data Source")
                                    {
                                        if (s.DataSourceTable == "NavMethodCode" || s.DataSourceTable == "SOP" || s.DataSourceTable == "AllProdOrderLine" || s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "RawMatPurch" || s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                                        {
                                        }
                                        else
                                        {
                                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                            layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                                            layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                                            layoutItemBuilders.CloseComponent();
                                        }
                                    }
                                    if (s.DataSourceTable == "NavMethodCode")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                                        layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                                        layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                                        layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                                        layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "Zone" || s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                                        layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                                        layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                                        layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "SpecificArea")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                                        layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "SOP")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                                        layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                                        layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                        layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                                        layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                        layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                                        layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                        layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                                        layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "Employee")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                                        layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                        layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                                        layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                                        layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                                        layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "AllProdOrderLine")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                                        layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                                        layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                                        layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                                        layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                                        layoutItemBuilders.CloseComponent();
                                    }
                                    if (s.DataSourceTable == "RawMatPurch")
                                    {
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                                        layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                        layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                                        layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                                        layoutItemBuilders.CloseComponent();
                                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                                        layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                                        layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                                        layoutItemBuilders.CloseComponent();
                                    }

                                }));
                             if (s.IsDefaultReadOnly == false)
                             {
                                 if (s.IsRequired == true && isReadonly == true)
                                 {
                                     if (valueData == null)
                                     {
                                         isRequiredCount += 1;
                                         if (isSubmit == true)
                                         {
                                             //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                         }
                                     }
                                     else
                                     {
                                         IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                         if (valueDatas != null)
                                         {
                                             List<long?> listData = valueDatas.ToList();
                                             if (listData.Count() == 0)
                                             {
                                                 isRequiredCount += 1;
                                                 if (isSubmit == true)
                                                 {
                                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                                 }
                                             }
                                         }
                                     }
                                 }
                             }
                             editor.CloseComponent();
                             if (s.IsDefaultReadOnly == false)
                             {
                                 if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                 {
                                     if (valueData == null && isSubmit == true)
                                     {
                                         editor.OpenElement(j + 1, "span");
                                         editor.AddAttribute(j + 1, "class", "text-danger");
                                         editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                         editor.CloseElement();
                                     }
                                     else
                                     {
                                         IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                         if (valueDatas != null)
                                         {
                                             List<long?> listData = valueDatas.ToList();
                                             if (listData.Count() == 0 && isSubmit == true)
                                             {
                                                 editor.OpenElement(j + 1, "span");
                                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                                 editor.CloseElement();
                                             }
                                         }
                                     }
                                 }
                             }
                         }
                     }
                     else if (s.ControlType == "ListBox")
                     {
                         if (valueData == null && s.IsSetDefaultValue == true)
                         {
                             if (s.DataSourceTable == "Employee")
                             {
                                 var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                                 if (exitsDefaultData != null)
                                 {
                                     if (s.IsMultiple == true)
                                     {
                                         List<long?> valueDatads = new List<long?>();
                                         valueDatads.Add(applicationUser.UserID);
                                         valueData = valueDatads;
                                         property.SetValue(Data, valueData);
                                     }
                                     else
                                     {
                                         valueData = applicationUser.UserID;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                             }
                             if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                             {
                                 var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                                 if (exitsDefaultData != null)
                                 {
                                     if (s.IsMultiple == true)
                                     {
                                         List<long?> valueDatads = new List<long?>();
                                         valueDatads.Add(_userEmployee.PlantID);
                                         valueData = valueDatads;
                                         property.SetValue(Data, valueData);
                                     }
                                     else
                                     {
                                         valueData = _userEmployee.PlantID;
                                         property.SetValue(Data, valueData);
                                     }
                                 }
                             }
                         }
                         editor.OpenComponent<DxListBox<AttributeDetails, long?>>(j + 1);
                         editor.AddAttribute(j + 1, "Data", attributeDetailss);
                         editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                         editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                         if (isAccessOnly == true)
                         {
                             editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                         }
                         editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                         editor.AddAttribute(j + 1, "ShowCheckboxes", true);

                         if (s.IsMultiple == true)
                         {
                             editor.AddAttribute(j + 1, "Values", valueData);
                             editor.AddAttribute(j + 1, "ValuesExpression", lambda);
                             editor.AddAttribute(j + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                             editor.AddAttribute(j + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { property.SetValue(Data, str); }));
                         }
                         else
                         {
                             editor.AddAttribute(j + 1, "Value", valueData);
                             editor.AddAttribute(j + 1, "ValueExpression", lambda);
                             editor.AddAttribute(j + 1, "SelectionMode", ListBoxSelectionMode.Single);
                             editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { property.SetValue(Data, str); }));
                         }
                         editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        if (s.DataSourceTable != "SOP")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                            layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        }
                        layoutItemBuilders.CloseComponent();
                        if (s.DropDownTypeId == "Data Source")
                        {
                            if (s.DataSourceTable == "NavMethodCode" || s.DataSourceTable == "SOP" || s.DataSourceTable == "AllProdOrderLine" || s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "RawMatPurch" || s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                            {
                            }
                            else
                            {
                                layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                                layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                                layoutItemBuilders.CloseComponent();
                            }
                        }
                        if (s.DataSourceTable == "NavMethodCode")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                            layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                            layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                            layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "Zone" || s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                            layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "Location" || s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                            layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "Area" || s.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                            layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                            layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "SOP")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                            layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                            layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                            layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                            layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "Employee")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                            layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "FinishedProdOrderLine" || s.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                            layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                            layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "ReleaseProdOrderLine" || s.DataSourceTable == "AllProdOrderLine")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                            layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                            layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                            layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                            layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (s.DataSourceTable == "RawMatPurch")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                            layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                    }));
                         editor.CloseComponent();
                         if (s.IsDefaultReadOnly == false)
                         {
                             if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                             {
                                 if (valueData == null && isSubmit == true)
                                 {
                                     editor.OpenElement(j + 1, "span");
                                     editor.AddAttribute(j + 1, "class", "text-danger");
                                     editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                     editor.CloseElement();
                                 }
                                 else
                                 {
                                     if (s.IsMultiple == true)
                                     {
                                         IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                         if (valueDatas != null)
                                         {
                                             List<long?> listData = valueDatas.ToList();
                                             if (listData.Count() == 0 && isSubmit == true)
                                             {
                                                 editor.OpenElement(j + 1, "span");
                                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                                 editor.CloseElement();
                                             }
                                         }
                                     }
                                 }
                             }
                         }

                     }
                 })));

                    itemBuilder.CloseComponent();
                }
            }
            k++;
            if (s.ControlType == "ComboBox" && s.IsPlantLoadDependency == true && s.AttributeHeaderDataSource.Count() > 0)
            {
                int plantDummyNo = 1;
                s.AttributeHeaderDataSource.ForEach(dx =>
        {
            dx.DummyNo = plantDummyNo;
            plantDummyNo++;
        });
                s.AttributeHeaderDataSource.ForEach(ff =>
                {
                    int d = 0;
                    var appendDependency = s.DynamicFormSectionAttributeId + "_" + ff.AttributeHeaderDataSourceId + "_" + ff.DataSourceTable + "_Dependency";
                    var propertyDependency = Data.GetType().GetProperty(appendDependency);
                    if (propertyDependency != null)
                    {
                        var aatrDetails = s.SubAttributeDetails.Where(e => e.DropDownTypeId == ff.DataSourceTable).ToList();
                        var exitsFilter = _attributeFilterDetailsList.Where(f => f.AttributeName == appendDependency && f.DataSourceName == ff.DataSourceTable).FirstOrDefault();
                        if (exitsFilter == null)
                        {
                        }
                        else
                        {
                            aatrDetails = exitsFilter.AttributeDetails.ToList();
                        }
                        Type dataTypes = s.IsDependencyMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
                        var valueDataDependency = propertyDependency.GetValue(Data);
                        var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
                        var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(dataTypes), accesspropertyDependency);
                        itemBuilder.OpenComponent<DxFormLayoutItem>(5);
                        // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                               {
                                   editor11.OpenElement(i + 1, "div");
                                   editor11.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                                   editor11.AddContent(i + 1, (a.IsAutoNumberEnabled == true ? (s.DummyNo + "." + ff.DummyNo + " ") : "") + ff.DisplayName);
                                   if (isPrint == false)
                                   {
                                       if (s.IsRequired == true)
                                       {
                                           editor11.OpenElement(i + 1, "span");
                                           editor11.AddAttribute(i + 1, "style", "color: red;");
                                           editor11.AddContent(i + 1, "(*)");
                                           editor11.CloseElement();
                                       }
                                       if (!string.IsNullOrEmpty(s.FormToolTips))
                                       {
                                           editor11.OpenElement(i + 1, "i");
                                           editor11.AddAttribute(i + 1, "class", "fa fa-info");
                                           editor11.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                                           editor11.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{appendDependency}"));
                                           editor11.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(appendDependency, s.FormToolTips)));
                                           editor11.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                                           editor11.AddAttribute(i + 1, "aria-hidden", true);
                                           editor11.CloseElement();
                                       }
                                       var FilterExits = _AttributeHeader.AttributeHeaderDataSource.Where(o => o.DataSourceTable == ff.DataSourceTable).FirstOrDefault()?.IsDynamicFormFilterBy;
                                       if (FilterExits != null && FilterExits > 0)
                                       {
                                           editor11.OpenElement(i + 1, "i");
                                           editor11.AddAttribute(i + 1, "class", "fa fa-filter");
                                           editor11.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                                           editor11.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormFilterBypopup(appendDependency, a, s, ff.DataSourceTable)));
                                           editor11.AddAttribute(i + 1, "title", "Click Here Filter");
                                           editor11.AddAttribute(i + 1, "aria-hidden", true);
                                           editor11.CloseElement();
                                       }
                                   }
                                   editor11.CloseElement();
                                   if (s.IsDependencyMultiple == true)
                                   {
                                       editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(d + 1);
                                   }
                                   else
                                   {
                                       editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(d + 1);
                                   }
                                   editor11.AddAttribute(d + 1, "Data", aatrDetails);
                                   if (ff.DataSourceTable == "Employee")
                                   {
                                       editor11.AddAttribute(d + 1, "EditFormat", "{0}|{1}|{3}{4}");
                                   }
                                   else if (ff.DataSourceTable == "RawMatPurch")
                                   {
                                       editor11.AddAttribute(d + 1, "EditFormat", "{0}|{1}|{2}");
                                   }
                                   else if (ff.DataSourceTable == "ReleaseProdOrderLine" || ff.DataSourceTable == "AllProdOrderLine")
                                   {
                                       editor11.AddAttribute(d + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                                   }
                                   else
                                   {
                                       editor11.AddAttribute(d + 1, "EditFormat", "{0}|{1}");
                                   }
                                   editor11.AddAttribute(d + 1, "TextFieldName", "AttributeDetailName");
                                   editor11.AddAttribute(d + 1, "ValueFieldName", "AttributeDetailID");
                                   editor11.AddAttribute(d + 1, "NullText", isPrint == true ? "" : "Select " + s.PlantDropDownWithOtherDataSourceTable + "..");
                                   editor11.AddAttribute(d + 1, "ListRenderMode", ListRenderMode.Virtual);
                                   editor11.AddAttribute(d + 1, "SearchMode", ListSearchMode.AutoSearch);
                                   editor11.AddAttribute(d + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                                   editor11.AddAttribute(d + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                   if (isAccessOnly == true)
                                   {
                                       editor11.AddAttribute(d + 1, "Enabled", isReadonly);
                                   }
                                   else
                                   {
                                       editor11.AddAttribute(d + 1, "Enabled", isAccessOnly);
                                   }
                                   if (s.IsDependencyMultiple == true)
                                   {
                                       editor11.AddAttribute(d + 1, "Values", valueDataDependency);
                                       editor11.AddAttribute(d + 1, "ValuesExpression", lambdapropertyDependency);
                                       editor11.AddAttribute(d + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyDependency.SetValue(Data, str); }));
                                   }
                                   else
                                   {
                                       editor11.AddAttribute(d + 1, "Value", valueDataDependency);
                                       editor11.AddAttribute(d + 1, "ValueExpression", lambdapropertyDependency);
                                       editor11.AddAttribute(d + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyDependency.SetValue(Data, str); }));
                                   }




                                   editor11.AddAttribute(d + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                           {
                               layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                               layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                               layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                               layoutItemBuilders1.CloseComponent();
                               if (ff.DataSourceTable != "SOP")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                                   layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (s.DropDownTypeId == "Data Source")
                               {
                                   if (ff.DataSourceTable == "NavMethodCode" || ff.DataSourceTable == "SOP" || ff.DataSourceTable == "AllProdOrderLine" || ff.DataSourceTable == "ReleaseProdOrderLine" || ff.DataSourceTable == "RawMatPurch" || ff.DataSourceTable == "FinishedProdOrderLine" || ff.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                                   {
                                   }
                                   else
                                   {
                                       layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                       layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
                                       layoutItemBuilders1.AddAttribute(2, "Caption", "Company");
                                       layoutItemBuilders1.CloseComponent();
                                   }
                               }
                               if (ff.DataSourceTable == "NavMethodCode")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(3, "FieldName", "AvailableBatchSize");
                                   layoutItemBuilders1.AddAttribute(3, "Caption", "Available Batch Size");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(4, "FieldName", "DefaultBatchSize");
                                   layoutItemBuilders1.AddAttribute(4, "Caption", "Default Batch Size");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(5, "FieldName", "BatchUnitSize");
                                   layoutItemBuilders1.AddAttribute(5, "Caption", "Batch Size Unit");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(6, "FieldName", "CompanyName");
                                   layoutItemBuilders1.AddAttribute(6, "Caption", "Company");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "Zone" || ff.DataSourceTable == "Location" || ff.DataSourceTable == "Area" || ff.DataSourceTable == "SpecificArea")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(3, "FieldName", "SiteName");
                                   layoutItemBuilders1.AddAttribute(3, "Caption", "Site");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "Location" || ff.DataSourceTable == "Area" || ff.DataSourceTable == "SpecificArea")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(4, "FieldName", "ZoneName");
                                   layoutItemBuilders1.AddAttribute(4, "Caption", "Zone");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "Area" || ff.DataSourceTable == "SpecificArea")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(5, "FieldName", "LocationName");
                                   layoutItemBuilders1.AddAttribute(5, "Caption", "Location");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "SpecificArea")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(6, "FieldName", "AreaName");
                                   layoutItemBuilders1.AddAttribute(6, "Caption", "Area");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "SOP")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(7, "FieldName", "ProfileNo");
                                   layoutItemBuilders1.AddAttribute(7, "Caption", "Profile No");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(8, "FieldName", "Description");
                                   layoutItemBuilders1.AddAttribute(8, "Caption", "Description");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                   layoutItemBuilders1.AddAttribute(9, "FieldName", "VersionNo");
                                   layoutItemBuilders1.AddAttribute(9, "Caption", "VersionNo");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                   layoutItemBuilders1.AddAttribute(10, "FieldName", "EffectiveDate");
                                   layoutItemBuilders1.AddAttribute(10, "Caption", "Effective Date");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                   layoutItemBuilders1.AddAttribute(11, "FieldName", "ReviewDate");
                                   layoutItemBuilders1.AddAttribute(11, "Caption", "Review Date");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "Employee")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(7, "FieldName", "DesignationName");
                                   layoutItemBuilders1.AddAttribute(7, "Caption", "Designation");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                   layoutItemBuilders1.AddAttribute(8, "FieldName", "DepartmentName");
                                   layoutItemBuilders1.AddAttribute(8, "Caption", "Department");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "FinishedProdOrderLine" || ff.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(8, "FieldName", "Description2");
                                   layoutItemBuilders1.AddAttribute(8, "Caption", "Description2");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(9, "FieldName", "ReplanRefNo");
                                   layoutItemBuilders1.AddAttribute(9, "Caption", "Replan RefNo");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(10, "FieldName", "BatchNo");
                                   layoutItemBuilders1.AddAttribute(10, "Caption", "Batch No");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(11, "FieldName", "CompanyName");
                                   layoutItemBuilders1.AddAttribute(11, "Caption", "Company");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "ReleaseProdOrderLine" || ff.DataSourceTable == "AllProdOrderLine")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(8, "FieldName", "Description2");
                                   layoutItemBuilders1.AddAttribute(8, "Caption", "Description2");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(13, "FieldName", "ProdOrderNo");
                                   layoutItemBuilders1.AddAttribute(13, "Caption", "ProdOrderNo");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(9, "FieldName", "ReplanRefNo");
                                   layoutItemBuilders1.AddAttribute(9, "Caption", "Replan RefNo");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(10, "FieldName", "BatchNo");
                                   layoutItemBuilders1.AddAttribute(10, "Caption", "Batch No");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(11, "FieldName", "BatchSize");
                                   layoutItemBuilders1.AddAttribute(11, "Caption", "Batch Size");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(12, "FieldName", "CompanyName");
                                   layoutItemBuilders1.AddAttribute(12, "Caption", "Company");
                                   layoutItemBuilders1.CloseComponent();
                               }
                               if (ff.DataSourceTable == "RawMatPurch")
                               {
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(8, "FieldName", "BatchNo");
                                   layoutItemBuilders1.AddAttribute(8, "Caption", "Batch No");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                   layoutItemBuilders1.AddAttribute(9, "FieldName", "QcRefNo");
                                   layoutItemBuilders1.AddAttribute(9, "Caption", "QcRefNo");
                                   layoutItemBuilders1.CloseComponent();
                                   layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                                   layoutItemBuilders1.AddAttribute(10, "FieldName", "CompanyName");
                                   layoutItemBuilders1.AddAttribute(10, "Caption", "Company");
                                   layoutItemBuilders1.CloseComponent();
                               }
                           }));
                                   if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                   {
                                       if (valueDataDependency == null)
                                       {
                                           isRequiredCount += 1;
                                           if (isSubmit == true)
                                           {
                                               //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                                           }
                                       }
                                       else
                                       {
                                           if (s.IsDependencyMultiple == true)
                                           {
                                               IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                                               if (valueDatas != null)
                                               {
                                                   List<long?> listData = valueDatas.ToList();
                                                   if (listData.Count() == 0)
                                                   {
                                                       isRequiredCount += 1;
                                                       if (isSubmit == true)
                                                       {
                                                           //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                                       }
                                                   }
                                               }
                                           }
                                       }
                                   }
                                   editor11.CloseComponent();
                                   if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                   {
                                       if (s.IsDependencyMultiple == true)
                                       {
                                           if (valueDataDependency == null && isSubmit == true)
                                           {
                                               editor11.OpenElement(d + 1, "span");
                                               editor11.AddAttribute(d + 1, "class", "text-danger");
                                               editor11.AddContent(d + 1, "This field is Required");
                                               editor11.CloseElement();
                                           }
                                           else
                                           {
                                               if (s.IsMultiple == true)
                                               {
                                                   IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                                                   if (valueDatas != null)
                                                   {
                                                       List<long?> listData = valueDatas.ToList();
                                                       if (listData.Count() == 0 && isSubmit == true)
                                                       {
                                                           editor11.OpenElement(d + 1, "span");
                                                           editor11.AddAttribute(d + 1, "class", "text-danger");
                                                           editor11.AddContent(d + 1, "This field is Required");
                                                           editor11.CloseElement();
                                                       }
                                                   }
                                               }
                                           }
                                       }
                                       else
                                       {
                                           if (valueDataDependency == null && isSubmit == true)
                                           {
                                               editor11.OpenElement(d + 1, "span");
                                               editor11.AddAttribute(d + 1, "class", "text-danger");
                                               editor11.AddContent(d + 1, "This field is Required");
                                               editor11.CloseElement();
                                           }
                                       }
                                   }
                               })));
                        itemBuilder.CloseComponent();
                    }
        ;
                });
            }
            if (s.ControlTypeId == 2705 || s.ControlTypeId == 2711 || s.ControlTypeId == 2710)
            {
                if (s.IsRadioCheckRemarks == "TextBox" || s.IsRadioCheckRemarks == "Memo")
                {
                    var appendProNames = s.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + s.AttributeName;
                    var propertyRemarks = Data.GetType().GetProperty(appendProNames);
                    if (propertyRemarks != null)
                    {
                        var valueDataRemarks = propertyRemarks.GetValue(Data);
                        var accessRemarks = Expression.Property(Expression.Constant(Data), appendProNames);
                        var lambdaRemarks = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(string)), accessRemarks);
                        itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                        // itemBuilder.AddAttribute(i++, "Caption", (string.IsNullOrEmpty(s.RemarksLabelName) ? "Remarks" : s.RemarksLabelName));
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context1) => ((editor1) =>
            {
                editor1.OpenElement(i + 1, "div");
                editor1.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                editor1.AddContent(i + 1, (string.IsNullOrEmpty(s.RemarksLabelName) ? "Remarks" : s.RemarksLabelName));
                editor1.CloseElement();
                if (s.IsRadioCheckRemarks == "TextBox")
                {
                    editor1.OpenComponent<DxTextBox>(i++);
                }
                if (s.IsRadioCheckRemarks == "Memo")
                {
                    editor1.OpenComponent<DxMemo>(i++);
                    editor1.AddAttribute(i++, "Rows", 5);
                }
                editor1.AddAttribute(i++, "Text", valueDataRemarks);
                editor1.AddAttribute(i++, "TextExpression", lambdaRemarks);
                if (isAccessOnly == true)
                {
                    editor1.AddAttribute(i + 1, "Enabled", isReadonly);
                }
                else
                {
                    editor1.AddAttribute(i + 1, "Enabled", isAccessOnly);
                }
                editor1.AddAttribute(i++, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                editor1.AddAttribute(i++, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertyRemarks.SetValue(Data, str); }));
                editor1.CloseComponent();
            })));
                        itemBuilder.CloseComponent();
                    }
                }
            }

            if (s.ControlType == "CheckBox" || s.ControlType == "Radio" || s.ControlType == "RadioGroup")
            {
                List<AttributeHeader> SubAttributeHeadersList = new List<AttributeHeader>();
                if (Data.GetType().GetProperty(s.DynamicAttributeName) != null)
                {
                    if (s.ControlType == "CheckBox")
                    {
                        var avluess = (bool?)Data.GetType().GetProperty(s.DynamicAttributeName).GetValue(Data);
                        if (avluess == true)
                        {
                            SubAttributeHeadersList = s.SubAttributeHeaders;
                        }
                    }
                    if (s.ControlType == "Radio" || s.ControlType == "RadioGroup")
                    {
                        var avluess = (long?)Data.GetType().GetProperty(s.DynamicAttributeName).GetValue(Data);
                        if (avluess > 0)
                        {
                            var attrDetails = _AttributeHeader.AttributeDetails.Where(mm => mm.AttributeDetailID == avluess && mm.DropDownTypeId == null).FirstOrDefault()?.SubAttributeHeaders;
                            if (attrDetails != null && attrDetails.Count > 0)
                            {
                                SubAttributeHeadersList = attrDetails;
                            }
                        }
                    }
                    if (SubAttributeHeadersList != null && SubAttributeHeadersList.Count > 0)
                    {
                        int subDummyNo = 1;
                        SubAttributeHeadersList.ForEach(dx =>
        {
            dx.DummyNo = subDummyNo;
            subDummyNo++;
        });
                        SubAttributeHeadersList.ForEach(q =>
            {
                int m = 0;
                var appendProSubNames = s.DynamicFormSectionAttributeId + "_" + q.SubDynamicAttributeName;
                var subaatrDetails = q.SubAttributeDetails;
                var exitsFilter = _attributeFilterDetailsList.Where(f => f.AttributeName == appendProSubNames && f.DataSourceName == q.DataSourceTable).FirstOrDefault();
                if (exitsFilter == null)
                {
                }
                else
                {
                    subaatrDetails = exitsFilter.AttributeDetails.ToList();
                }
                if (q.DataSourceTable == "ApplicationMaster")
                {
                    if (q.SubApplicationMaster != null && q.SubApplicationMaster.Count() > 0)
                    {
                        loadApplicationMasterSubForm(s, q, i, itemBuilder, isAccessOnly, isReadonly, a, s.ColSpan);
                    }
                }
                else if (q.DataSourceTable == "ApplicationMasterParent")
                {
                    if (q.SubApplicationMasterParent != null && q.SubApplicationMasterParent.Count() > 0)
                    {
                        //loadApplicationMasterParentSubForm(s, q, i, itemBuilder, isAccessOnly, isReadonly);
                    }
                }
                else
                {
                    var propertySub = Data.GetType().GetProperty(appendProSubNames);
                    if (propertySub != null)
                    {
                        itemBuilder.OpenComponent<DxFormLayoutItem>(2);
                        //itemBuilder.AddAttribute(i++, "Caption", q.Description);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context1) => ((editor1) =>
                {
                    editor1.OpenElement(i + 1, "div");
                    editor1.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor1.AddContent(i + 1, (a.IsAutoNumberEnabled == true ? (s.DummyNo + "." + q.DummyNo + " ") : "") + q.Description);
                    if (isPrint == false)
                    {
                        if (q.IsRequired == true)
                        {
                            editor1.OpenElement(i + 1, "span");
                            editor1.AddAttribute(i + 1, "style", "color: red;");
                            editor1.AddContent(i + 1, "(*)");
                            editor1.CloseElement();
                        }
                        if (!string.IsNullOrEmpty(q.AttrDescription))
                        {
                            editor1.OpenElement(i + 1, "i");
                            editor1.AddAttribute(i + 1, "class", "fa fa-info");
                            editor1.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                            editor1.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{appendProSubNames}"));
                            editor1.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(appendProSubNames, q.AttrDescription)));
                            editor1.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                            editor1.AddAttribute(i + 1, "aria-hidden", true);
                            editor1.CloseElement();
                        }
                        var FilterExits = _AttributeHeader.AttributeHeaderDataSource.Where(o => o.DataSourceTable == q.DataSourceTable).FirstOrDefault()?.IsDynamicFormFilterBy;
                        if (FilterExits != null && FilterExits > 0)
                        {
                            editor1.OpenElement(i + 1, "i");
                            editor1.AddAttribute(i + 1, "class", "fa fa-filter");
                            editor1.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                            editor1.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormFilterBypopup(appendProSubNames, a, s, q.DataSourceTable)));
                            editor1.AddAttribute(i + 1, "title", "Click Here Filter");
                            editor1.AddAttribute(i + 1, "aria-hidden", true);
                            editor1.CloseElement();
                        }
                    }
                    editor1.CloseElement();
                    var valueDataSub = propertySub.GetValue(Data);
                    var accessSub = Expression.Property(Expression.Constant(Data), appendProSubNames);
                    var lambdaSub = Expression.Lambda(typeof(Func<>).MakeGenericType(q.SubDataType), accessSub);
                    var propertySubType = Nullable.GetUnderlyingType(propertySub.PropertyType) ?? propertySub.PropertyType;
                    if (q.ControlType == "TextBox")
                    {
                        editor1.OpenComponent<DxTextBox>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    // editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    if (q.ControlType == "QR Code")
                    {
                        editor1.OpenComponent<DxTextBox>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        editor1.AddAttribute(m + 1, "Buttons", (RenderFragment)((dx) =>
                        {
                            dx.OpenComponent<DxEditorButton>(m + 1);
                            dx.AddAttribute(m + 1, "IconCssClass", "fa fa-qrcode");
                            dx.AddAttribute(m + 1, "Tooltip", "Scan Qr Code");
                            dx.AddAttribute(m + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnButtonQrCodeClick(str, propertySub)));
                            dx.CloseComponent();
                        }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    // editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "Memo")
                    {
                        editor1.OpenComponent<DxMemo>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "Rows", 5);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "DateEdit")
                    {
                        editor1.OpenComponent<DxDateEdit<DateTime?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Date", valueDataSub);
                        editor1.AddAttribute(m + 1, "DateExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "DateChanged", EventCallback.Factory.Create<System.DateTime?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "TimeEdit")
                    {
                        editor1.OpenComponent<DxTimeEdit<TimeSpan?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Time", valueDataSub);
                        editor1.AddAttribute(m + 1, "TimeExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TimeChanged", EventCallback.Factory.Create<System.TimeSpan?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "SpinEdit")
                    {
                        if (propertySubType.Name == "Int32")
                        {
                            editor1.OpenComponent<DxSpinEdit<int?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            //editor1.AddAttribute(m + 1, "MinValue", 0);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "BindValueMode", BindValueMode.OnInput);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<int?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        if (propertySubType.Name == "Decimal")
                        {
                            editor1.OpenComponent<DxSpinEdit<decimal?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            editor1.AddAttribute(m + 1, "Increment", 0.1M);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            //editor1.AddAttribute(m + 1, "MinValue", 0M);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<decimal?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "CheckBox")
                    {
                        editor1.OpenComponent<DxCheckBox<bool?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Checked", valueDataSub ?? false);
                        editor1.AddAttribute(m + 1, "CheckedExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        //editor1.AddAttribute(i+1, "LabelPosition", LabelPosition.Right);
                        editor1.AddAttribute(m + 1, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (s.IsRequired == true)
                        {
                            if (valueDataSub == null || (bool)valueDataSub == false)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null || (bool)valueDataSub == false && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "RadioGroup" || q.ControlType == "Radio")
                    {
                        editor1.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Items", subaatrDetails);
                        editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                        editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                        editor1.AddAttribute(m + 1, "Value", valueDataSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "Layout", q.AttributeRadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                        editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                        editor1.AddAttribute(m + 1, "style", "margin-left:25px;");
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    editor1.AddAttribute(m + 1, "style", "color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "ComboBox")
                    {
                        if (q.DataSourceTable == "DynamicGrid")
                        {
                            //var gridOb=s.DynamicFormSectionAttributeId + "_" + q.AttributeID + "_DynamicGrid";
                            string DataDynamicAttributeName = appendProSubNames;
                            var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                            if (propertyMain != null)
                            {
                                var values = (long?)propertyMain.GetValue(Data);
                                List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == q.DynamicFormId).FirstOrDefault()?.DropDownOptionsModels;
                                var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                if (collection != null)
                                {
                                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                    {
                                        dynamic eod = v;
                                        var vv = eod.DynamicFormId;
                                        var AttributeDetailIds = eod.AttributeDetailID;
                                        string listone = string.Empty;
                                        if (gridlistss != null && gridlistss.Count() > 0)
                                        {
                                            var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                            g1.ForEach(q =>
                                                    {
                                                        var byName = (IDictionary<string, object>)v;
                                                        if (q.Value != null)
                                                        {
                                                            if (byName.ContainsKey(q.Value))
                                                            {
                                                                var names = (string)byName[q.Value]?.ToString();
                                                                listone += names + "|";
                                                            }
                                                        }
                                                    });
                                        }
                                        eod.DisplayItemsQuery = listone;
                                        if ((long?)vv == q.DynamicFormId)
                                        {
                                            _dynamicformObjectDataList.Add(eod);
                                        }
                                        if (values > 0)
                                        {
                                            if ((long?)values == (long?)AttributeDetailIds)
                                            {
                                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, eod);
                                            }
                                        }
                                    }

                                }


                                var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);
                                editor1.OpenComponent<DxDropDownBox>(0);
                                editor1.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                editor1.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                                editor1.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                editor1.AddAttribute(4, "QueryDisplayText", q.DataSourceTable == "DynamicGrid" ? QueryDisplayDynamicComboBoxText : QueryDisplayComboBoxText);
                                editor1.AddAttribute(5, "CssClass", "cw-480");
                                editor1.AddAttribute(6, "Value", GridvalueData);
                                if (isAccessOnly == true)
                                {
                                    editor1.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                }
                                else
                                {
                                    editor1.AddAttribute(8, "Enabled", isAccessOnly);
                                }
                                editor1.AddAttribute(9, "DropDownVisible", false);
                                editor1.AddAttribute(10, "ValueExpression", Gridlambda);
                                editor1.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnGridValueChanged(str, DataDynamicAttributeName, q.DataSourceTable, Data, DataGridObject, propertyMain, subaatrDetails, a, s)));
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                            }
                                        }
                                    }
                                }
                                _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor1, _DropDownBoxGridModel, GridDropBoxData, q.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, subaatrDetails, false);
                                editor1.CloseComponent();
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null && isSubmit == true)
                                        {
                                            editor1.OpenElement(13, "span");
                                            editor1.AddAttribute(14, "class", "text-danger");
                                            editor1.AddContent(15, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            editor1.OpenComponent<DxComboBox<AttributeDetails, long?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                            if (q.DataSourceTable == "Employee")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{3}{4}");
                            }
                            else if (q.DataSourceTable == "RawMatPurch")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{2}");
                            }
                            else if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                            }
                            editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                            editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                            editor1.AddAttribute(m + 1, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                            editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor1.AddAttribute(m + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor1.AddAttribute(m + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                            editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();
                    if (q.DataSourceTable != "SOP")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DropDownTypeId == "Data Source")
                    {
                        if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                        }
                        else
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                    }
                    if (q.DataSourceTable == "NavMethodCode")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                        layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                        layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                        layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                        layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                        layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                        layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                        layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "SOP")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                        layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Employee")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                        layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                        layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "RawMatPurch")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }));
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                            editor1.CloseComponent();
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null && isSubmit == true)
                                {
                                    editor1.OpenElement(m + 1, "span");
                                    editor1.AddAttribute(m + 1, "class", "text-danger");
                                    editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor1.CloseElement();
                                }
                            }
                        }
                    }

                    else if (q.ControlType == "TagBox")
                    {
                        if (q.DataSourceTable == "DynamicGrid")
                        {
                            string DataDynamicAttributeName = appendProSubNames;
                            var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                            if (propertyMain != null)
                            {
                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                var listData = propertyMain.GetValue(Data);
                                IEnumerable<long?> valueDatas1 = (IEnumerable<long?>)listData;
                                List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == q.DynamicFormId).FirstOrDefault()?.DropDownOptionsModels;
                                var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                List<long?> listDatas = new List<long?>();
                                if (valueDatas1 != null)
                                {
                                    listDatas = valueDatas1.ToList();
                                }
                                if (collection != null)
                                {
                                    List<ExpandoObject>? _selecteddynamicformObjectDataList = new List<ExpandoObject>();
                                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                    {
                                        dynamic eod = v;
                                        var vv = eod.DynamicFormId;
                                        string listone = string.Empty;
                                        if (gridlistss != null && gridlistss.Count() > 0)
                                        {
                                            var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                            g1.ForEach(q =>
                                                {
                                                    var byName = (IDictionary<string, object>)v;
                                                    if (q.Value != null)
                                                    {
                                                        if (byName.ContainsKey(q.Value))
                                                        {
                                                            var names = (string)byName[q.Value]?.ToString();
                                                            listone += names + "|";
                                                        }
                                                    }
                                                });
                                        }
                                        eod.DisplayItemsQuery = listone;
                                        if ((long?)vv == q.DynamicFormId)
                                        {
                                            _dynamicformObjectDataList.Add(eod);
                                        }
                                        var AttributeDetailIds = eod.AttributeDetailID;
                                        if (listDatas.Contains((long?)AttributeDetailIds))
                                        {
                                            _selecteddynamicformObjectDataList.Add(eod);
                                        }
                                    }

                                    DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, _selecteddynamicformObjectDataList.Count() > 0 ? _selecteddynamicformObjectDataList : null);
                                }



                                var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);

                                editor1.OpenComponent<DxDropDownBox>(0);
                                editor1.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                editor1.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                                editor1.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                editor1.AddAttribute(4, "QueryDisplayText", q.DataSourceTable == "DynamicGrid" ? QueryMultipleDynamicFormText : QueryMultipleText);
                                editor1.AddAttribute(5, "CssClass", "cw-480");
                                editor1.AddAttribute(6, "Value", GridvalueData);
                                if (isAccessOnly == true)
                                {
                                    editor1.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                }
                                else
                                {
                                    editor1.AddAttribute(8, "Enabled", isAccessOnly);
                                }
                                editor1.AddAttribute(9, "DropDownVisible", false);
                                editor1.AddAttribute(10, "ValueExpression", Gridlambda);
                                editor1.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnMultipleValueChanged(str, DataDynamicAttributeName, q.DataSourceTable, Data, DataGridObject, propertyMain, subaatrDetails, a, s)));

                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true)
                                    {
                                        if (valueDataSub == null)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                            }
                                        }
                                        else
                                        {
                                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                            if (valueDatas != null)
                                            {
                                                List<long?> listData1 = valueDatas.ToList();
                                                if (listData1.Count() == 0)
                                                {
                                                    isRequiredCount += 1;
                                                    if (isSubmit == true)
                                                    {
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor1, _DropDownBoxGridModel, GridDropBoxData, q.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, subaatrDetails, true);

                                editor1.CloseComponent();
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null && isSubmit == true)
                                        {
                                            editor1.OpenElement(12, "span");
                                            editor1.AddAttribute(13, "class", "text-danger");
                                            editor1.AddContent(14, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                        else
                                        {
                                            IEnumerable<long?> valueDatas2 = (IEnumerable<long?>)valueDataSub;
                                            if (valueDatas2 != null)
                                            {
                                                List<long?> listData2 = valueDatas2.ToList();
                                                if (listData2.Count() == 0 && isSubmit == true)
                                                {
                                                    editor1.OpenElement(15, "span");
                                                    editor1.AddAttribute(16, "class", "text-danger");
                                                    editor1.AddContent(17, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                                    editor1.CloseElement();
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            editor1.OpenComponent<DxTagBox<AttributeDetails, long?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                            if (q.DataSourceTable == "Employee")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{3}{4}");
                            }
                            else if (q.DataSourceTable == "RawMatPurch")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{2}");
                            }
                            else if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                            }
                            editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                            editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                            editor1.AddAttribute(m + 1, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                            editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor1.AddAttribute(m + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor1.AddAttribute(m + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "Values", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                            editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
            {
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                layoutItemBuilders.CloseComponent();
                if (q.DataSourceTable != "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DropDownTypeId == "Data Source")
                {
                    if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                    }
                    else
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }
                if (q.DataSourceTable == "NavMethodCode")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Employee")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "FinishedProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                    layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "RawMatPurch")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
            }));
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                            }
                                        }
                                    }
                                }
                            }
                            editor1.CloseComponent();
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null && isSubmit == true)
                                {
                                    editor1.OpenElement(m + 1, "span");
                                    editor1.AddAttribute(m + 1, "class", "text-danger");
                                    editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor1.CloseElement();
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0 && isSubmit == true)
                                        {
                                            editor1.OpenElement(m + 1, "span");
                                            editor1.AddAttribute(m + 1, "class", "text-danger");
                                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (q.ControlType == "ListBox")
                    {
                        editor1.OpenComponent<DxListBox<AttributeDetails, long?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                        editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                        editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                        editor1.AddAttribute(m + 1, "ShowCheckboxes", true);
                        if (q.IsMultiple == true)
                        {
                            editor1.AddAttribute(m + 1, "Values", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                            editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Single);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
            {
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                layoutItemBuilders.CloseComponent();
                if (q.DataSourceTable != "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DropDownTypeId == "Data Source")
                {
                    if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                    }
                    else
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }
                if (q.DataSourceTable == "NavMethodCode")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Employee")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                    layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "RawMatPurch")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
            }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                            else
                            {
                                if (q.IsMultiple == true)
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                            else
                            {
                                if (q.IsMultiple == true)
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0 && isSubmit == true)
                                        {
                                            editor1.OpenElement(m + 1, "span");
                                            editor1.AddAttribute(m + 1, "class", "text-danger");
                                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }

                    }
                })));
                        itemBuilder.CloseComponent();
                    }
                }
            });

                    }
                }
            }
            if (s.DataSourceTable == "ApplicationMaster" && s.ApplicationMaster != null && s.ApplicationMaster.Count > 0)

            {
                loadApplicationMasterForm(s, i, itemBuilder, isAccessOnly, isReadonly, a);
            }
            if (s.DataSourceTable == "ApplicationMasterParent" && s.ApplicationMasterParents != null && s.ApplicationMasterParents.Count() > 0)
            {
                loadApplicationMasterParentForm(s, i, itemBuilder, isAccessOnly, isReadonly, a);
            }
            if (s.DataSourceTable == "DynamicGrid")
            {
                loadDynamicGridDropDownForm(s, i, itemBuilder, isAccessOnly, isReadonly);
            }
        });

        }
        if (dynamicFormData != null)
        {
            // if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSectionNoWorkFlow.Count() > 0)
            // {
            //     var exitss = _dynamicFormWorkFlowSectionNoWorkFlow.FirstOrDefault(f => f.DynamicFormSectionId == a.DynamicFormSectionId && f.UserId == applicationUser.UserID);
            //     if (_dynamicform.IsApproval == true)
            //     {
            //         isApprovalEnabled = true;
            //         isVisibleButton = true;
            //         if (_dynamicformData != null)
            //         {
            //             CheckedApprovalData();
            //         }
            //     }
            //     if (_dynamicformData == null)
            //     {
            //         isSaveEnabled = true;
            //     }
            //     if (exitss != null)
            //     {
            //         if (exitss.IsWorkFlowDone == 0)
            //         {
            //             isWorkflowEnabled = true; isSaveEnabled = true;
            //             if (_dynamicformData != null)
            //             {
            //                 if (isApproval == true)
            //                 {
            //                     IsUploadEnabled = true;
            //                 }
            //             }
            //         }
            //     }
            // }
        }
        else
        {

        }
    }));

        layoutItemBuilder.CloseComponent();
    }));

            formLayoutBuilder.CloseComponent();
        }
        //PanelVisible = false;
        sec++;
    });

            }
        }
        //PanelVisible = false;
        InvokeAsync(onhideLoading);
    };
    void loadDynamicGridDropDownForm(DynamicFormSectionAttribute s, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        var dynamicGridFormIds = s.DynamicGridDynamicFormData.Select(s => s.DynamicFormDataGridFormId).Distinct().ToList();
        if (dynamicGridFormIds.Count() > 0)
        {
            if (s.ControlTypeId == 2702)
            {
                var proGrid = Data.GetType().GetProperty(s.DynamicAttributeName);
                var proGridValue = (long?)proGrid.GetValue(Data);
                dynamicGridFormIds.ForEach(r =>
                {
                    var appendDependency = s.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                    var propertyDependency = Data.GetType().GetProperty(appendDependency);
                    var formNames = s.DynamicGridDynamicFormData.FirstOrDefault(f => f.DynamicFormDataGridFormId == r);
                    if (propertyDependency != null)
                    {
                        int p = 0;
                        var valueDataDependency = propertyDependency.GetValue(Data);
                        var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
                        var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyDependency);
                        List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                        gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == r).FirstOrDefault()?.DropDownOptionsModels;
                        var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                        List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                        if (proGridValue != null && collection != null)
                        {
                            foreach (var v in (collection as IEnumerable<ExpandoObject>))
                            {
                                dynamic eod = v;
                                var vv = eod.DynamicFormId; var vc = (long?)eod.DynamicFormDataGridId;
                                if ((long?)vv == r && proGridValue == vc)
                                {
                                    _dynamicformObjectDataList.Add(v);
                                }
                            }
                        }
                        itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                        // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                        {
                            editor11.OpenElement(p + 1, "div");
                            editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                            editor11.AddContent(p + 1, formNames?.DynamicFormName);
                            if (s.IsRequired == true)
                            {
                                editor11.OpenElement(p + 1, "span");
                                editor11.AddAttribute(p + 1, "style", "color: red;");
                                editor11.AddContent(p + 1, "(*)");
                                editor11.CloseElement();
                            }
                            editor11.CloseElement();
                            editor11.OpenComponent<DxComboBox<ExpandoObject, long?>>(p + 1);
                            editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                            editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                            editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                            editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + formNames?.DynamicFormName + "..");
                            editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor11.AddAttribute(p + 1, "Value", valueDataDependency);
                            if (isAccessOnly == true)
                            {
                                editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
                            }
                            editor11.AddAttribute(p + 1, "ValueExpression", lambdapropertyDependency);
                            editor11.AddAttribute(p + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyDependency.SetValue(Data, str); }));
                            if (gridlistss != null)
                            {
                                var gridEditCount = gridlistss.Count();
                                var editFormat = "{0}";
                                for (int e = 0; e < gridEditCount; e++)
                                {
                                    if (e == 0)
                                    {
                                        editFormat = string.Empty;
                                    }
                                    editFormat += "{" + "" + e + "" + "}|";
                                }
                                editFormat = editFormat.Trim();
                                if (editFormat.EndsWith("|"))
                                {
                                    editFormat = editFormat.Remove(editFormat.Length - 1);
                                }
                                editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                            }
                            editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                            {
                                if (gridlistss != null)
                                {
                                    var qCount = 0;
                                    gridlistss.ForEach(q =>
                                    {
                                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                        layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                        layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                        layoutItemBuilders1.CloseComponent();
                                        qCount++;
                                    });
                                }
                            }));
                            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                            {
                                if (valueDataDependency == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                            editor11.CloseComponent();
                            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                            {
                                if (valueDataDependency == null && isSubmit == true)
                                {
                                    editor11.OpenElement(p + 1, "span");
                                    editor11.AddAttribute(p + 1, "class", "text-danger");
                                    editor11.AddContent(p + 1, "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        })));
                        itemBuilder.CloseComponent();
                    }
                });
            }
            if (s.ControlTypeId == 2708)
            {
                var proGrid = Data.GetType().GetProperty(s.DynamicAttributeName);
                var proGridValue = (IEnumerable<long?>)proGrid.GetValue(Data);
                dynamicGridFormIds.ForEach(r =>
                {
                    var appendDependency = s.DynamicFormSectionAttributeId + "_" + r + "_DynamicGrid";
                    var propertyDependency = Data.GetType().GetProperty(appendDependency);
                    var formNames = s.DynamicGridDynamicFormData.FirstOrDefault(f => f.DynamicFormDataGridFormId == r);
                    if (propertyDependency != null)
                    {
                        var valueDataDependency = propertyDependency.GetValue(Data);
                        var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
                        var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyDependency);
                        List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                        gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == r).FirstOrDefault()?.DropDownOptionsModels;
                        var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                        List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                        if (proGridValue != null && collection != null)
                        {
                            List<long?> listsData = proGridValue.ToList();
                            foreach (var v in (collection as IEnumerable<ExpandoObject>))
                            {
                                dynamic eod = v;
                                var vv = eod.DynamicFormId; var vc = (long?)eod.DynamicFormDataGridId;
                                if ((long?)vv == r && listsData.Contains(vc))
                                {
                                    _dynamicformObjectDataList.Add(v);
                                }
                            }
                        }
                        int p = 0;
                        itemBuilder.OpenComponent<DxFormLayoutItem>(4);
                        // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                        {
                            editor11.OpenElement(p + 1, "div");
                            editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                            editor11.AddContent(p + 1, formNames?.DynamicFormName);
                            if (s.IsRequired == true)
                            {
                                editor11.OpenElement(i + 1, "span");
                                editor11.AddAttribute(i + 1, "style", "color: red;");
                                editor11.AddContent(i + 1, "(*)");
                                editor11.CloseElement();
                            }
                            editor11.CloseElement();
                            editor11.OpenComponent<DxTagBox<ExpandoObject, long?>>(p + 1);
                            editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                            editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                            editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                            editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + formNames?.DynamicFormName + "..");
                            editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor11.AddAttribute(p + 1, "Values", valueDataDependency);
                            if (isAccessOnly == true)
                            {
                                editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor11.AddAttribute(p + 1, "Enabled", isAccessOnly);
                            }
                            editor11.AddAttribute(p + 1, "ValuesExpression", lambdapropertyDependency);
                            editor11.AddAttribute(p + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyDependency.SetValue(Data, str); }));
                            if (gridlistss != null)
                            {
                                var gridEditCount = gridlistss.Count();
                                var editFormat = "{0}";
                                for (int e = 0; e < gridEditCount; e++)
                                {
                                    if (e == 0)
                                    {
                                        editFormat = string.Empty;
                                    }
                                    editFormat += "{" + "" + e + "" + "}|";
                                }
                                editFormat = editFormat.Trim();
                                if (editFormat.EndsWith("|"))
                                {
                                    editFormat = editFormat.Remove(editFormat.Length - 1);
                                }
                                editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                            }
                            editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                            {
                                if (gridlistss != null)
                                {
                                    var qCount = 0;
                                    gridlistss.ForEach(q =>
                                    {
                                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                        layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                        layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                        layoutItemBuilders1.CloseComponent();
                                        qCount++;
                                    });
                                }
                            }));
                            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                            {
                                if (valueDataDependency == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                    }
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                                //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                            }
                                        }
                                    }

                                }
                            }
                            editor11.CloseComponent();
                            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                            {
                                if (valueDataDependency == null && isSubmit == true)
                                {
                                    editor11.OpenElement(p + 1, "span");
                                    editor11.AddAttribute(p + 1, "class", "text-danger");
                                    editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0 && isSubmit == true)
                                        {
                                            editor11.OpenElement(p + 1, "span");
                                            editor11.AddAttribute(p + 1, "class", "text-danger");
                                            editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                            editor11.CloseElement();
                                        }
                                    }
                                }
                            }
                        })));
                        itemBuilder.CloseComponent();
                    }
                });
            }
        }
    }
    void loadApplicationMasterParentForm(DynamicFormSectionAttribute s, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, DynamicFormSection dynamicFormSection)
    {
        int dumNo = 1;
        s.ApplicationMasterParents.ForEach(ab =>
        {
            ab.DummyNo = dumNo;
            dumNo++;
        });
        s.ApplicationMasterParents.ForEach(ab =>
        {
            List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
            loadApplicationMasterParentRecursiveForm(s, ab, i, itemBuilder, isAccessOnly, isReadonly, true, dynamicFormSection);
            if (ab.ApplicationMasterParentCodeId > 0)
            {
                nameDatas.Add(ab);
                loadApplicationMasterParentFormDataList(s, ab, i, itemBuilder, isAccessOnly, isReadonly, nameDatas, dynamicFormSection);
                if (s.ControlTypeId == 2702 && s.DropDownTypeId == "Data Source" && s.DataSourceTable == "ApplicationMasterParent" && s.IsDynamicFormGridDropdown == true)
                {
                    loadDynamicGridDropDownNestedForm(s, ab, i, itemBuilder, isAccessOnly, isReadonly, nameDatas, dynamicFormSection);
                }
            }
        });
    }
    void loadApplicationMasterParentFormDataList(DynamicFormSectionAttribute s, ApplicationMasterParent ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, List<ApplicationMasterParent> dataColumnNames, DynamicFormSection dynamicFormSection)
    {
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == ab.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            var nameData = s.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar";
            dataColumnNames.Add(dataList);
            loadApplicationMasterParentRecursiveForm(s, dataList, i, itemBuilder, isAccessOnly, isReadonly, false, dynamicFormSection);

            loadApplicationMasterParentFormDataList(s, dataList, i, itemBuilder, isAccessOnly, isReadonly, dataColumnNames, dynamicFormSection);
        }
    }
    void loadDynamicGridDropDownNestedForm(DynamicFormSectionAttribute s, ApplicationMasterParent ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, List<ApplicationMasterParent> nameDatasItems, DynamicFormSection dynamicFormSection)
    {
        var appendDependency = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_" + s.GridDropDownDynamicFormID + "_GridAppMaster";
        var propertyDependency = Data.GetType().GetProperty(appendDependency);
        if (propertyDependency != null)
        {
            int p = 0;
            var valueDataDependency = propertyDependency.GetValue(Data);
            var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
            Type dataTypess = s.IsDynamicFormGridDropdownMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
            var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(dataTypess), accesspropertyDependency);
            List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
            var dynamicFormDatass = _AttributeHeader.DropDownOptionsGridListModel.DynamicFormData.Where(f => f.DynamicFormId == s.GridDropDownDynamicFormID).ToList();
            var dynamicFormDataIds = dynamicFormDatass.FirstOrDefault()?.DynamicFormDataGridFormId;
            gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == (dynamicFormDataIds > 0 ? dynamicFormDataIds : 0)).FirstOrDefault()?.DropDownOptionsModels;
            var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
            List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();

            if (s.ControlTypeId == 2702 && s.DropDownTypeId == "Data Source" && s.DataSourceTable == "ApplicationMasterParent" && s.IsDynamicFormGridDropdown == true)
            {
                List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
                List<ApplicationMasterParent> nameDataLists = new List<ApplicationMasterParent>();
                nameDatas.Add(ab);
                if (ab.ParentId > 0)
                {
                    GetApplicationMasterParentListId(ab.ParentId, nameDatas);
                }
                var applicationMasterCodeId = nameDatas.Last()?.ApplicationMasterParentCodeId;
                if (applicationMasterCodeId > 0 && _AttributeHeader.ApplicationMasterParent != null && _AttributeHeader.ApplicationMasterParent.Count() > 0)
                {
                    var appName = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == applicationMasterCodeId);
                    if (appName != null)
                    {
                        nameDataLists.Add(appName);
                        GetApplicationMasterParentAllListId(applicationMasterCodeId, nameDataLists);
                    }
                }
                IDictionary<string, object> objectDataList = new ExpandoObject();
                if (nameDataLists != null && nameDataLists.Count() > 0)
                {
                    nameDataLists.ForEach(a =>
                    {
                        var namesetData = s.DynamicFormSectionAttributeId + "_" + a.ApplicationMasterParentCodeId + "_AppMasterPar";
                        var propertyAppMastersData = Data.GetType().GetProperty(namesetData);
                        long? valueDataAppMaster = 0;
                        if (propertyAppMastersData != null)
                        {
                            valueDataAppMaster = (long?)propertyAppMastersData.GetValue(Data);
                        }
                        if (valueDataAppMaster != null)
                        {
                            objectDataList[a.ApplicationMasterParentCodeId + "_AppMasterPar"] = valueDataAppMaster == null ? 0 : valueDataAppMaster;
                        }
                    });
                }
                List<long?> _dynamicformObjectDataIds = new List<long?>();
                if (collection != null)
                {
                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                    {
                        dynamic eod = v;
                        var IsDynamicFormDataGrids = (bool?)eod.IsDynamicFormDataGrid;
                        var vc = (long?)eod.DynamicFormId; var vcIds = (long?)eod.DynamicFormDataId;
                        if ((long?)vc == s.GridDropDownDynamicFormID && IsDynamicFormDataGrids == false)
                        {
                            IDictionary<string, object> CheckobjectDataList = new ExpandoObject();
                            if (nameDataLists != null && nameDataLists.Count() > 0)
                            {
                                nameDataLists.ForEach(a =>
                                {
                                    var attrData = a.ApplicationMasterParentCodeId + "_AppMasterPar";
                                    foreach (var item in v)
                                    {
                                        var v1 = item.Key;
                                        var v2 = item.Value;
                                        if (v1 == attrData)
                                        {
                                            long? values = (long?)v2;
                                            if (values > 0)
                                            {
                                                CheckobjectDataList[attrData] = v2;
                                            }
                                        }
                                    }
                                });
                                var objectDataListCount = objectDataList.Count();
                                var CheckobjectDataListCount = CheckobjectDataList.Count();
                                if (objectDataListCount > 0 && CheckobjectDataListCount > 0 && objectDataListCount == CheckobjectDataListCount)
                                {
                                    if (objectDataList.SequenceEqual(CheckobjectDataList))
                                    {
                                        _dynamicformObjectDataIds.Add(vcIds);
                                    }
                                }
                            }
                        }
                    }
                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                    {
                        dynamic eod = v;
                        var IsDynamicFormDataGrids = (bool?)eod.IsDynamicFormDataGrid;
                        var vc = (long?)eod.DynamicFormDataGridId;
                        if (_dynamicformObjectDataIds.Contains(vc) && IsDynamicFormDataGrids == true)
                        {
                            _dynamicformObjectDataList.Add(v);
                        }
                    }
                }
            }

            if (s.IsDynamicFormGridDropdownMultiple == true)
            {
                itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                {
                    editor11.OpenElement(p + 1, "div");
                    editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor11.AddContent(p + 1, s.GridDropDownDynamicFormName);
                    if (s.IsRequired == true)
                    {
                        editor11.OpenElement(p + 1, "span");
                        editor11.AddAttribute(p + 1, "style", "color: red;");
                        editor11.AddContent(p + 1, "(*)");
                        editor11.CloseElement();
                    }
                    editor11.CloseElement();
                    editor11.OpenComponent<DxTagBox<ExpandoObject, long?>>(p + 1);
                    editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                    editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + s.GridDropDownDynamicFormName + "..");
                    editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(p + 1, "Values", valueDataDependency);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(p + 1, "ValuesExpression", lambdapropertyDependency);
                    editor11.AddAttribute(p + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyDependency.SetValue(Data, str); }));
                    if (gridlistss != null)
                    {
                        var gridEditCount = gridlistss.Count();
                        var editFormat = "{0}";
                        for (int e = 0; e < gridEditCount; e++)
                        {
                            if (e == 0)
                            {
                                editFormat = string.Empty;
                            }
                            editFormat += "{" + "" + e + "" + "}|";
                        }
                        editFormat = editFormat.Trim();
                        if (editFormat.EndsWith("|"))
                        {
                            editFormat = editFormat.Remove(editFormat.Length - 1);
                        }
                        editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                    }
                    editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        if (gridlistss != null)
                        {
                            var qCount = 0;
                            gridlistss.ForEach(q =>
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                layoutItemBuilders1.CloseComponent();
                                qCount++;
                            });
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor.AddAttribute(j + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                    }
                                }
                            }

                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null && isSubmit == true)
                        {
                            editor11.OpenElement(p + 1, "span");
                            editor11.AddAttribute(p + 1, "class", "text-danger");
                            editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(p + 1, "span");
                                    editor11.AddAttribute(p + 1, "class", "text-danger");
                                    editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                })));
                itemBuilder.CloseComponent();
            }
            else
            {
                itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                {
                    editor11.OpenElement(p + 1, "div");
                    editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor11.AddContent(p + 1, s.GridDropDownDynamicFormName);
                    if (s.IsRequired == true)
                    {
                        editor11.OpenElement(p + 1, "span");
                        editor11.AddAttribute(p + 1, "style", "color: red;");
                        editor11.AddContent(p + 1, "(*)");
                        editor11.CloseElement();
                    }
                    editor11.CloseElement();
                    editor11.OpenComponent<DxComboBox<ExpandoObject, long?>>(p + 1);
                    editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                    editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + s.GridDropDownDynamicFormName + "..");
                    editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(p + 1, "Value", valueDataDependency);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(p + 1, "ValueExpression", lambdapropertyDependency);
                    editor11.AddAttribute(p + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyDependency.SetValue(Data, str); }));
                    if (gridlistss != null)
                    {
                        var gridEditCount = gridlistss.Count();
                        var editFormat = "{0}";
                        for (int e = 0; e < gridEditCount; e++)
                        {
                            if (e == 0)
                            {
                                editFormat = string.Empty;
                            }
                            editFormat += "{" + "" + e + "" + "}|";
                        }
                        editFormat = editFormat.Trim();
                        if (editFormat.EndsWith("|"))
                        {
                            editFormat = editFormat.Remove(editFormat.Length - 1);
                        }
                        editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                    }
                    editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        if (gridlistss != null)
                        {
                            var qCount = 0;
                            gridlistss.ForEach(q =>
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                layoutItemBuilders1.CloseComponent();
                                qCount++;
                            });
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null && isSubmit == true)
                        {
                            editor11.OpenElement(p + 1, "span");
                            editor11.AddAttribute(p + 1, "class", "text-danger");
                            editor11.AddContent(p + 1, "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                })));
                itemBuilder.CloseComponent();
            }
        }
    }
    void OnApplicationMasterParentChangedMultipleItem(IEnumerable<long?> str, PropertyInfo propertyAppMaster, ApplicationMasterParent ab, DynamicFormSectionAttribute s)
    {
        var pervValue = propertyAppMaster.GetValue(Data);
        List<long?> pervValueData = new List<long?>();
        IEnumerable<long?> preValueDatas = (IEnumerable<long?>)pervValue;
        List<long?> currentValueData = new List<long?>();


        // propertyAppMaster.SetValue(Data, str);
        // List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
        // nameDatas.Add(ab);
        // RemoveApplicationMasterParentSingleAllItem(ab, s, nameDatas);
        // if(nameDatas!=null && nameDatas.Count>0)
        // {
        //     var preData = new List<long?>();
        //     nameDatas.ForEach(n=>
        //     {
        //         var curData = new List<long?>();
        //         List<long?> listDatas=new List<long?>();
        //         var nameData = s.DynamicFormSectionAttributeId + "_" + n.ApplicationMasterParentCodeId + "_AppMasterPar";
        //         var propertyAppMastersData = Data.GetType().GetProperty(nameData);
        //         if (propertyAppMastersData != null)
        //         {
        //             var valueDataAppMastersCurrent = (IEnumerable<long?>)propertyAppMastersData.GetValue(Data);
        //             listDatas = valueDataAppMastersCurrent != null ? valueDataAppMastersCurrent.ToList() : new List<long?>();

        //             var days = ApplicationMasterParentDetails.Where(q => q.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId)).ToList();
        //             var dayss = days.Where(q => listDatas.Contains(q.ParentId)).ToList();
        //             var plts = PlantDependencySubAttributeDetails.Where(w => listDatas.Contains(w.ParentId)).FirstOrDefault()?.ApplicationMasterParentCodeId;
        //             if (plts != null)
        //             {
        //                 var getData = ApplicationMasterParentDetails.Where(w => w.ApplicationMasterParentCodeId == plts).ToList();
        //                 if (getData != null && getData.Count() > 0)
        //                 {
        //                     getData.ForEach(r =>
        //                     {
        //                         var exitsDatas = dayss.Where(w => w.AttributeDetailID == r.AttributeDetailID).Count();
        //                         if (exitsDatas == 0)
        //                         {
        //                             ApplicationMasterParentDetails.ForEach(a =>
        //                             {
        //                                 if (r.AttributeDetailID == a.AttributeDetailID)
        //                                 {
        //                                     a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
        //                                 }
        //                             });
        //                         }
        //                     });
        //                 }
        //             }
        //             else
        //             {
        //                 var pls = PlantDependencySubAttributeDetails.Where(w => w.ApplicationMasterParentCodeId == n.ApplicationMasterParentCodeId).ToList();
        //                 if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
        //                 {
        //                     ApplicationMasterParentDetails.ForEach(a =>
        //                     {
        //                         var exits = pls.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
        //                         if (exits > 0)
        //                         {
        //                             a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
        //                         }
        //                     });
        //                 }
        //                 propertyAppMastersData.SetValue(Data, null);
        //             }
        //             if (listDatas != null && listDatas.Count() > 0)
        //             {
        //                 curData = listDatas;
        //             }
        //             if (preData.Count() > 0)
        //             {
        //                 preData.ForEach(t =>
        //                 {
        //                     loadApplicationMasterParentDataLoad(t, s);
        //                 });
        //             }
        //         }
        //         preData = listDatas;
        //     });
        // }



        //setApplicationMasterParentData(nameDatas, s);
        // if (preValueDatas != null)
        // {
        //     pervValueData = preValueDatas != null ? preValueDatas.ToList() : new List<long?>();
        // }
        if (str != null)
        {
            currentValueData = str != null ? str.ToList() : new List<long?>();
        }
        propertyAppMaster.SetValue(Data, str);
        if (currentValueData != null && currentValueData.Count() > 0)
        {
            currentValueData.ForEach(t =>
            {
                List<string?> nameDatas = new List<string?>();
                var dataList = ApplicationMasterParentDetails.FirstOrDefault(f => f.AttributeDetailID == t);
                if (dataList != null)
                {
                    nameDatas.Add(s.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar");
                    var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == dataList.ApplicationMasterParentCodeId);
                    if (listss != null)
                    {
                        RemoveApplicationMasterParentSingleItem(listss, s, nameDatas);
                    }
                }
                if (nameDatas != null && nameDatas.Count() > 0)
                {
                    int i = 0;
                    nameDatas.ForEach(n =>
                    {
                        var propertyAppMastersData = Data.GetType().GetProperty(n);
                        if (propertyAppMastersData != null)
                        {
                            var valueDataAppMastersCurrent = (IEnumerable<long?>)propertyAppMastersData.GetValue(Data);
                            List<long?> pervValueDatas = valueDataAppMastersCurrent != null ? valueDataAppMastersCurrent.ToList() : new List<long?>();
                            var days = ApplicationMasterParentDetails.Where(q => q.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId)).ToList();
                            var dayss = days.Where(q => pervValueDatas.Contains(q.ParentId)).ToList();
                            var plts = PlantDependencySubAttributeDetails.Where(w => pervValueDatas.Contains(w.ParentId)).FirstOrDefault()?.ApplicationMasterParentCodeId;
                            if (plts != null)
                            {
                                var getData = ApplicationMasterParentDetails.Where(w => w.ApplicationMasterParentCodeId == plts).ToList();
                                if (getData != null && getData.Count() > 0)
                                {
                                    getData.ForEach(r =>
                                    {
                                        var exitsDatas = dayss.Where(w => w.AttributeDetailID == r.AttributeDetailID).Count();
                                        if (exitsDatas == 0)
                                        {
                                            ApplicationMasterParentDetails.ForEach(a =>
                                            {
                                                if (r.AttributeDetailID == a.AttributeDetailID)
                                                {
                                                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                                }
                                            });
                                        }
                                    });
                                }
                            }
                            var j = i + 1;
                            if (nameDatas.Count() > j)
                            {
                                var nextItems = nameDatas[j];
                                if (nextItems != null)
                                {
                                    var propertyAppMastersNext = Data.GetType().GetProperty(nextItems);
                                    if (propertyAppMastersNext != null)
                                    {
                                        List<long?> nextValueData = new List<long?>();
                                        var valueDataAppMastersNext = (IEnumerable<long?>)propertyAppMastersNext.GetValue(Data);
                                        if (valueDataAppMastersNext != null)
                                        {
                                            nextValueData = valueDataAppMastersNext != null ? valueDataAppMastersNext.ToList() : new List<long?>();
                                        }
                                        var Lists1 = dayss != null && dayss.Count() > 0 ? dayss.Select(z => (long?)z.AttributeDetailID).ToList() : new List<long?>();
                                        var soCustomerLists = Lists1.Intersect(nextValueData).ToList();
                                        propertyAppMastersNext.SetValue(Data, soCustomerLists);
                                    }
                                }
                            }

                            if (valueDataAppMastersCurrent != null && PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0)
                            {
                                var plt = PlantDependencySubAttributeDetails.Where(w => valueDataAppMastersCurrent.Contains(w.ParentId)).ToList();
                                if (plt != null && plt.Count() > 0)
                                {
                                    plt.ForEach(a =>
                                    {
                                        var exitss = a.ApplicationMasterParentSectionIds.Where(w => w == s.DynamicFormSectionAttributeId).Count();
                                        if (exitss == 0)
                                        {
                                            a.ApplicationMasterParentSectionIds.Add(s.DynamicFormSectionAttributeId);
                                        }
                                        if (ApplicationMasterParentDetails == null)
                                        {
                                            ApplicationMasterParentDetails = new List<AttributeDetails>();
                                            ApplicationMasterParentDetails.Add(a);
                                        }
                                        else
                                        {
                                            var exitsData = ApplicationMasterParentDetails.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
                                            if (exitsData == 0)
                                            {
                                                ApplicationMasterParentDetails.Add(a);
                                            }
                                        }
                                    });
                                }
                            }
                        }
                        i++;
                    });
                }
            });
        }
        else
        {
            List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                RemoveApplicationMasterParentSingleAllItem(listss, s, nameDatas);
            }
            if (nameDatas != null && nameDatas.Count() > 0)
            {
                int i = 0;
                nameDatas.ForEach(n =>
                {
                    var nameData = s.DynamicFormSectionAttributeId + "_" + n.ApplicationMasterParentCodeId + "_AppMasterPar";
                    var propertyAppMastersData = Data.GetType().GetProperty(nameData);
                    if (propertyAppMastersData != null)
                    {
                        var pls = PlantDependencySubAttributeDetails.Where(w => w.ApplicationMasterParentCodeId == n.ApplicationMasterParentCodeId).ToList();
                        if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
                        {
                            ApplicationMasterParentDetails.ForEach(a =>
                            {
                                var exits = pls.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
                                if (exits > 0)
                                {
                                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                }
                            });
                        }
                        propertyAppMastersData.SetValue(Data, null);
                    }
                });
            }
        }
        if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
        {
            List<DynamicFormSectionAttributeSection> dynamicFormSectionAttributeSections = new List<DynamicFormSectionAttributeSection>();
            dynamicFormSectionAttributeSections = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).ToList();
            if (dynamicFormSectionAttributeSections != null && dynamicFormSectionAttributeSections.Count() > 0)
            {

                dynamicFormSectionAttributeSections.ForEach(r =>
                {
                    dynamicFormSectionAttributeSectionSelected.Remove(r);
                });

            }
        }
        if (str != null && str.Count() > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                str.ToList().ForEach(a =>
                {
                    if (a > 0)
                    {
                        var valuess = "Attr_" + a;
                        if (!string.IsNullOrEmpty(s.DataSourceTable))
                        {
                            valuess = s.DataSourceTable + "_" + a;
                        }
                        var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).ToList();
                        if (valeExits != null && valeExits.Count() > 0)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                });
            }
        }
    }
    void RemoveApplicationMasterParentSingleAllItem(ApplicationMasterParent applicationMasterParent, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<ApplicationMasterParent> nameDatas)
    {
        if (applicationMasterParent != null)
        {
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                nameDatas.Add(listss);
                RemoveApplicationMasterParentSingleAllItem(listss, dynamicFormSectionAttribute, nameDatas);
            }
        }
    }
    void GetApplicationMasterParentListId(long? parentId, List<ApplicationMasterParent> applicationMasterParents)
    {
        var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == parentId);
        if (listss != null)
        {
            applicationMasterParents.Add(listss);
            if (listss.ParentId > 0)
            {
                GetApplicationMasterParentListId(listss.ParentId, applicationMasterParents);
            }
        }
    }
    void GetApplicationMasterParentAllListId(long? applicationMasterParentCodeId, List<ApplicationMasterParent> applicationMasterParents)
    {
        var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParentCodeId);
        if (listss != null)
        {
            applicationMasterParents.Add(listss);
            GetApplicationMasterParentAllListId(listss.ApplicationMasterParentCodeId, applicationMasterParents);

        }
    }
    void OnApplicationMasterParentChangedSingleItem(long? str, PropertyInfo propertyAppMaster, ApplicationMasterParent ab, DynamicFormSectionAttribute s)
    {
        var pervValue = (long?)propertyAppMaster.GetValue(Data);
        propertyAppMaster.SetValue(Data, str);
        if (pervValue != str)
        {
            RemoveloadApplicationMasterParentDataLoad(pervValue, s);
        }
        if (str > 0)
        {
            loadApplicationMasterParentDataLoad(str, s);
        }
        // if (s.DataSourceTable == "ApplicationMasterParent")
        //{
        DynamicFormSectionAttributeSection dynamicFormSectionAttributeSection = new DynamicFormSectionAttributeSection();
        if (str > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var valuess = s.DataSourceTable + "_" + str;
                var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).ToList();
                if (valeExits != null)
                {
                    var exits2 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).ToList();
                    if (exits2 != null && exits2.Count() > 0)
                    {
                        if (exits2 != null && exits2.Count() > 0)
                        {
                            exits2.ForEach(c =>
                            {
                                dynamicFormSectionAttributeSectionSelected.Remove(c);
                            });
                        }
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                    else
                    {
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                }
            }
        }
        else
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var exits1 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == s.DynamicFormSectionAttributeId).ToList();
                if (exits1 != null && exits1.Count() > 0)
                {
                    exits1.ForEach(c =>
                    {
                        dynamicFormSectionAttributeSectionSelected.Remove(c);
                    });
                }
            }
        }
        // }
    }
    void OnRadioAppMasterMultipleChangedItem(IEnumerable<long?> str, PropertyInfo propertyAppMaster, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        propertyAppMaster.SetValue(Data, str);
        if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
        {
            List<DynamicFormSectionAttributeSection> dynamicFormSectionAttributeSections = new List<DynamicFormSectionAttributeSection>();
            dynamicFormSectionAttributeSections = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
            if (dynamicFormSectionAttributeSections != null && dynamicFormSectionAttributeSections.Count() > 0)
            {
                dynamicFormSectionAttributeSections.ForEach(r =>
                {
                    dynamicFormSectionAttributeSectionSelected.Remove(r);
                });

            }
        }
        if (str != null && str.Count() > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                str.ToList().ForEach(a =>
                {
                    if (a > 0)
                    {
                        var valuess = "Attr_" + a;
                        if (!string.IsNullOrEmpty(dynamicFormSectionAttribute.DataSourceTable))
                        {
                            valuess = dynamicFormSectionAttribute.DataSourceTable + "_" + a;
                        }
                        var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                        if (valeExits != null && valeExits.Count() > 0)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                });
            }
        }
    }
    void OnRadioAppMasterChangedItem(long? str, PropertyInfo propertyAppMaster, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        propertyAppMaster.SetValue(Data, str);
        // if (dynamicFormSectionAttribute.DataSourceTable == "ApplicationMaster")
        // {
        DynamicFormSectionAttributeSection dynamicFormSectionAttributeSection = new DynamicFormSectionAttributeSection();
        if (str > 0)
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var valuess = dynamicFormSectionAttribute.DataSourceTable + "_" + str;
                var valeExits = _AttributeHeader.DynamicFormSectionAttributeSections.Where(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                if (valeExits != null)
                {
                    var exits2 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                    if (exits2 != null && exits2.Count() > 0)
                    {
                        if (exits2 != null && exits2.Count() > 0)
                        {
                            exits2.ForEach(c =>
                            {
                                dynamicFormSectionAttributeSectionSelected.Remove(c);
                            });
                        }
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                    else
                    {
                        var exits1 = dynamicFormSectionAttributeSectionSelected.FirstOrDefault(q => q.DynamicFormSectionSelectionById == valuess && q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId);
                        if (exits1 == null)
                        {
                            dynamicFormSectionAttributeSectionSelected.AddRange(valeExits);
                        }
                    }
                }
            }
        }
        else
        {
            if (_AttributeHeader.DynamicFormSectionAttributeSections.Count > 0)
            {
                var exits1 = dynamicFormSectionAttributeSectionSelected.Where(q => q.DynamicFormSectionAttributeId == dynamicFormSectionAttribute.DynamicFormSectionAttributeId).ToList();
                if (exits1 != null && exits1.Count() > 0)
                {
                    exits1.ForEach(c =>
                    {
                        dynamicFormSectionAttributeSectionSelected.Remove(c);
                    });
                }
            }
        }
        // }
    }

    void RemoveloadApplicationMasterParentDataLoad(long? pervValue, DynamicFormSectionAttribute s)
    {
        if (pervValue != null && ApplicationMasterParentDetails != null)
        {
            List<string?> nameDatas = new List<string?>();
            var dataList = ApplicationMasterParentDetails.FirstOrDefault(f => f.AttributeDetailID == pervValue);
            if (dataList != null)
            {
                var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == dataList.ApplicationMasterParentCodeId);
                if (listss != null)
                {
                    RemoveApplicationMasterParentSingleItem(listss, s, nameDatas);
                }
            }
            if (nameDatas != null && nameDatas.Count() > 0)
            {
                nameDatas.ForEach(n =>
                {
                    var propertyAppMasters = Data.GetType().GetProperty(n);
                    if (propertyAppMasters != null)
                    {
                        if (s.ControlType == "ComboBox" || s.ControlType == "ListBox" && s.IsMultiple == false)
                        {
                            var valueDataAppMasters = (long?)propertyAppMasters.GetValue(Data);
                            propertyAppMasters.SetValue(Data, null);
                            if (valueDataAppMasters > 0)
                            {
                                var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == valueDataAppMasters).ToList();
                                if (preList != null && preList.Count() > 0)
                                {
                                    preList.ForEach(a =>
                                    {
                                        a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                    });
                                }
                            }
                        }
                        if (s.ControlType == "TagBox" || s.ControlType == "ListBox" && s.IsMultiple == true)
                        {
                            List<long?> pervValueData = new List<long?>();
                            var valueDataAppMasters = (IEnumerable<long?>)propertyAppMasters.GetValue(Data);
                            if (valueDataAppMasters != null)
                            {
                                pervValueData = valueDataAppMasters != null ? valueDataAppMasters.ToList() : new List<long?>();
                            }
                            pervValueData.ForEach(e =>
                            {
                                if (e > 0)
                                {
                                    var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == e).ToList();
                                    if (preList != null && preList.Count() > 0)
                                    {
                                        preList.ForEach(a =>
                                        {
                                            a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                        });
                                    }
                                }

                            });
                        }
                    }
                });
            }

        }
        if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
        {
            var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == pervValue).ToList();
            if (preList != null && preList.Count() > 0)
            {
                preList.ForEach(a =>
                {
                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                });
            }
        }
    }
    void RemoveApplicationMasterParentSingleItem(ApplicationMasterParent applicationMasterParent, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<string?> nameDatas)
    {
        if (applicationMasterParent != null)
        {
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                nameDatas.Add(dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + listss.ApplicationMasterParentCodeId + "_AppMasterPar");
                RemoveApplicationMasterParentSingleItem(listss, dynamicFormSectionAttribute, nameDatas);
            }
        }
    }
    void loadApplicationMasterParentRecursiveForm(DynamicFormSectionAttribute s, ApplicationMasterParent ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, bool? isLoadDropdown, DynamicFormSection dynamicFormSection)
    {
        int l = 0;
        var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
        var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
        if (propertyAppMaster != null)
        {

            var valueDataAppMaster = propertyAppMaster.GetValue(Data);
            var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
            var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyAppMaster);
            var listDataSub = new List<AttributeDetails>();
            if (isLoadDropdown == true)
            {
                listDataSub = ApplicationMasterParentDetails != null ? ApplicationMasterParentDetails.Where(e => e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId).OrderBy(o => o.AttributeDetailName).ToList() : new List<AttributeDetails>();
            }
            else
            {
                listDataSub = ApplicationMasterParentDetails != null ? ApplicationMasterParentDetails.Where(e => e.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId) && e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId).OrderBy(o => o.AttributeDetailName).ToList() : new List<AttributeDetails>();
            }
            itemBuilder.OpenComponent<DxFormLayoutItem>(3);
            //itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
            itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : s.ColSpan);
            itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
        {
            var exitsNames = _AttributeHeader.ApplicationMasterParent.Where(w => w.ApplicationMasterParentCodeId == ab.ParentId).FirstOrDefault();
            var exitsNamesNext = _AttributeHeader.ApplicationMasterParent.Where(w => w.ApplicationMasterParentCodeId == exitsNames?.ParentId).FirstOrDefault();
            string dummuNos = s.DummyNo.ToString();
            if (exitsNames != null)
            {
                if (exitsNamesNext != null)
                {
                    dummuNos += "." + (exitsNamesNext.DummyNo) + "." + (ab.DummyNo - 1);
                }
                else
                {
                    dummuNos += "." + (exitsNames.DummyNo) + "." + (ab.DummyNo - 1);
                }
            }
            else
            {
                dummuNos += "." + ab.DummyNo;
            }
            editor11.OpenElement(i + 1, "div");
            editor11.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
            //editor11.AddContent(i + 1, s.DummyNo + "." + (exitsNames != null ? (exitsNames?.DummyNo+".") : "") + (ab.DummyNo+1) + " " + ab.ApplicationMasterName);
            editor11.AddContent(i + 1, (dynamicFormSection.IsAutoNumberEnabled == true ? (dummuNos + " ") : "") + ab.ApplicationMasterName);
            if (isPrint == false)
            {
                if (s.IsRequired == true)
                {
                    editor11.OpenElement(i + 1, "span");
                    editor11.AddAttribute(i + 1, "style", "color: red;");
                    editor11.AddContent(i + 1, "(*)");
                    editor11.CloseElement();
                }
                if (!string.IsNullOrEmpty(s.FormToolTips))
                {
                    editor11.OpenElement(i + 1, "i");
                    editor11.AddAttribute(i + 1, "class", "fa fa-info");
                    editor11.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                    editor11.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{appendAppMaster}"));
                    editor11.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(appendAppMaster, s.FormToolTips)));
                    editor11.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                    editor11.AddAttribute(i + 1, "aria-hidden", true);
                    editor11.CloseElement();
                }
            }
            editor11.CloseElement();
            if (s.ControlType == "ComboBox")
            {
                editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "EditFormat", "{0}|{2}");
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                if (isAccessOnly == true)
                {
                    editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                }
                editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnApplicationMasterParentChangedSingleItem(str, propertyAppMaster, ab, s)));
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                {
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders1.AddAttribute(2, "FieldName", "ParentName");
                    layoutItemBuilders1.AddAttribute(2, "Caption", "Parent Name");
                    layoutItemBuilders1.CloseComponent();
                }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                        editor11.CloseElement();
                    }
                }
            }
            if (s.ControlType == "TagBox")
            {
                editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "EditFormat", "{0}|{2}");
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                if (isAccessOnly == true)
                {
                    editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                }
                editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, (str) => OnApplicationMasterParentChangedMultipleItem(str, propertyAppMaster, ab, s)));
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                {
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders1.AddAttribute(2, "FieldName", "ParentName");
                    layoutItemBuilders1.AddAttribute(2, "Caption", "Parent Name");
                    layoutItemBuilders1.CloseComponent();
                }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                        }
                    }
                    else
                    {
                        IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                        if (valueDatas != null)
                        {
                            List<long?> listData = valueDatas.ToList();
                            if (listData.Count() == 0)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, "This field is Required");
                        editor11.CloseElement();
                    }
                    else
                    {
                        IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                        if (valueDatas != null)
                        {
                            List<long?> listData = valueDatas.ToList();
                            if (listData.Count() == 0 && isSubmit == true)
                            {
                                editor11.OpenElement(l + 1, "span");
                                editor11.AddAttribute(l + 1, "class", "text-danger");
                                editor11.AddContent(l + 1, "This field is Required");
                                editor11.CloseElement();
                            }
                        }
                    }
                }
            }
            if (s.ControlType == "ListBox")
            {
                editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                if (s.IsMultiple == true)
                {
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, (str) => OnApplicationMasterParentChangedMultipleItem(str, propertyAppMaster, ab, s)));
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnApplicationMasterParentChangedSingleItem(str, propertyAppMaster, ab, s)));
                }
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "ParentName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Parent Name");
                        layoutItemBuilders.CloseComponent();
                    }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                        }
                    }
                    else
                    {
                        if (s.IsMultiple == true)
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                        editor11.CloseElement();
                    }
                    else
                    {
                        if (s.IsMultiple == true)
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
            }
        })));
            itemBuilder.CloseComponent();

        }

    }
    void loadApplicationMasterForm(DynamicFormSectionAttribute s, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, DynamicFormSection dynamicFormSection)
    {
        var appcount = s.ApplicationMaster.Count();
        int dumNo = 1;
        s.ApplicationMaster.ForEach(ab =>
        {
            ab.DummyNo = dumNo;
            dumNo++;
        });
        s.ApplicationMaster.ForEach(ab =>
        {
            int l = 0;
            var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
            var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
            if (propertyAppMaster != null)
            {
                var valueDataAppMaster = propertyAppMaster.GetValue(Data);
                var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
                var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyAppMaster);
                var listDataSub = PlantDependencySubAttributeDetails != null ? PlantDependencySubAttributeDetails.Where(e => e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterId == ab.ApplicationMasterId).OrderBy(o => o.AttributeDetailName).ToList() : new List<AttributeDetails>();

                itemBuilder.OpenComponent<DxFormLayoutItem>(3);
                //itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : s.ColSpan);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
            {
                editor11.OpenElement(i + 1, "div");
                editor11.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                if (appcount == 1)
                {
                    editor11.AddContent(i + 1, (dynamicFormSection.IsAutoNumberEnabled == true ? (s.DummyNo + "." + ab.DummyNo + " ") : "") + s.DisplayName);
                }
                else
                {
                    editor11.AddContent(i + 1, (dynamicFormSection.IsAutoNumberEnabled == true ? (s.DummyNo + "." + ab.DummyNo + " ") : "") + "Select " + ab.ApplicationMasterName);
                }
                if (isPrint == false)
                {
                    if (s.IsRequired == true)
                    {
                        editor11.OpenElement(i + 1, "span");
                        editor11.AddAttribute(i + 1, "style", "color: red;");
                        editor11.AddContent(i + 1, "(*)");
                        editor11.CloseElement();
                    }
                    if (!string.IsNullOrEmpty(s.FormToolTips))
                    {
                        editor11.OpenElement(i + 1, "i");
                        editor11.AddAttribute(i + 1, "class", "fa fa-info");
                        editor11.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                        editor11.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{appendAppMaster}"));
                        editor11.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(appendAppMaster, s.FormToolTips)));
                        editor11.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                        editor11.AddAttribute(i + 1, "aria-hidden", true);
                        editor11.CloseElement();
                    }
                }
                editor11.CloseElement();
                if (s.ControlType == "ComboBox")
                {
                    editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioAppMasterChangedItem(str, propertyAppMaster, s)));
                    // editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                        if (s.DropDownTypeId == "Data Source")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(2, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                }
                if (s.ControlType == "TagBox")
                {
                    editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, (str) => OnRadioAppMasterMultipleChangedItem(str, propertyAppMaster, s)));
                    //editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                        if (s.DropDownTypeId == "Data Source")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(2, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
                if (s.ControlType == "ListBox")
                {
                    editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                    if (s.IsMultiple == true)
                    {
                        editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                        editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                        editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                            layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                            layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                            layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                            layoutItemBuilders.CloseComponent();
                            if (s.DropDownTypeId == "Data Source")
                            {
                                layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                                layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                                layoutItemBuilders.CloseComponent();
                            }
                        }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            if (s.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0)
                                    {
                                        isRequiredCount += 1;
                                        if (isSubmit == true)
                                        {
                                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                        }
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            if (s.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0 && isSubmit == true)
                                    {
                                        editor11.OpenElement(l + 1, "span");
                                        editor11.AddAttribute(l + 1, "class", "text-danger");
                                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                        editor11.CloseElement();
                                    }
                                }
                            }
                        }
                    }
                }
            })));
                itemBuilder.CloseComponent();
                if (s.ControlTypeId == 2702 && s.DropDownTypeId == "Data Source" && s.DataSourceTable == "ApplicationMaster" && s.IsDynamicFormGridDropdown == true)
                {
                    loadDynamicGridDropDownApplicationMasterNestedForm(s, ab, i, itemBuilder, isAccessOnly, isReadonly);
                }
            }
        });
    }
    void loadDynamicGridDropDownApplicationMasterNestedForm(DynamicFormSectionAttribute s, ApplicationMaster ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        var appendDependency = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_" + s.GridDropDownDynamicFormID + "_GridAppMaster";
        var propertyDependency = Data.GetType().GetProperty(appendDependency);
        if (propertyDependency != null)
        {
            int p = 0;
            var valueDataDependency = propertyDependency.GetValue(Data);
            var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
            Type dataTypess = s.IsDynamicFormGridDropdownMultiple == true ? typeof(IEnumerable<long?>) : typeof(long?);
            var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(dataTypess), accesspropertyDependency);
            List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
            var dynamicFormDatass = _AttributeHeader.DropDownOptionsGridListModel.DynamicFormData.Where(f => f.DynamicFormId == s.GridDropDownDynamicFormID).ToList();
            var dynamicFormDataIds = dynamicFormDatass.FirstOrDefault()?.DynamicFormDataGridFormId;
            gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == (dynamicFormDataIds > 0 ? dynamicFormDataIds : 0)).FirstOrDefault()?.DropDownOptionsModels;
            var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
            List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();

            if (s.ControlTypeId == 2702 && s.DropDownTypeId == "Data Source" && s.DataSourceTable == "ApplicationMaster" && s.IsDynamicFormGridDropdown == true)
            {

                IDictionary<string, object> objectDataList = new ExpandoObject();
                var namesetData = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
                var propertyAppMastersData = Data.GetType().GetProperty(namesetData);
                long? valueDataAppMaster = 0;
                if (propertyAppMastersData != null)
                {
                    valueDataAppMaster = (long?)propertyAppMastersData.GetValue(Data);
                }
                if (valueDataAppMaster != null)
                {
                    objectDataList[ab.ApplicationMasterCodeId + "_AppMaster"] = valueDataAppMaster == null ? 0 : valueDataAppMaster;
                }

                List<long?> _dynamicformObjectDataIds = new List<long?>();
                if (collection != null)
                {
                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                    {
                        dynamic eod = v;
                        var IsDynamicFormDataGrids = (bool?)eod.IsDynamicFormDataGrid;
                        var vc = (long?)eod.DynamicFormId; var vcIds = (long?)eod.DynamicFormDataId;
                        if ((long?)vc == s.GridDropDownDynamicFormID && IsDynamicFormDataGrids == false)
                        {
                            IDictionary<string, object> CheckobjectDataList = new ExpandoObject();
                            var attrData = ab.ApplicationMasterCodeId + "_AppMaster";
                            foreach (var item in v)
                            {
                                var v1 = item.Key;
                                var v2 = item.Value;
                                if (v1 == attrData)
                                {
                                    long? values = (long?)v2;
                                    if (values > 0)
                                    {
                                        CheckobjectDataList[attrData] = v2;
                                    }
                                }
                            }
                            var objectDataListCount = objectDataList.Count();
                            var CheckobjectDataListCount = CheckobjectDataList.Count();
                            if (objectDataListCount > 0 && CheckobjectDataListCount > 0 && objectDataListCount == CheckobjectDataListCount)
                            {
                                if (objectDataList.SequenceEqual(CheckobjectDataList))
                                {
                                    _dynamicformObjectDataIds.Add(vcIds);
                                }
                            }

                        }
                    }
                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                    {
                        dynamic eod = v;
                        var IsDynamicFormDataGrids = (bool?)eod.IsDynamicFormDataGrid;
                        var vc = (long?)eod.DynamicFormDataGridId;
                        if (_dynamicformObjectDataIds.Contains(vc) && IsDynamicFormDataGrids == true)
                        {
                            _dynamicformObjectDataList.Add(v);
                        }
                    }
                }
            }

            if (s.IsDynamicFormGridDropdownMultiple == true)
            {
                itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                {
                    editor11.OpenElement(p + 1, "div");
                    editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor11.AddContent(p + 1, s.GridDropDownDynamicFormName);
                    if (s.IsRequired == true)
                    {
                        editor11.OpenElement(p + 1, "span");
                        editor11.AddAttribute(p + 1, "style", "color: red;");
                        editor11.AddContent(p + 1, "(*)");
                        editor11.CloseElement();
                    }
                    editor11.CloseElement();
                    editor11.OpenComponent<DxTagBox<ExpandoObject, long?>>(p + 1);
                    editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                    editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + s.GridDropDownDynamicFormName + "..");
                    editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(p + 1, "Values", valueDataDependency);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(p + 1, "ValuesExpression", lambdapropertyDependency);
                    editor11.AddAttribute(p + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyDependency.SetValue(Data, str); }));
                    if (gridlistss != null)
                    {
                        var gridEditCount = gridlistss.Count();
                        var editFormat = "{0}";
                        for (int e = 0; e < gridEditCount; e++)
                        {
                            if (e == 0)
                            {
                                editFormat = string.Empty;
                            }
                            editFormat += "{" + "" + e + "" + "}|";
                        }
                        editFormat = editFormat.Trim();
                        if (editFormat.EndsWith("|"))
                        {
                            editFormat = editFormat.Remove(editFormat.Length - 1);
                        }
                        editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                    }
                    editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        if (gridlistss != null)
                        {
                            var qCount = 0;
                            gridlistss.ForEach(q =>
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                layoutItemBuilders1.CloseComponent();
                                qCount++;
                            });
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor.AddAttribute(j + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                    }
                                }
                            }

                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null && isSubmit == true)
                        {
                            editor11.OpenElement(p + 1, "span");
                            editor11.AddAttribute(p + 1, "class", "text-danger");
                            editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataDependency;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(p + 1, "span");
                                    editor11.AddAttribute(p + 1, "class", "text-danger");
                                    editor11.AddContent(p + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                })));
                itemBuilder.CloseComponent();
            }
            else
            {
                itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                // itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
                {
                    editor11.OpenElement(p + 1, "div");
                    editor11.AddAttribute(p + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor11.AddContent(p + 1, s.GridDropDownDynamicFormName);
                    if (s.IsRequired == true)
                    {
                        editor11.OpenElement(p + 1, "span");
                        editor11.AddAttribute(p + 1, "style", "color: red;");
                        editor11.AddContent(p + 1, "(*)");
                        editor11.CloseElement();
                    }
                    editor11.CloseElement();
                    editor11.OpenComponent<DxComboBox<ExpandoObject, long?>>(p + 1);
                    editor11.AddAttribute(p + 1, "Data", _dynamicformObjectDataList);
                    editor11.AddAttribute(p + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(p + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(p + 1, "NullText", isPrint == true ? "" : "Select " + s.GridDropDownDynamicFormName + "..");
                    editor11.AddAttribute(p + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(p + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(p + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(p + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(p + 1, "Value", valueDataDependency);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(p + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(p + 1, "ValueExpression", lambdapropertyDependency);
                    editor11.AddAttribute(p + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyDependency.SetValue(Data, str); }));
                    if (gridlistss != null)
                    {
                        var gridEditCount = gridlistss.Count();
                        var editFormat = "{0}";
                        for (int e = 0; e < gridEditCount; e++)
                        {
                            if (e == 0)
                            {
                                editFormat = string.Empty;
                            }
                            editFormat += "{" + "" + e + "" + "}|";
                        }
                        editFormat = editFormat.Trim();
                        if (editFormat.EndsWith("|"))
                        {
                            editFormat = editFormat.Remove(editFormat.Length - 1);
                        }
                        editor11.AddAttribute(p + 1, "EditFormat", editFormat);
                    }
                    editor11.AddAttribute(p + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        if (gridlistss != null)
                        {
                            var qCount = 0;
                            gridlistss.ForEach(q =>
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(qCount);
                                layoutItemBuilders1.AddAttribute(qCount, "FieldName", q.Value);
                                layoutItemBuilders1.AddAttribute(qCount, "Caption", q.Text);
                                layoutItemBuilders1.CloseComponent();
                                qCount++;
                            });
                        }
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataDependency == null && isSubmit == true)
                        {
                            editor11.OpenElement(p + 1, "span");
                            editor11.AddAttribute(p + 1, "class", "text-danger");
                            editor11.AddContent(p + 1, "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                })));
                itemBuilder.CloseComponent();
            }
        }
    }

    void loadApplicationMasterSubForm(DynamicFormSectionAttribute s, AttributeHeader q, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, DynamicFormSection dynamicFormSection, int? colSpan)
    {
        var appcount = q.SubApplicationMaster.Count();
        int dumNo = 1;
        q.SubApplicationMaster.ForEach(ab =>
        {
            ab.DummyNo = dumNo;
            dumNo++;
        });
        q.SubApplicationMaster.ForEach(ab =>
        {
            int l = 0;
            var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + q.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
            var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
            if (propertyAppMaster != null)
            {
                var valueDataAppMaster = propertyAppMaster.GetValue(Data);
                var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
                var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(q.SubDataType), accesspropertyAppMaster);
                var listSubData = q.SubAttributeDetails != null ? q.SubAttributeDetails.Where(e => e.DropDownTypeId == q.DataSourceTable && e.ApplicationMasterId == ab.ApplicationMasterId).OrderBy(o => o.AttributeDetailName).ToList() : new List<AttributeDetails>();
                itemBuilder.OpenComponent<DxFormLayoutItem>(4);
                // itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : colSpan);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
            {
                editor11.OpenElement(i + 1, "div");
                editor11.AddAttribute(i + 1, "style", "adding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                if (appcount == 1)
                {
                    editor11.AddContent(i + 1, (dynamicFormSection.IsAutoNumberEnabled == true ? (s.DummyNo + "." + q.DummyNo + "." + ab.DummyNo + " ") : "") + q.Description);
                }
                else
                {
                    editor11.AddContent(i + 1, (dynamicFormSection.IsAutoNumberEnabled == true ? (s.DummyNo + "." + q.DummyNo + "." + ab.DummyNo + " ") : "") + ab.ApplicationMasterName);
                }
                editor11.CloseElement();
                if (q.ControlType == "ComboBox")
                {
                    editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    if (q.DataSourceTable == "Employee")
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}|{3}{4}");
                    }
                    else if (q.DataSourceTable == "RawMatPurch")
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}|{2}");
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    }
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                        if (q.DropDownTypeId == "Data Source")
                        {
                            if (q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                            {
                            }
                            else
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
                                layoutItemBuilders1.AddAttribute(2, "Caption", "Company");

                                layoutItemBuilders1.CloseComponent();
                            }
                        }
                        if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(3, "FieldName", "SiteName");
                            layoutItemBuilders1.AddAttribute(3, "Caption", "Site");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(4, "FieldName", "ZoneName");
                            layoutItemBuilders1.AddAttribute(4, "Caption", "Zone");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(5, "FieldName", "LocationName");
                            layoutItemBuilders1.AddAttribute(5, "Caption", "Location");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(6, "FieldName", "AreaName");
                            layoutItemBuilders1.AddAttribute(6, "Caption", "Area");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Employee")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(7, "FieldName", "DesignationName");
                            layoutItemBuilders1.AddAttribute(7, "Caption", "Designation");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "DepartmentName");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Department");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "Description2");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Description2");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(9, "FieldName", "ReplanRefNo");
                            layoutItemBuilders1.AddAttribute(9, "Caption", "Replan RefNo");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(10, "FieldName", "BatchNo");
                            layoutItemBuilders1.AddAttribute(10, "Caption", "Batch No");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(11, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(11, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "RawMatPurch")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "BatchNo");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Batch No");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(9, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(9, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                }
                if (q.ControlType == "TagBox")
                {
                    editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", isPrint == true ? "" : "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "SearchMode", ListSearchMode.AutoSearch);
                    editor11.AddAttribute(l + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    if (q.DataSourceTable == "Employee")
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}|{3}{4}");
                    }
                    else if (q.DataSourceTable == "RawMatPurch")
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}|{2}");
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    }
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                        if (q.DropDownTypeId == "Data Source")
                        {
                            if (q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                            {
                            }
                            else
                            {
                                layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                                layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
                                layoutItemBuilders1.AddAttribute(2, "Caption", "Company");

                                layoutItemBuilders1.CloseComponent();
                            }
                        }
                        if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(3, "FieldName", "SiteName");
                            layoutItemBuilders1.AddAttribute(3, "Caption", "Site");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(4, "FieldName", "ZoneName");
                            layoutItemBuilders1.AddAttribute(4, "Caption", "Zone");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(5, "FieldName", "LocationName");
                            layoutItemBuilders1.AddAttribute(5, "Caption", "Location");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(6, "FieldName", "AreaName");
                            layoutItemBuilders1.AddAttribute(6, "Caption", "Area");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "Employee")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(7, "FieldName", "DesignationName");
                            layoutItemBuilders1.AddAttribute(7, "Caption", "Designation");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "DepartmentName");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Department");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "Description2");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Description2");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(9, "FieldName", "ReplanRefNo");
                            layoutItemBuilders1.AddAttribute(9, "Caption", "Replan RefNo");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(10, "FieldName", "BatchNo");
                            layoutItemBuilders1.AddAttribute(10, "Caption", "Batch No");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(11, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(11, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                        if (q.DataSourceTable == "RawMatPurch")
                        {
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(8, "FieldName", "BatchNo");
                            layoutItemBuilders1.AddAttribute(8, "Caption", "Batch No");
                            layoutItemBuilders1.CloseComponent();
                            layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders1.AddAttribute(9, "FieldName", "CompanyName");
                            layoutItemBuilders1.AddAttribute(9, "Caption", "Company");
                            layoutItemBuilders1.CloseComponent();
                        }
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
                if (q.ControlType == "ListBox")
                {
                    editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    editor11.AddAttribute(i + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                    if (q.IsMultiple == true)
                    {
                        editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                        editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                        editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                        if (q.DropDownTypeId == "Data Source")
                        {
                            if (q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                            {
                            }
                            else
                            {
                                layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                                layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                                layoutItemBuilders.AddAttribute(2, "Caption", "Company");

                                layoutItemBuilders.CloseComponent();
                            }
                        }
                        if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                            layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                            layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                            layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "SpecificArea")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                            layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "Employee")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                            layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                            layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                            layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                        if (q.DataSourceTable == "RawMatPurch")
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                            layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(9, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(9, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0)
                                    {
                                        isRequiredCount += 1;
                                        if (isSubmit == true)
                                        {
                                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                        }
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0 && isSubmit == true)
                                    {
                                        editor11.OpenElement(l + 1, "span");
                                        editor11.AddAttribute(l + 1, "class", "text-danger");
                                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                        editor11.CloseElement();
                                    }
                                }
                            }
                        }
                    }
                }
            })));
                itemBuilder.CloseComponent();

            }
        });
    }
    private Dictionary<string, bool> ExpandStates = new();
    private void ToggleExpand(string key)
    {
        if (ExpandStates.ContainsKey(key))
            ExpandStates[key] = !ExpandStates[key];
        else
            ExpandStates[key] = true;

        StateHasChanged();
    }
    void loadGroupCheckBox(DynamicFormSectionAttribute a, List<AttributeGroupCheckBox> attributeGroupCheckBoxes, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder editor, int j, DynamicFormSection dynamicFormSection, bool? isReadonly, bool? isAccessOnly)
    {
        var lookup = attributeGroupCheckBoxes.ToLookup(x => x.ParentId);
        Func<long?, List<AttributeGroupCheckBox>> build = null;
        build = pid =>
            lookup[pid]
                .Select(x => new AttributeGroupCheckBox()
                {
                    AttributeGroupCheckBoxId = x.AttributeGroupCheckBoxId,
                    Value = x.Value,
                    ParentId = x.ParentId,
                    Description = x.Description,
                    IsDeleted = x.IsDeleted,
                    AttributeId = x.AttributeId,
                    Checked = x.Checked,
                    IsTextBox = x.IsTextBox,
                    SubAttributeHeaders = x.SubAttributeHeaders,
                    Children = build(x.AttributeGroupCheckBoxId),

                })
                .ToList();
        var nestedlist = build(null).ToList();
        int index = 1;
        foreach (var item in nestedlist)
        {
            RenderComplaintItem(item, a, dynamicFormSection, j, editor, index.ToString(), isReadonly, isAccessOnly, true);
            index++;
        }
    }
    void RenderComplaintItem(AttributeGroupCheckBox item, DynamicFormSectionAttribute a, DynamicFormSection dynamicFormSection, int indent, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder builder, string numberPrefix = "", bool? isReadonly = false, bool? isAccessOnly = false, bool? IsNested = false, bool? isVisible = true)
    {
        int seq = 0;

        builder.OpenElement(seq++, "div");
        builder.AddAttribute(seq++, "class", "mb-1");
        builder.AddAttribute(seq++, "style", $"padding-left: {indent}px;");

        var appendAppMaster = $"{a.DynamicFormSectionAttributeId}_{item.AttributeId}_{item.AttributeGroupCheckBoxId}_GroupCheckBox";
        var propertyCheck = Data.GetType().GetProperty(appendAppMaster);

        if (item.IsTextBox == false)
        {
            var valueDataAppMaster = propertyCheck.GetValue(Data);
            var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
            var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(bool?)), accesspropertyAppMaster);

            builder.OpenComponent<DxCheckBox<bool?>>(seq++);
            builder.AddAttribute(seq++, "Checked", valueDataAppMaster ?? false);
            builder.AddAttribute(seq++, "CheckedExpression", lambdapropertyAppMaster);
            builder.AddAttribute(seq++, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, val => propertyCheck.SetValue(Data, val)));
            builder.AddAttribute(seq++, "ChildContent", (RenderFragment)((b) =>
            {
                b.OpenElement(seq++, "span");
                b.AddAttribute(seq++, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                if (IsNested == true)
                {
                    b.AddContent(seq++, $"{numberPrefix}. {item.Value}");
                }
                else
                {
                    b.AddContent(seq++, $"{numberPrefix} {item.Value}");
                }
                b.CloseElement();
            }));
            builder.CloseComponent();
        }

        if (item.IsTextBox == true && isVisible == true)
        {

            // var valueDataAppMaster = propertyCheck.GetValue(Data);
            // var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
            // var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(string)), accesspropertyAppMaster);

            builder.OpenElement(seq++, "div");
            builder.AddAttribute(seq++, "class", "align-items-center gap-2");

            builder.OpenElement(seq++, "label");
            builder.AddAttribute(seq++, "style", "min-width: 150px;");
            builder.AddContent(seq++, $"{numberPrefix} {item.Value}");
            builder.CloseElement();
            loadGroupCheckBoxSubForm(item.SubAttributeHeaders, indent, a, builder, dynamicFormSection, isReadonly, isAccessOnly);
            // builder.OpenComponent<DxMemo>(seq++);
            // builder.AddAttribute(seq++, "Text", valueDataAppMaster);
            // builder.AddAttribute(seq++, "TextExpression", lambdapropertyAppMaster);
            // builder.AddAttribute(seq++, "TextChanged", EventCallback.Factory.Create<string>(this, val => propertyCheck.SetValue(Data, val)));
            // builder.AddAttribute(seq++, "style", "margin-top:10px;");
            // builder.AddAttribute(seq++, "Rows", 5);
            // builder.CloseComponent();

            builder.CloseElement();
        }

        builder.CloseElement(); // container div

        // 🔁 Render children with recursive numbering
        if (item.Children?.Any() == true)
        {
            builder.OpenElement(seq++, "div");
            builder.AddAttribute(seq++, "class", "d-flex flex-wrap gap-2 ms-4 mb-2");

            for (int i = 0; i < item.Children.Count; i++)
            {
                var child = item.Children[i];
                //$"{parentNumbering}.{childIndex}";
                // Correct numbering here
                string childNumber = string.IsNullOrEmpty(numberPrefix) ? $"{i + 1}" : $"{numberPrefix}.{i + 1}";

                var appendAppData = $"{a.DynamicFormSectionAttributeId}_{child.AttributeId}_{item.AttributeGroupCheckBoxId}_GroupCheckBox";
                var propertyChecks = Data.GetType().GetProperty(appendAppData);
                var valueData = (bool?)propertyChecks?.GetValue(Data);

                builder.OpenElement(seq++, "div");
                builder.AddAttribute(seq++, "style", child.IsTextBox == true ? "flex: 0 0 100%;" : "flex: 0 0 calc(33.33% - 10px);");
                RenderComplaintItem(child, a, dynamicFormSection, indent + 20, builder, childNumber, isReadonly, isAccessOnly, false, valueData ?? false);
                builder.CloseElement();
            }

            builder.CloseElement(); // close child container
        }
    }
    void loadGroupCheckBoxSubForm(List<AttributeHeader> SubAttributeHeadersList, int i, DynamicFormSectionAttribute s, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, DynamicFormSection a, bool? isReadonly, bool? isAccessOnly)
    {
        SubAttributeHeadersList.ForEach(q =>
            {
                int m = 0;
                var appendProSubNames = s.DynamicFormSectionAttributeId + "_" + q.SubDynamicAttributeName;
                var subaatrDetails = q.SubAttributeDetails;
                var exitsFilter = _attributeFilterDetailsList.Where(f => f.AttributeName == appendProSubNames && f.DataSourceName == q.DataSourceTable).FirstOrDefault();
                if (exitsFilter == null)
                {
                }
                else
                {
                    subaatrDetails = exitsFilter.AttributeDetails.ToList();
                }
                if (q.DataSourceTable == "ApplicationMaster")
                {
                    if (q.SubApplicationMaster != null && q.SubApplicationMaster.Count() > 0)
                    {
                        loadApplicationMasterSubForm(s, q, i, itemBuilder, isAccessOnly, isReadonly, a, 6);
                    }
                }
                else if (q.DataSourceTable == "ApplicationMasterParent")
                {
                    if (q.SubApplicationMasterParent != null && q.SubApplicationMasterParent.Count() > 0)
                    {
                        //loadApplicationMasterParentSubForm(s, q, i, itemBuilder, isAccessOnly, isReadonly);
                    }
                }
                else
                {
                    var propertySub = Data.GetType().GetProperty(appendProSubNames);
                    if (propertySub != null)
                    {
                        itemBuilder.OpenComponent<DxFormLayoutItem>(2);
                        //itemBuilder.AddAttribute(i++, "Caption", q.Description);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", isPrint == true ? 12 : 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context1) => ((editor1) =>
                {
                    editor1.OpenElement(i + 1, "div");
                    editor1.AddAttribute(i + 1, "style", "padding:2px;font-weight:400;color:rgba(33, 37, 41, 0.75);");
                    editor1.AddContent(i + 1, (a.IsAutoNumberEnabled == true ? (s.DummyNo + "." + q.DummyNo + " ") : "") + q.Description);
                    if (isPrint == false)
                    {
                        if (q.IsRequired == true)
                        {
                            editor1.OpenElement(i + 1, "span");
                            editor1.AddAttribute(i + 1, "style", "color: red;");
                            editor1.AddContent(i + 1, "(*)");
                            editor1.CloseElement();
                        }
                        if (!string.IsNullOrEmpty(q.AttrDescription))
                        {
                            editor1.OpenElement(i + 1, "i");
                            editor1.AddAttribute(i + 1, "class", "fa fa-info");
                            editor1.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                            editor1.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-TooltipInfo-{appendProSubNames}"));
                            editor1.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnTooltipsClick(appendProSubNames, q.AttrDescription)));
                            editor1.AddAttribute(i + 1, "title", "Click Here Show Tooltips");
                            editor1.AddAttribute(i + 1, "aria-hidden", true);
                            editor1.CloseElement();
                        }
                        var FilterExits = _AttributeHeader.AttributeHeaderDataSource.Where(o => o.DataSourceTable == q.DataSourceTable).FirstOrDefault()?.IsDynamicFormFilterBy;
                        if (FilterExits != null && FilterExits > 0)
                        {
                            editor1.OpenElement(i + 1, "i");
                            editor1.AddAttribute(i + 1, "class", "fa fa-filter");
                            editor1.AddAttribute(i + 1, "style", "color: black;margin-left: 10px;cursor: pointer;");
                            editor1.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnDynamicFormFilterBypopup(appendProSubNames, a, s, q.DataSourceTable)));
                            editor1.AddAttribute(i + 1, "title", "Click Here Filter");
                            editor1.AddAttribute(i + 1, "aria-hidden", true);
                            editor1.CloseElement();
                        }
                    }
                    editor1.CloseElement();
                    var valueDataSub = propertySub.GetValue(Data);
                    var accessSub = Expression.Property(Expression.Constant(Data), appendProSubNames);
                    var lambdaSub = Expression.Lambda(typeof(Func<>).MakeGenericType(q.SubDataType), accessSub);
                    var propertySubType = Nullable.GetUnderlyingType(propertySub.PropertyType) ?? propertySub.PropertyType;
                    if (q.ControlType == "TextBox")
                    {
                        editor1.OpenComponent<DxTextBox>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    // editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    if (q.ControlType == "QR Code")
                    {
                        editor1.OpenComponent<DxTextBox>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        editor1.AddAttribute(m + 1, "Buttons", (RenderFragment)((dx) =>
                        {
                            dx.OpenComponent<DxEditorButton>(m + 1);
                            dx.AddAttribute(m + 1, "IconCssClass", "fa fa-qrcode");
                            dx.AddAttribute(m + 1, "Tooltip", "Scan Qr Code");
                            dx.AddAttribute(m + 1, "Click", EventCallback.Factory.Create<MouseEventArgs>(this, str => OnButtonQrCodeClick(str, propertySub)));
                            dx.CloseComponent();
                        }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    // editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "Memo")
                    {
                        editor1.OpenComponent<DxMemo>(m + 1);
                        editor1.AddAttribute(m + 1, "Text", valueDataSub);
                        editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "Rows", 5);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub))
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "DateEdit")
                    {
                        editor1.OpenComponent<DxDateEdit<DateTime?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Date", valueDataSub);
                        editor1.AddAttribute(m + 1, "DateExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "DateChanged", EventCallback.Factory.Create<System.DateTime?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "TimeEdit")
                    {
                        editor1.OpenComponent<DxTimeEdit<TimeSpan?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Time", valueDataSub);
                        editor1.AddAttribute(m + 1, "TimeExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "TimeChanged", EventCallback.Factory.Create<System.TimeSpan?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "SpinEdit")
                    {
                        if (propertySubType.Name == "Int32")
                        {
                            editor1.OpenComponent<DxSpinEdit<int?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            //editor1.AddAttribute(m + 1, "MinValue", 0);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "BindValueMode", BindValueMode.OnInput);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<int?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        if (propertySubType.Name == "Decimal")
                        {
                            editor1.OpenComponent<DxSpinEdit<decimal?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            editor1.AddAttribute(m + 1, "Increment", 0.1M);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            //editor1.AddAttribute(m + 1, "MinValue", 0M);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<decimal?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "CheckBox")
                    {
                        editor1.OpenComponent<DxCheckBox<bool?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Checked", valueDataSub ?? false);
                        editor1.AddAttribute(m + 1, "CheckedExpression", lambdaSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        //editor1.AddAttribute(i+1, "LabelPosition", LabelPosition.Right);
                        editor1.AddAttribute(m + 1, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, str => { propertySub.SetValue(Data, str); }));
                        if (s.IsRequired == true)
                        {
                            if (valueDataSub == null || (bool)valueDataSub == false)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null || (bool)valueDataSub == false && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "RadioGroup" || q.ControlType == "Radio")
                    {
                        editor1.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Items", subaatrDetails);
                        editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                        editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                        editor1.AddAttribute(m + 1, "Value", valueDataSub);
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "Layout", q.AttributeRadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                        editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                        editor1.AddAttribute(m + 1, "style", "margin-left:25px;");
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    editor1.AddAttribute(m + 1, "style", "color:red;");
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                        }
                    }
                    else if (q.ControlType == "ComboBox")
                    {
                        if (q.DataSourceTable == "DynamicGrid")
                        {
                            //var gridOb=s.DynamicFormSectionAttributeId + "_" + q.AttributeID + "_DynamicGrid";
                            string DataDynamicAttributeName = appendProSubNames;
                            var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                            if (propertyMain != null)
                            {
                                var values = (long?)propertyMain.GetValue(Data);
                                List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == q.DynamicFormId).FirstOrDefault()?.DropDownOptionsModels;
                                var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                if (collection != null)
                                {
                                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                    {
                                        dynamic eod = v;
                                        var vv = eod.DynamicFormId;
                                        var AttributeDetailIds = eod.AttributeDetailID;
                                        string listone = string.Empty;
                                        if (gridlistss != null && gridlistss.Count() > 0)
                                        {
                                            var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                            g1.ForEach(q =>
                                                    {
                                                        var byName = (IDictionary<string, object>)v;
                                                        if (q.Value != null)
                                                        {
                                                            if (byName.ContainsKey(q.Value))
                                                            {
                                                                var names = (string)byName[q.Value]?.ToString();
                                                                listone += names + "|";
                                                            }
                                                        }
                                                    });
                                        }
                                        eod.DisplayItemsQuery = listone;
                                        if ((long?)vv == q.DynamicFormId)
                                        {
                                            _dynamicformObjectDataList.Add(eod);
                                        }
                                        if (values > 0)
                                        {
                                            if ((long?)values == (long?)AttributeDetailIds)
                                            {
                                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, eod);
                                            }
                                        }
                                    }

                                }


                                var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);
                                editor1.OpenComponent<DxDropDownBox>(0);
                                editor1.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                editor1.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                                editor1.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                editor1.AddAttribute(4, "QueryDisplayText", q.DataSourceTable == "DynamicGrid" ? QueryDisplayDynamicComboBoxText : QueryDisplayComboBoxText);
                                editor1.AddAttribute(5, "CssClass", "cw-480");
                                editor1.AddAttribute(6, "Value", GridvalueData);
                                if (isAccessOnly == true)
                                {
                                    editor1.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                }
                                else
                                {
                                    editor1.AddAttribute(8, "Enabled", isAccessOnly);
                                }
                                editor1.AddAttribute(9, "DropDownVisible", false);
                                editor1.AddAttribute(10, "ValueExpression", Gridlambda);
                                editor1.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnGridValueChanged(str, DataDynamicAttributeName, q.DataSourceTable, Data, DataGridObject, propertyMain, subaatrDetails, a, s)));
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                            }
                                        }
                                    }
                                }
                                _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor1, _DropDownBoxGridModel, GridDropBoxData, q.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, subaatrDetails, false);
                                editor1.CloseComponent();
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null && isSubmit == true)
                                        {
                                            editor1.OpenElement(13, "span");
                                            editor1.AddAttribute(14, "class", "text-danger");
                                            editor1.AddContent(15, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            editor1.OpenComponent<DxComboBox<AttributeDetails, long?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                            if (q.DataSourceTable == "Employee")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{3}{4}");
                            }
                            else if (q.DataSourceTable == "RawMatPurch")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{2}");
                            }
                            else if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                            }
                            editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                            editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                            editor1.AddAttribute(m + 1, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                            editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor1.AddAttribute(m + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor1.AddAttribute(m + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                            editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();
                    if (q.DataSourceTable != "SOP")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DropDownTypeId == "Data Source")
                    {
                        if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                        {
                        }
                        else
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                            layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                            layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                            layoutItemBuilders.CloseComponent();
                        }
                    }
                    if (q.DataSourceTable == "NavMethodCode")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                        layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                        layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                        layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                        layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                        layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                        layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "SpecificArea")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                        layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "SOP")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                        layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "Employee")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                        layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                        layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                        layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                    if (q.DataSourceTable == "RawMatPurch")
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                        layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                        layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }));
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                            editor1.CloseComponent();
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null && isSubmit == true)
                                {
                                    editor1.OpenElement(m + 1, "span");
                                    editor1.AddAttribute(m + 1, "class", "text-danger");
                                    editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor1.CloseElement();
                                }
                            }
                        }
                    }

                    else if (q.ControlType == "TagBox")
                    {
                        if (q.DataSourceTable == "DynamicGrid")
                        {
                            string DataDynamicAttributeName = appendProSubNames;
                            var propertyMain = Data.GetType().GetProperty(DataDynamicAttributeName);
                            if (propertyMain != null)
                            {
                                DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, null);
                                var listData = propertyMain.GetValue(Data);
                                IEnumerable<long?> valueDatas1 = (IEnumerable<long?>)listData;
                                List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                                List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                                gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == q.DynamicFormId).FirstOrDefault()?.DropDownOptionsModels;
                                var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                                List<long?> listDatas = new List<long?>();
                                if (valueDatas1 != null)
                                {
                                    listDatas = valueDatas1.ToList();
                                }
                                if (collection != null)
                                {
                                    List<ExpandoObject>? _selecteddynamicformObjectDataList = new List<ExpandoObject>();
                                    foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                    {
                                        dynamic eod = v;
                                        var vv = eod.DynamicFormId;
                                        string listone = string.Empty;
                                        if (gridlistss != null && gridlistss.Count() > 0)
                                        {
                                            var g1 = gridlistss.OrderBy(o => o.OrderBy).ToList();
                                            g1.ForEach(q =>
                                                {
                                                    var byName = (IDictionary<string, object>)v;
                                                    if (q.Value != null)
                                                    {
                                                        if (byName.ContainsKey(q.Value))
                                                        {
                                                            var names = (string)byName[q.Value]?.ToString();
                                                            listone += names + "|";
                                                        }
                                                    }
                                                });
                                        }
                                        eod.DisplayItemsQuery = listone;
                                        if ((long?)vv == q.DynamicFormId)
                                        {
                                            _dynamicformObjectDataList.Add(eod);
                                        }
                                        var AttributeDetailIds = eod.AttributeDetailID;
                                        if (listDatas.Contains((long?)AttributeDetailIds))
                                        {
                                            _selecteddynamicformObjectDataList.Add(eod);
                                        }
                                    }

                                    DataGridObject.GetType().GetProperty(DataDynamicAttributeName).SetValue(DataGridObject, _selecteddynamicformObjectDataList.Count() > 0 ? _selecteddynamicformObjectDataList : null);
                                }



                                var Gridaccess = Expression.Property(Expression.Constant(DataGridObject), DataDynamicAttributeName);
                                var Gridlambda = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(object)), Gridaccess);
                                var Gridproperty = DataGridObject.GetType().GetProperty(DataDynamicAttributeName);
                                var GridvalueData = Gridproperty.GetValue(DataGridObject);
                                var GridDropBoxData = _DropDownBoxGridModel.FirstOrDefault(f => f.AttrName == DataDynamicAttributeName);

                                editor1.OpenComponent<DxDropDownBox>(0);
                                editor1.AddAttribute(1, "DropDownWidthMode", DropDownWidthMode.EditorWidth);
                                editor1.AddAttribute(2, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                                editor1.AddAttribute(3, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                                editor1.AddAttribute(4, "QueryDisplayText", q.DataSourceTable == "DynamicGrid" ? QueryMultipleDynamicFormText : QueryMultipleText);
                                editor1.AddAttribute(5, "CssClass", "cw-480");
                                editor1.AddAttribute(6, "Value", GridvalueData);
                                if (isAccessOnly == true)
                                {
                                    editor1.AddAttribute(7, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                                }
                                else
                                {
                                    editor1.AddAttribute(8, "Enabled", isAccessOnly);
                                }
                                editor1.AddAttribute(9, "DropDownVisible", false);
                                editor1.AddAttribute(10, "ValueExpression", Gridlambda);
                                editor1.AddAttribute(11, "ValueChanged", EventCallback.Factory.Create<object>(this, str => OnMultipleValueChanged(str, DataDynamicAttributeName, q.DataSourceTable, Data, DataGridObject, propertyMain, subaatrDetails, a, s)));

                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true)
                                    {
                                        if (valueDataSub == null)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                            }
                                        }
                                        else
                                        {
                                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                            if (valueDatas != null)
                                            {
                                                List<long?> listData1 = valueDatas.ToList();
                                                if (listData1.Count() == 0)
                                                {
                                                    isRequiredCount += 1;
                                                    if (isSubmit == true)
                                                    {
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                _LoadDataGridDynamicForm.CreateDropDownBodyTemplateGrid(editor1, _DropDownBoxGridModel, GridDropBoxData, q.DataSourceTable, DataDynamicAttributeName, gridlistss, _dynamicformObjectDataList, subaatrDetails, true);

                                editor1.CloseComponent();
                                if (s.IsDefaultReadOnly == false)
                                {
                                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                                    {
                                        if (valueDataSub == null && isSubmit == true)
                                        {
                                            editor1.OpenElement(12, "span");
                                            editor1.AddAttribute(13, "class", "text-danger");
                                            editor1.AddContent(14, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                        else
                                        {
                                            IEnumerable<long?> valueDatas2 = (IEnumerable<long?>)valueDataSub;
                                            if (valueDatas2 != null)
                                            {
                                                List<long?> listData2 = valueDatas2.ToList();
                                                if (listData2.Count() == 0 && isSubmit == true)
                                                {
                                                    editor1.OpenElement(15, "span");
                                                    editor1.AddAttribute(16, "class", "text-danger");
                                                    editor1.AddContent(17, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                                    editor1.CloseElement();
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            editor1.OpenComponent<DxTagBox<AttributeDetails, long?>>(m + 1);
                            editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                            if (q.DataSourceTable == "Employee")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{3}{4}");
                            }
                            else if (q.DataSourceTable == "RawMatPurch")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{2}");
                            }
                            else if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}|{4}|{5}");
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                            }
                            editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                            editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                            editor1.AddAttribute(m + 1, "NullText", isPrint == true ? "" : "Select " + q.Description + "..");
                            editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                            editor1.AddAttribute(m + 1, "SearchMode", ListSearchMode.AutoSearch);
                            editor1.AddAttribute(m + 1, "SearchFilterCondition", ListSearchFilterCondition.Contains);
                            editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", isPrint == true ? DataEditorClearButtonDisplayMode.Never : DataEditorClearButtonDisplayMode.Auto);
                            editor1.AddAttribute(m + 1, "Values", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                            if (isAccessOnly == true)
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                            }
                            else
                            {
                                editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                            }
                            editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                            editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
            {
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                layoutItemBuilders.CloseComponent();
                if (q.DataSourceTable != "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DropDownTypeId == "Data Source")
                {
                    if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                    }
                    else
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }
                if (q.DataSourceTable == "NavMethodCode")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Employee")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "FinishedProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                    layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "RawMatPurch")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
            }));
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                            }
                                        }
                                    }
                                }
                            }
                            editor1.CloseComponent();
                            if (q.IsRequired == true)
                            {
                                if (valueDataSub == null && isSubmit == true)
                                {
                                    editor1.OpenElement(m + 1, "span");
                                    editor1.AddAttribute(m + 1, "class", "text-danger");
                                    editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor1.CloseElement();
                                }
                                else
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0 && isSubmit == true)
                                        {
                                            editor1.OpenElement(m + 1, "span");
                                            editor1.AddAttribute(m + 1, "class", "text-danger");
                                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }
                    }
                    else if (q.ControlType == "ListBox")
                    {
                        editor1.OpenComponent<DxListBox<AttributeDetails, long?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Data", subaatrDetails);
                        editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                        editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                        if (isAccessOnly == true)
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Enabled", isAccessOnly);
                        }
                        editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                        editor1.AddAttribute(m + 1, "ShowCheckboxes", true);
                        if (q.IsMultiple == true)
                        {
                            editor1.AddAttribute(m + 1, "Values", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                            editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        else
                        {
                            editor1.AddAttribute(m + 1, "Value", valueDataSub);
                            editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                            editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Single);
                            editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                        }
                        editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
            {
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                layoutItemBuilders.CloseComponent();
                if (q.DataSourceTable != "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DropDownTypeId == "Data Source")
                {
                    if (q.DataSourceTable == "NavMethodCode" || q.DataSourceTable == "SOP" || q.DataSourceTable == "AllProdOrderLine" || q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "RawMatPurch" || q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                    {
                    }
                    else
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Company");
                        layoutItemBuilders.CloseComponent();
                    }
                }
                if (q.DataSourceTable == "NavMethodCode")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "AvailableBatchSize");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Available Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "DefaultBatchSize");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Default Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "BatchUnitSize");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Batch Size Unit");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Zone" || q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "SiteName");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Site");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Location" || q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "ZoneName");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Zone");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Area" || q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "LocationName");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Location");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SpecificArea")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(6, "FieldName", "AreaName");
                    layoutItemBuilders.AddAttribute(6, "Caption", "Area");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "SOP")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "ProfileNo");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Profile No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "VersionNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "VersionNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "EffectiveDate");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Effective Date");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "ReviewDate");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Review Date");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "Employee")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(7, "FieldName", "DesignationName");
                    layoutItemBuilders.AddAttribute(7, "Caption", "Designation");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "DepartmentName");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Department");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "FinishedProdOrderLine" || q.DataSourceTable == "FinishedProdOrderLineProductionInProgress")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "ReleaseProdOrderLine" || q.DataSourceTable == "AllProdOrderLine")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "Description2");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Description2");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(13, "FieldName", "ProdOrderNo");
                    layoutItemBuilders.AddAttribute(13, "Caption", "ProdOrderNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "ReplanRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "Replan RefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(11, "FieldName", "BatchSize");
                    layoutItemBuilders.AddAttribute(11, "Caption", "Batch Size");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(12, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(12, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
                if (q.DataSourceTable == "RawMatPurch")
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(8, "FieldName", "BatchNo");
                    layoutItemBuilders.AddAttribute(8, "Caption", "Batch No");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(9, "FieldName", "QcRefNo");
                    layoutItemBuilders.AddAttribute(9, "Caption", "QcRefNo");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(10, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(10, "Caption", "Company");
                    layoutItemBuilders.CloseComponent();
                }
            }));
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                            else
                            {
                                if (q.IsMultiple == true)
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0)
                                        {
                                            isRequiredCount += 1;
                                            if (isSubmit == true)
                                            {
                                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        editor1.CloseComponent();
                        if (q.IsRequired == true)
                        {
                            if (valueDataSub == null && isSubmit == true)
                            {
                                editor1.OpenElement(m + 1, "span");
                                editor1.AddAttribute(m + 1, "class", "text-danger");
                                editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                editor1.CloseElement();
                            }
                            else
                            {
                                if (q.IsMultiple == true)
                                {
                                    IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                    if (valueDatas != null)
                                    {
                                        List<long?> listData = valueDatas.ToList();
                                        if (listData.Count() == 0 && isSubmit == true)
                                        {
                                            editor1.OpenElement(m + 1, "span");
                                            editor1.AddAttribute(m + 1, "class", "text-danger");
                                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                            editor1.CloseElement();
                                        }
                                    }
                                }
                            }
                        }

                    }
                })));
                        itemBuilder.CloseComponent();
                    }
                }
            });
    }

}


