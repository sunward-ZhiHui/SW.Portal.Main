@using System.ComponentModel.DataAnnotations;
@using Newtonsoft.Json.Linq;
@using global::Core.AttributeDynamicData;
@using global::Core.Entities.Views;
@using global::Core.Entities;
@using Application.Queries;
@inject IMediator Mediator
@using MediatR
@using global::Core.EntityModels;
@using global::Core.Repositories.Query;
@inject AC.SD.Core.Services.ToastService toastService
@inject ILocalStorageService<ApplicationUser> _localStorageService
@inject IJSRuntime JSRuntime;
@inject NavigationManager NavigationManager
@using global::Core.Helpers;
@using System.Reflection;
@using System.Linq.Expressions;
@using Newtonsoft.Json;
@using System.Dynamic;
@implements IDisposable
@*     <DxLoadingPanel @bind-Visible="PanelVisible"
                    IsContentBlocked="true"
                    ApplyBackgroundShading="true"
                    IndicatorAreaVisible="false"
                    Text="Fetching Data..."> *@
<style>
    .my-style {
        <!-- your CSS rules -->
    }

    .my-style-captionw {
        text-align: right;
    }
</style>
<div class="card cw-480" style=" height: calc(100vh - 100px); overflow: auto; overflow-x: hidden;">
    <div class="card-header text-center py-3">
        <h4>@_dynamicform?.Name</h4>
        @*  <p class="tm-8 mb-0 fw-normal fs-825">
        Create a new account to see it in action
        </p> *@
    </div>
    <div class="card" style="margin-top: 5px;padding: 5px;">
        <div class="card-body p-0">
            <div class="row">
                <div class="">

                    @if (isApprovalEnabled == true)
                    {
                        <DxMenu CollapseItemsToHamburgerMenu="true"
                                CollapseItemToIconMode="MenuCollapseItemToIconMode.Sequentially"
                                DisplayMode="MenuDisplayMode.Desktop">
                            <Items>
                                <DxMenuItem Text="Back" IconCssClass="fa fa-reply" Click="@backUrl" />
                                <DxMenuItem Text="Add" IconCssClass="fa fa-add" Click="@addNew" Enabled="@AddEnabled" />

                                <DxMenuItem Text="Save">
                                    <Items>
                                        <DxMenuItem Text="Save/Before Approval" IconCssClass="fa fa-save" Click="SubmitFormExternally" Enabled=@isVisibleButton />
                                        <DxMenuItem Text="Send Approval" IconCssClass="fa fa-plus-circle" Click="SubmitApproveFormExternally" Enabled="IsSendApprovalVisible" />
                                    </Items>
                                </DxMenuItem>
                                <DxMenuItem Text="Approval" id=@($"flyout-overview-target-container-Description")>
                                    <Items>
                                        <DxMenuItem Text="@ApproveName" IconCssClass="fa fa-check" Click="onClickApprove" Enabled=@IsApprovalApproved />
                                        <DxMenuItem Text="@RejectName" IconCssClass="fa fa-ban" Click="onClickReject" Enabled="IsApprovalRejected" />
                                    </Items>
                                </DxMenuItem>
                                <DxMenuItem Text="Upload" IconCssClass="fa fa-cloud-upload" Click="@addUploadDocument" Enabled=@IsUploadEnabled />
                                <DxMenuItem Text="Release" IconCssClass="fa fa-tasks" Click="@addWorlflow" Enabled=@isWorkflowEnabled />
                            </Items>
                        </DxMenu>
                    }
                    else
                    {
                        <DxMenu CollapseItemsToHamburgerMenu="true"
                                CollapseItemToIconMode="MenuCollapseItemToIconMode.Sequentially"
                                DisplayMode="MenuDisplayMode.Desktop">
                            <Items>
                                <DxMenuItem Text="Back" IconCssClass="fa fa-reply" Click="@backUrl" />
                                <DxMenuItem Text="Add" IconCssClass="fa fa-add" Click="@addNew" Enabled="@AddEnabled" />
                                <DxMenuItem Text="Save" IconCssClass="fa fa-save" Click="@SubmitFormExternally" Enabled="isSaveEnabled" />
                                <DxMenuItem Text="Upload" IconCssClass="fa fa-cloud-upload" Click="@addUploadDocument" Enabled=@IsUploadEnabled />
                                <DxMenuItem Text="Release" IconCssClass="fa fa-tasks" Click="@addWorlflow" Enabled=@isWorkflowEnabled />
                            </Items>
                        </DxMenu>
                    }
                </div>

            </div>
        </div>
    </div>

    <DxTabs RenderMode="TabsRenderMode.OnDemand" @bind-ActiveTabIndex="@ActiveTabIndex" TabClick="OnTabClick">
        <DxTabPage Text="Form">
            <div class="card-body" style="margin-top:5px;">
                <DxFormLayout CssClass="w-100">
                    <EditForm EditContext="this._editContexts" Context="EditFormContext" OnValidSubmit="HandleValidSubmit">
                        <DataAnnotationsValidator />
                        <DxFormLayoutGroup ColSpanMd="12" Caption="Profile No" ExpandButtonDisplayMode="GroupExpandButtonDisplayMode.Start" Expanded="true" AnimationType="LayoutAnimationType.Slide">

                            <HeaderContentTemplate>
                                <div>
                                    Profile No
                                </div>
                                @if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0 && _dynamicFormSectionList != null)
                                {
                                    var _dynamicSecAttach = _dynamicFormSectionList.FirstOrDefault(y => y.IsFileExits == "Yes" && y.DynamicFormSectionId == -1);
                                    if (_dynamicSecAttach != null)
                                    {
                                        <div style="margin-left:auto;">
                                            <i class="fa fa-paperclip" aria-hidden="true" style="cursor: pointer;margin-right:10px;" onclick="@(() => OnSectionUploadInfoClick(_dynamicSecAttach))" title="@_dynamicSecAttach.FileName"></i>
                                        </div>
                                    }
                                }
                            </HeaderContentTemplate>
                            <Items>
                                <DxFormLayoutItem Caption="Login From" ColSpanMd="3">
                                    <DxTextBox @bind-Text="@_longInUser" Enabled="false" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Login Company" ColSpanMd="3">
                                    <DxTextBox @bind-Text="@_longInCompany" Enabled="false" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Added By" ColSpanMd="3">
                                    <DxTextBox NullText="Added By" @bind-Text="@_longInAddedBy" Enabled="false" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Added Date" ColSpanMd="3">
                                    <DxDateEdit NullText="Date" @bind-Date="@_longInDateTime" Enabled="false" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Profile No" ColSpanMd="12">
                                    <DxTextBox @bind-Text="@Datas.ProfileNo" Enabled="false" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Company" ColSpanMd="6">
                                    <DxComboBox Data="@_plantItems"
                                                NullText="Select Company..."
                                                ListRenderMode="ListRenderMode.Virtual"
                                                FilteringMode="DataGridFilteringMode.Contains"
                                                TextFieldName="PlantCode"
                                                ValueFieldName="PlantID"
                                                SelectedItemChanged="@((ViewPlants plantSelect) => SelectedItemChanged(plantSelect?.PlantID))"
                                                Enabled="isPlant"
                                    @bind-Value="@Datas.PlantId" ShowValidationIcon="true">
                                        <Columns>
                                            <DxListEditorColumn FieldName="@nameof(ViewPlants.PlantCode)"
                                                                Caption="Plant Code"
                                                                Width="180px" />
                                            <DxListEditorColumn FieldName="@nameof(ViewPlants.Description)"
                                                                Caption="Description" />
                                            <DxListEditorColumn FieldName="@nameof(ViewPlants.NavCompanyName)"
                                                                Caption="Nav Company" />
                                        </Columns>
                                    </DxComboBox>
                                    <ValidationMessage For="@(() => Datas.PlantId)" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Division" ColSpanMd="6">
                                    <DxComboBox Data="@_divisionItems"
                                                NullText="Select Division..."
                                                ListRenderMode="ListRenderMode.Virtual"
                                                FilteringMode="DataGridFilteringMode.Contains"
                                                TextFieldName="Name"
                                                ValueFieldName="DivisionID"
                                                Enabled="isDivision"
                                                SelectedItemChanged="@((ViewDivision plantSelect) => SelectedItemDivisionChanged(plantSelect?.DivisionID))"
                                    @bind-Value="@Datas.DivisionId" ShowValidationIcon="true">
                                        <Columns>
                                            <DxListEditorColumn FieldName="@nameof(ViewDivision.Name)"
                                                                Caption="Name"
                                                                Width="180px" />
                                            <DxListEditorColumn FieldName="@nameof(ViewDivision.Code)"
                                                                Caption="Code" />
                                            <DxListEditorColumn FieldName="@nameof(ViewDivision.Description)"
                                                                Caption="Description" />
                                        </Columns>
                                    </DxComboBox>
                                    <ValidationMessage For="@(() => Datas.DivisionId)" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Department" ColSpanMd="6">
                                    <DxComboBox Data="@_departmentItems"
                                                NullText="Select Department..."
                                                ListRenderMode="ListRenderMode.Virtual"
                                                FilteringMode="DataGridFilteringMode.Contains"
                                                TextFieldName="DepartmentName"
                                                ValueFieldName="DepartmentId"
                                                Enabled="isDepartment"
                                                SelectedItemChanged="@((ViewDepartment plantSelect) => SelectedItemDepartementChanged(plantSelect?.DepartmentId))"
                                    @bind-Value="@Datas.DepartmentId" ShowValidationIcon="true">
                                        <Columns>
                                            <DxListEditorColumn FieldName="@nameof(ViewDepartment.DepartmentName)"
                                                                Caption="Name"
                                                                Width="180px" />
                                            <DxListEditorColumn FieldName="@nameof(ViewDepartment.DepartmentCode)"
                                                                Caption="Code" />
                                            <DxListEditorColumn FieldName="@nameof(ViewDepartment.Description)"
                                                                Caption="Description" />
                                        </Columns>
                                    </DxComboBox>
                                    <ValidationMessage For="@(() => Datas.DepartmentId)" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="Section" ColSpanMd="6">
                                    <DxComboBox Data="@_sectionItems"
                                                NullText="Select Section..."
                                                ListRenderMode="ListRenderMode.Virtual"
                                                FilteringMode="DataGridFilteringMode.Contains"
                                                TextFieldName="SectionName"
                                                ValueFieldName="SectionId"
                                                Enabled="isSection"
                                                SelectedItemChanged="@((ViewSection plantSelect) => SelectedItemSectionChanged(plantSelect?.SectionId))"
                                    @bind-Value="@Datas.SectionId" ShowValidationIcon="true">
                                        <Columns>
                                            <DxListEditorColumn FieldName="@nameof(ViewSection.SectionName)"
                                                                Caption="Name"
                                                                Width="180px" />
                                            <DxListEditorColumn FieldName="@nameof(ViewSection.SectionCode)"
                                                                Caption="Code" />
                                            <DxListEditorColumn FieldName="@nameof(ViewSection.Description)"
                                                                Caption="Description" />
                                        </Columns>
                                    </DxComboBox>
                                    <ValidationMessage For="@(() => Datas.SectionId)" />
                                </DxFormLayoutItem>
                                <DxFormLayoutItem Caption="SubSection" ColSpanMd="6">
                                    <DxComboBox Data="@_subSectionItems"
                                                NullText="Select SubSection..."
                                                ListRenderMode="ListRenderMode.Virtual"
                                                FilteringMode="DataGridFilteringMode.Contains"
                                                TextFieldName="SubSectionName"
                                                ValueFieldName="SubSectionId"
                                                Enabled="isSubSection"
                                    @bind-Value="@Datas.SubSectionId" ShowValidationIcon="true">
                                        <Columns>
                                            <DxListEditorColumn FieldName="@nameof(ViewSubSection.SubSectionName)"
                                                                Caption="Name"
                                                                Width="180px" />
                                            <DxListEditorColumn FieldName="@nameof(ViewSubSection.SubSectionCode)"
                                                                Caption="Code" />
                                            <DxListEditorColumn FieldName="@nameof(ViewSubSection.Description)"
                                                                Caption="Description" />
                                        </Columns>
                                    </DxComboBox>
                                    <ValidationMessage For="@(() => Datas.SubSectionId)" />
                                </DxFormLayoutItem>
                            </Items>
                        </DxFormLayoutGroup>
                    </EditForm>
                </DxFormLayout>
                <EditForm EditContext="this._editContext" Context="EditFormContext" OnValidSubmit="HandleValidSubmit">

                    @CreateEditFormFields()
                </EditForm>
            </div>
        </DxTabPage>
        <DxTabPage Text="Approval" Visible="@isApproval">
            <DxGrid Data="_dynamicFormApprovedList" style="padding:10px;"
                    KeyFieldName="DynamicFormApprovedId">
                <Columns>
                    <DxGridDataColumn FieldName="ApprovalUser" Caption="User" />
                    <DxGridDataColumn FieldName="ApprovedStatus" Caption="Status" />
                    <DxGridDataColumn FieldName="ApprovedDescription" Caption="Description" />
                    <DxGridDataColumn FieldName="ApprovedByUser" Caption="Added By" />
                    <DxGridDataColumn FieldName="ApprovedDate" Caption="Added Date" />
                </Columns>
            </DxGrid>
        </DxTabPage>
        <DxTabPage Text="Work Flow">
            <DxGrid Data="_dynamicFormWorkFlowFormList" style="padding:10px;"
                    KeyFieldName="RowID">
                <Columns>
                    <DxGridDataColumn FieldName="SequenceNo" GroupIndex="0" Caption="Sequence No" MinWidth="40" />
                    <DxGridDataColumn FieldName="SectionName" Caption="Section Name" />
                    <DxGridDataColumn FieldName="DynamicFormWorkFlowUser" Caption="Assigned User" />
                    <DxGridDataColumn FieldName="CompletedBy" Caption="Completed By" />
                    <DxGridDataColumn FieldName="CompletedDate" Caption="Completed Date" />
                </Columns>
            </DxGrid>
        </DxTabPage>
    </DxTabs>

</div>
@* </DxLoadingPanel> *@
<DxPopup @bind-Visible="@isApprovedPopup"
         ShowFooter="true"
         ShowCloseButton="true"
         HeaderText="Approved From"
         Closed="EulaPopupClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Are you sure want to Approved?
        </p>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="Context.CloseCallback" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="HandleFormValidSubmit" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=IsDescriptionOpen
          PositionTarget=@($"#flyout-overview-target-container-Description")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText=@($"{ApproveRejectName} Description")
          FooterVisible="true"
          CloseOnOutsideClick="false"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 550px)"
          Position=@(FlyoutPosition.BottomStart | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <DxFormLayout CssClass="w-100">
            <DxFormLayoutItem Caption="" ColSpanMd="12">
                <DxMemo @bind-Text="@dynamicFormApproval.ApprovedDescription" CssClass="cw-480" Rows="5" />
            </DxFormLayoutItem>
        </DxFormLayout>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(()=> IsDescriptionOpen = false) />
        <DxButton RenderStyle="ButtonRenderStyle.Success" Text="@ApproveRejectName" Click=@(()=> OnUpdateDescription()) />
    </FooterContentTemplate>
</DxFlyout>
<DxPopup @bind-Visible="@PopupUpload"
         HeaderText="Upload Documents"
         CloseOnOutsideClick="false"
         ShowCloseButton="true"
         ShowFooter="false"
         Width="1000px">
    <BodyContentTemplate>
        <UploadDoumentDynamicFiles _applicationUser="@applicationUser" _dynamicformData="@_dynamicformData" FileProfileTypeId="@FileProfileTypeId" RevokeBack="BackUpload"></UploadDoumentDynamicFiles>
    </BodyContentTemplate>
</DxPopup>


<DxPopup @bind-Visible="@wokrFlowpopup"
         ShowFooter="true"
         HeaderText="Work Flow"
         ShowCloseButton="true"
         Closed="EulaPopupWorkFlowClosed"
         Width="300px">
    <BodyContentTemplate>
        <p>
            Do you want to Move WorkFlow?
        </p>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="NO" Click="OnWorkFlowNo" />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Yes" Click="OnWorkFlowYes" />
    </FooterContentTemplate>
</DxPopup>
<DxFlyout @bind-IsOpen=IsSectionInfoOpen
          PositionTarget=@($"#flyout-overview-target-container-SectionInfo-{randomNum}-{DynamicFormInfoSection?.DynamicFormSectionId}")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          PreventCloseOnPositionTargetClick="true"
          HeaderVisible="true"
          HeaderText="Instruction"
          FooterVisible="true"
          CloseOnOutsideClick="true"
          FooterCssClass="custom-flyout-footer"
          Width="max(25vw, 250px)"
          Position=@(FlyoutPosition.Left | FlyoutPosition.TopStart)>
    <BodyContentTemplate Context="PopupContext">
        <span>@DynamicFormInfoSection?.Instruction</span>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Close" Click=@(()=> IsSectionInfoOpen = false) />
    </FooterContentTemplate>
</DxFlyout>
@code {
    bool wokrFlowpopup { get; set; } = false; bool isSaveEnabled { get; set; } = false;
    bool PanelVisible { get; set; } = true;
    EditContext _editContext; EditContext _editContexts;
    [Parameter]
    public Guid? SessionIds { get; set; }
    [Parameter]
    public Guid? SessionId { get; set; }
    [Parameter]
    public long? DynamicFormDataGridId { get; set; }
    [Parameter]
    public Action RevokeGridBack { get; set; }
    public int ActiveTabIndex { get; set; } = 0;
    private bool loading;
    public bool IsDescriptionOpen { get; set; } = false;
    private DynamicForm _dynamicform;
    private DynamicFormData _dynamicformData;
    private string MyID = Guid.NewGuid().ToString();
    private AttributeHeaderListModel _AttributeHeader;
    Object Data { get; set; } = new Object(); Object SpinData { get; set; } = new Object();
    DynamicFormProfile Datas = new DynamicFormProfile();
    DynamicFormData dynamicFormData = new DynamicFormData();
    public ApplicationUser applicationUser { get; private set; }
    public long? dynamicFormDataId { get; set; }
    bool isApproval { get; set; } = false; bool PopupUpload { get; set; } = false;
    bool isApprovedPopup { get; set; } = false;
    bool isApproved { get; set; } = true;
    bool isVisibleButton { get; set; } = true;
    bool IsSendApproval { get; set; } = false;
    bool IsSendApprovalVisible { get; set; } = true;
    bool IsApprovalApproved { get; set; } = false; bool AddEnabled { get; set; } = false;
    bool IsApprovalRejected { get; set; } = false; bool IsUploadEnabled { get; set; } = false;
    bool IsSave { get; set; } = true; bool IsApprovalSave { get; set; } = true;
    string? ApproveName { get; set; } = "Approve";
    string? RejectName { get; set; } = "Reject";
    string? ApproveRejectName { get; set; } = "Approve";
    private DynamicFormApproved dynamicFormApproval = new DynamicFormApproved();
    private List<DynamicFormApproved>? _dynamicFormApprovedList;
    private List<DynamicFormWorkFlowForm>? _dynamicFormWorkFlowFormList;
    public long? FileProfileTypeId { get; set; }
    public Guid? FileProfileSessionId { get; set; }
    int isRequiredCount { get; set; } = 0;
    bool? isSubmit { get; set; } = false;
    Dictionary<string, string> dic = new Dictionary<string, string>();
    bool isApprovalEnabled { get; set; } = false;
    // bool isApproved { get; set; } = true;
    private List<ViewPlants>? _plantItems;
    private List<ViewDivision>? _divisionItems;
    private List<ViewDepartment>? _departmentItems;
    private List<ViewSection>? _sectionItems;
    private List<ViewSubSection>? _subSectionItems;
    bool isPlant { get; set; } = false;
    bool isDivision { get; set; } = false; bool isDepartment { get; set; } = false;
    bool isSection { get; set; } = false; bool isSubSection { get; set; } = false;
    public DocumentProfileNoSeriesModel documentProfileNoSeriesData { get; set; }
    public string? isButtonClick { get; set; }
    private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSection;
    private List<DynamicFormWorkFlowSection>? _dynamicFormWorkFlowSectionNoWorkFlow;
    private List<int?> _sequenceNoList = new List<int?>();
    bool isWorkflowEnabled { get; set; } = false; public bool IsSectionInfoOpen { get; set; } = false;
    DynamicFormSection DynamicFormInfoSection = new DynamicFormSection(); public List<DynamicFormSection> _dynamicFormSectionList { get; set; }
    private List<DynamicForm> _dynamicFormDropDown;
    string? randomNum { get; set; }
    public List<Type?> DataClassTypeList = new List<Type?>(); public List<string?> DataClassObjectNameList = new List<string?>();
    public List<AddTempSectionAttribute> addTempSectionAttributes = new List<AddTempSectionAttribute>();
    public List<DynamicFormDataUploadByPermission> DynamicFormDataUploadByPermissions = new List<DynamicFormDataUploadByPermission>();
    dynamic? jsonObjs = null; string? plantCode = null; List<string?> plantNames = new List<string?>() { "SWMY", "SWSG" }; List<long> plantIds = new List<long>();
    private List<AttributeDetails>? PlantDependencySubAttributeDetails { get; set; } = new List<AttributeDetails>();
    private List<AttributeDetails>? ApplicationMasterParentDetails { get; set; } = new List<AttributeDetails>();
    public List<string?> soCustomerType { get; set; } = new List<string?>() { "Clinic", "Vendor", "Customer", "RawMatItem", "PackagingItem", "ProcessItem" };
    public string? _longInUser { get; set; } = string.Empty; public string? _longInCompany { get; set; } = string.Empty; public DateTime? _longInDateTime { get; set; }
    private ViewEmployee _userEmployee; public string? _longInAddedBy { get; set; } = string.Empty;
    protected override async Task OnInitializedAsync()
    {
        _editContext = new EditContext(Data);
        _editContexts = new EditContext(Datas);
        applicationUser = await _localStorageService.GetItem<ApplicationUser>("user");
        Random rnd = new Random();
        randomNum = "Info-" + rnd.Next(1000).ToString();
        _plantItems = await Mediator.Send(new GetAllPlantQuery());
        if (applicationUser != null)
        {
            _userEmployee = await Mediator.Send(new GetEmployeeFormByUserId(applicationUser.UserID));
        }
    }
    protected override async Task OnParametersSetAsync()
    {
        if (applicationUser != null)
        {
            await loadDynamicForm();
        }
        base.OnParametersSet();
    }
    async Task loadDynamicForm()
    {
        bool? deleted = false;
        _dynamicform = await Mediator.Send(new GetAllDynamicFormList(SessionId, _dynamicformData?.DynamicFormDataId));
        _dynamicFormWorkFlowFormList = await Mediator.Send(new GetDynamicFormWorkFlowFormList(_dynamicform.ID, null));
        _longInUser = applicationUser.UserName; _longInAddedBy = applicationUser.UserName; _longInDateTime = DateTime.Now;
        if (_userEmployee != null)
        {
            _longInCompany = _userEmployee.CompanyName;
        }
        if (_dynamicform != null)
        {
            AddEnabled = true; plantIds = new List<long>(); plantCode = null;
            //_dynamicFormDropDown = await Mediator.Send(new GetAllDynamicForm(0));
            ActiveTabIndex = 0; isApproval = false; isApproved = true; IsSendApproval = false; IsSendApprovalVisible = false; ApproveRejectName = "Approve"; isButtonClick = "";
            IsApprovalApproved = false; IsApprovalRejected = false; IsApprovalSave = false; IsDescriptionOpen = false; isSubmit = false; isWorkflowEnabled = false; isSaveEnabled = true;
            dynamicFormApproval = new DynamicFormApproved(); dynamicFormData = new DynamicFormData(); isApprovalEnabled = false;
            _dynamicformData = null; isVisibleButton = true; IsSave = true; IsUploadEnabled = false; _dynamicFormWorkFlowFormList = new List<DynamicFormWorkFlowForm>();
            if (SessionId != null)
            {

                if (_dynamicform != null)
                {
                    plantCode = string.IsNullOrEmpty(_dynamicform.CompanyName) ? null : _dynamicform.CompanyName.ToLower();


                    if (_dynamicform.IsApproval == true)
                    {
                        isApprovalEnabled = true;
                        StateHasChanged();
                    }
                    FileProfileSessionId = _dynamicform.FileProfileSessionId;
                    FileProfileTypeId = _dynamicform.FileProfileTypeId;
                    if (SessionIds != null)
                    {
                        _dynamicformData = await Mediator.Send(new GetDynamicFormDataBySessionId(SessionIds));
                        if (_dynamicformData != null)
                        {
                            _longInAddedBy = _dynamicformData.AddedBy; _longInDateTime = _dynamicformData.AddedDate;
                            _dynamicFormWorkFlowFormList = await Mediator.Send(new GetDynamicFormWorkFlowFormList(_dynamicformData.DynamicFormId, _dynamicformData.DynamicFormDataId));
                            _dynamicFormApprovedList = await Mediator.Send(new GetDynamicFormApprovedList(_dynamicformData.DynamicFormDataId));
                            _dynamicFormWorkFlowSection = await Mediator.Send(new GetDynamicFormWorkFlowExits(_dynamicform.ID, applicationUser.UserID, _dynamicformData?.DynamicFormDataId));
                            _dynamicFormSectionList = await Mediator.Send(new GetDynamicFormSectionById(_dynamicformData.DynamicFormId, applicationUser.UserID, _dynamicformData.DynamicFormDataId));

                            Datas.ProfileNo = _dynamicformData.ProfileNo;
                            IsUploadEnabled = true;
                            if (_dynamicformData.isDocuments > 0)
                            {
                                // IsUploadEnabled = false;
                            }

                            CheckedApprovalData();

                        }
                        else
                        {
                            AddEnabled = false; ActiveTabIndex = 0; isApproval = false; isApproved = false; IsSendApproval = false; IsSendApprovalVisible = false; ApproveRejectName = "Approve"; isButtonClick = "";
                            IsApprovalApproved = false; IsApprovalRejected = false; IsApprovalSave = false; IsDescriptionOpen = false; isSubmit = false; isWorkflowEnabled = false; isSaveEnabled = false;
                            isApprovalEnabled = false; isVisibleButton = false; IsSave = false; IsUploadEnabled = false;
                            deleted = true;
                        }
                    }
                    else
                    {
                        if (_dynamicform.IsApproval == true && _dynamicform.DynamicFormApproval != null && _dynamicform.DynamicFormApproval.Count > 0)
                        {
                            var isNotApproved = _dynamicform.DynamicFormApproval.OrderBy(o => o.SortOrderBy).FirstOrDefault(f => f.ApprovalUserId == applicationUser.UserID)?.ApprovalUserId;
                            if (isNotApproved == applicationUser.UserID)
                            {
                                isApproval = false;
                            }
                        }
                    }

                }
                if (deleted == false)
                {
                    if (_dynamicform != null)
                    {
                        if (_dynamicFormWorkFlowSection != null && _dynamicFormWorkFlowSection.Count() > 0)
                        {
                            _sequenceNoList = _dynamicFormWorkFlowSection.Where(w => w.IsWorkFlowDone == 0).Select(q => q.SequenceNo).Distinct().OrderBy(x => x).ToList();
                            var notCompleted = _dynamicFormWorkFlowSection.Where(w => w.IsWorkFlowDone == 0).OrderBy(x => x.SequenceNo).ToList();
                            if (_sequenceNoList.Count() > 0)
                            {
                                foreach (var itemss in _sequenceNoList)
                                {
                                    var notdata = notCompleted.Where(w => w.SequenceNo == itemss).ToList();
                                    if (notdata != null && notdata.Count > 0)
                                    {
                                        _dynamicFormWorkFlowSectionNoWorkFlow = notdata;
                                        break;
                                    }
                                }
                            }
                        }
                        var screenId = _dynamicform.ScreenID.Replace(" ", "_");
                        _AttributeHeader = await Mediator.Send(new GetAllAttributeNameList(_dynamicform, applicationUser.UserID));
                        if (_AttributeHeader.DynamicFormSectionAttribute != null && _AttributeHeader.DynamicFormSectionAttribute.Count > 0)
                        {

                            if (!string.IsNullOrEmpty(_dynamicformData?.DynamicFormItem))
                            {
                                if (IsValidJson(_dynamicformData.DynamicFormItem))
                                {
                                    jsonObjs = JsonConvert.DeserializeObject(_dynamicformData.DynamicFormItem);
                                }
                            }
                            var IsRadioCheckRemarksData = _AttributeHeader.DynamicFormSectionAttribute.Where(s => s.IsRadioCheckRemarks != null).ToList();
                            var typesLists = _AttributeHeader.DynamicFormSectionAttribute.Select(s => s.DataType).ToList();
                            var SpinobjectNameLists = new List<string>(); var SpintypesLists = new List<Type>();
                            var objectNameLists = _AttributeHeader.DynamicFormSectionAttribute.Select(s => s.DynamicAttributeName).ToList();
                            List<string?> dataSourceTableIds = new List<string?>() { "Plant" };
                            var DataSourceTablelists = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.AttributeHeaderDataSource.Count > 0).SelectMany(a => a.AttributeHeaderDataSource.Select(s => s.DataSourceTable)).ToList().Distinct().ToList();
                            dataSourceTableIds.AddRange(DataSourceTablelists); List<long?> ApplicationMasterIds = new List<long?>(); List<long?> ApplicationMasterParentIds = new List<long?>();
                            ApplicationMasterIds = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.ApplicationMaster.Count > 0).SelectMany(a => a.ApplicationMaster.Select(s => (long?)s.ApplicationMasterId)).ToList().Distinct().ToList();
                            ApplicationMasterParentIds = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.ApplicationMasterParents.Count > 0).SelectMany(a => a.ApplicationMasterParents.Select(s => (long?)s.ApplicationMasterParentCodeId)).ToList().Distinct().ToList();
                            if (ApplicationMasterIds.Count > 0)
                            {
                                dataSourceTableIds.Add("ApplicationMaster");
                            }
                            if (ApplicationMasterParentIds.Count() > 0)
                            {
                                dataSourceTableIds.Add("ApplicationMasterParent");
                            }
                            PlantDependencySubAttributeDetails = await Mediator.Send(new GetDataSourceDropDownList(null, dataSourceTableIds, plantCode, ApplicationMasterIds, ApplicationMasterParentIds));
                            ApplicationMasterParentDetails = new List<AttributeDetails>();
                            if (PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0 && ApplicationMasterParentIds.Count() > 0)
                            {
                                ApplicationMasterParentDetails = PlantDependencySubAttributeDetails.Where(w => ApplicationMasterParentIds.Contains(w.ApplicationMasterParentCodeId)).ToList();
                            }
                            _AttributeHeader.DynamicFormSectionAttribute.ForEach(a =>
                            {
                                AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                addTempSectionAttribute.DataType = a.DataType;
                                addTempSectionAttribute.DynamicAttributeName = a.DynamicAttributeName;
                                addTempSectionAttribute.ID = a.DynamicFormSectionAttributeId;
                                addTempSectionAttributes.Add(addTempSectionAttribute);
                                if (a.ControlTypeId == 2704)
                                {
                                    SpinobjectNameLists.Add(a.DynamicAttributeName); SpintypesLists.Add(typeof(string));
                                }
                                if (a.DataSourceTable == "ApplicationMaster" && a.ApplicationMaster != null && a.ApplicationMaster.Count() > 0)
                                {
                                    a.ApplicationMaster.ForEach(ab =>
                                    {
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
                                        typesLists.Add(a.DataType);
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = a.DataType;
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttributes.Add(addTempSectionAttributess);

                                    });
                                }
                                if (a.DataSourceTable == "ApplicationMasterParent" && a.ApplicationMasterParents != null && a.ApplicationMasterParents.Count() > 0)
                                {
                                    a.ApplicationMasterParents.ForEach(ab =>
                                    {
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
                                        typesLists.Add(a.DataType);
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = a.DataType;
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttributes.Add(addTempSectionAttributess);
                                        loadApplicationMasterParentDataList(a, ab, typesLists, objectNameLists);
                                    });
                                }
                                if (a.ControlType == "ComboBox" && a.IsPlantLoadDependency == true && a.AttributeHeaderDataSource.Count() > 0)
                                {
                                    List<string?> DataSourceTableIdsNew = new List<string?>();
                                    a.AttributeHeaderDataSource.ForEach(dd =>
                                    {
                                        DataSourceTableIdsNew.Add(dd.DataSourceTable);
                                        var nameData = a.DynamicFormSectionAttributeId + "_" + dd.AttributeHeaderDataSourceId + "_" + dd.DataSourceTable + "_Dependency";
                                        typesLists.Add(typeof(long?));
                                        objectNameLists.Add(nameData);
                                        AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
                                        addTempSectionAttributess.DataType = typeof(long?);
                                        addTempSectionAttributess.DynamicAttributeName = nameData;
                                        addTempSectionAttributes.Add(addTempSectionAttributess);
                                    });
                                    if (a.IsSetDefaultValue == true)
                                    {
                                        loadDependencyDataList(applicationUser.UserID, DataSourceTableIdsNew, a);
                                    }
                                }
                                if (jsonObjs != null)
                                {
                                    var Namess = jsonObjs.ContainsKey(a.DynamicAttributeName);
                                    if (Namess == true)
                                    {
                                        if (a.ControlType == "CheckBox" && a.SubAttributeHeaders != null && a.SubAttributeHeaders.Count > 0)
                                        {
                                            var itemGetSubValue = jsonObjs[a.DynamicAttributeName];
                                            bool? itemGetSubValues = itemGetSubValue == null ? false : (bool)itemGetSubValue;
                                            if (itemGetSubValues == true)
                                            {
                                                a.SubAttributeHeaders.ForEach(d =>
                                                {
                                                    var SubNamess = jsonObjs.ContainsKey(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                    if (SubNamess == true || SubNamess == false)
                                                    {
                                                        AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                                        addTempSectionAttribute.DataType = d.SubDataType;
                                                        addTempSectionAttribute.DynamicAttributeName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                                                        addTempSectionAttributes.Add(addTempSectionAttribute);
                                                        typesLists.Add(d.SubDataType);
                                                        objectNameLists.Add(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                        if (d.SubApplicationMaster != null && d.SubApplicationMaster.Count > 0)
                                                        {
                                                            d.SubApplicationMaster.ForEach(ab =>
                                                            {
                                                                AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                                                                var appendAppMaster = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                                                addTempSectionAttributeSub.DataType = d.SubDataType;
                                                                addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                                                                addTempSectionAttributes.Add(addTempSectionAttributeSub);
                                                                typesLists.Add(d.SubDataType);
                                                                objectNameLists.Add(appendAppMaster);
                                                            });
                                                        }
                                                    }
                                                    else
                                                    {

                                                    }
                                                });
                                            }
                                        }
                                        if (a.ControlType == "Radio" || a.ControlType == "RadioGroup")
                                        {
                                            var itemGetSubValue = jsonObjs[a.DynamicAttributeName];
                                            long? itemGetSubValues = itemGetSubValue == null ? null : (long)itemGetSubValue;
                                            if (itemGetSubValues > 0)
                                            {
                                                var listDetails = _AttributeHeader.AttributeDetails.Where(w => w.AttributeDetailID == itemGetSubValues && w.DropDownTypeId == null).FirstOrDefault();
                                                if (listDetails != null && listDetails.SubAttributeHeaders != null && listDetails.SubAttributeHeaders.Count > 0)
                                                {
                                                    listDetails.SubAttributeHeaders.ForEach(d =>
                                                    {

                                                        var SubNamess = jsonObjs.ContainsKey(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                        if (SubNamess == true || SubNamess == false)
                                                        {
                                                            AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                                            addTempSectionAttribute.DataType = d.SubDataType;
                                                            addTempSectionAttribute.DynamicAttributeName = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                                                            addTempSectionAttributes.Add(addTempSectionAttribute);
                                                            typesLists.Add(d.SubDataType);
                                                            objectNameLists.Add(a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName);
                                                            if (d.SubApplicationMaster != null && d.SubApplicationMaster.Count > 0)
                                                            {
                                                                d.SubApplicationMaster.ForEach(ab =>
                                                                {
                                                                    AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                                                                    var appendAppMaster = a.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                                                    addTempSectionAttributeSub.DataType = d.SubDataType;
                                                                    addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                                                                    addTempSectionAttributes.Add(addTempSectionAttributeSub);
                                                                    typesLists.Add(d.SubDataType);
                                                                    objectNameLists.Add(appendAppMaster);
                                                                });
                                                            }
                                                        }
                                                        else
                                                        {

                                                        }
                                                    });
                                                }
                                            }
                                        }

                                    }
                                }
                            });
                            if (IsRadioCheckRemarksData != null && IsRadioCheckRemarksData.Count > 0)
                            {
                                IsRadioCheckRemarksData.ForEach(d =>
                                {
                                    if (d.ControlTypeId == 2705 || d.ControlTypeId == 2711 || d.ControlTypeId == 2710)
                                    {
                                        if (d.IsRadioCheckRemarks == "TextBox" || d.IsRadioCheckRemarks == "Memo")
                                        {
                                            typesLists.Add(typeof(string));
                                            var appendNames = d.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + d.AttributeName;
                                            AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                                            addTempSectionAttribute.DataType = typeof(string);
                                            addTempSectionAttribute.DynamicAttributeName = appendNames;
                                            //addTempSectionAttribute.ID = a.DynamicFormSectionAttributeId;
                                            addTempSectionAttributes.Add(addTempSectionAttribute);
                                            objectNameLists.Add(appendNames);
                                        }
                                    }
                                });
                            }
                            DataClassTypeList = typesLists;
                            DataClassObjectNameList = objectNameLists;
                            Type[] typesList = typesLists.ToArray();
                            string[] objectNameList = objectNameLists.ToArray();
                            MyClassBuilder MCB = new MyClassBuilder(screenId);
                            Data = MCB.CreateObject(objectNameList, typesList);
                            if (SpinobjectNameLists.Count > 0)
                            {
                                MyClassBuilder SpinMCB = new MyClassBuilder(screenId);
                                SpinData = SpinMCB.CreateObject(SpinobjectNameLists.ToArray(), SpintypesLists.ToArray());
                            }
                            if (_dynamicformData != null)
                            {
                                dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
                                dynamicFormData.SessionId = _dynamicformData.SessionId;
                                dynamicFormData.AddedDate = _dynamicformData.AddedDate;
                                dynamicFormData.AddedByUserID = _dynamicformData.AddedByUserID;
                                dynamicFormData.DynamicFormCurrentItem = _dynamicformData.DynamicFormItem;
                                dynamicFormData.DynamicFormId = _dynamicformData.DynamicFormId;

                                _AttributeHeader.DynamicFormSectionAttribute.ForEach(a =>
                                {
                                    var Names = jsonObjs.ContainsKey(a.DynamicAttributeName);
                                    if (a.ControlTypeId == 2705 || a.ControlTypeId == 2711 || a.ControlTypeId == 2710)
                                    {
                                        var appendGetNames = a.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + a.AttributeName;
                                        if (Data.GetType().GetProperty(appendGetNames) != null)
                                        {
                                            var AppNames = jsonObjs.ContainsKey(appendGetNames);
                                            if (AppNames == true)
                                            {
                                                var itemGetValue = (string)jsonObjs[appendGetNames];
                                                if (a.IsRadioCheckRemarks == "TextBox")
                                                {
                                                    Data.GetType().GetProperty(appendGetNames).SetValue(Data, itemGetValue);
                                                }
                                                if (a.IsRadioCheckRemarks == "Memo")
                                                {
                                                    Data.GetType().GetProperty(appendGetNames).SetValue(Data, itemGetValue);
                                                }
                                            }
                                        }
                                    }
                                    if (Names == true)
                                    {
                                        if (Data.GetType().GetProperty(a.DynamicAttributeName) != null)
                                        {
                                            //var valueType = jsonObj[a.DynamicAttributeName].Type;
                                            var itemValue = jsonObjs[a.DynamicAttributeName];
                                            if (itemValue is JArray)
                                            {
                                                var values = (JArray)itemValue;
                                                List<long?> listData = values.ToObject<List<long?>>();
                                                Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, listData);
                                            }
                                            else if (a.ControlType == "ListBox" && a.IsMultiple == false)
                                            {
                                                long? values = itemValue == null ? null : (long)itemValue;
                                                Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                            }
                                            else
                                            {
                                                List<AttributeHeader> SubAttrsHeader = new List<AttributeHeader>();
                                                if (a.ControlType == "TextBox" || a.ControlType == "Memo" || a.ControlType == "Password")
                                                {
                                                    var values = (string)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);

                                                }
                                                else if (a.ControlType == "ComboBox" || a.ControlType == "Radio" || a.ControlType == "RadioGroup")
                                                {
                                                    long? values = itemValue == null ? null : (long)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    if (values > 0)
                                                    {
                                                        var attrDetails = _AttributeHeader.AttributeDetails.Where(mm => mm.AttributeDetailID == values && mm.DropDownTypeId == null).FirstOrDefault()?.SubAttributeHeaders;
                                                        if (attrDetails != null && attrDetails.Count > 0)
                                                        {
                                                            SubAttrsHeader = attrDetails;
                                                        }
                                                    }
                                                    if (a.ControlType == "ComboBox" && a.IsPlantLoadDependency == true && a.AttributeHeaderDataSource.Count() > 0)
                                                    {
                                                        List<string?> DataSourceTableIdss = new List<string?>();
                                                        a.AttributeHeaderDataSource.ForEach(dd =>
                                                        {
                                                            DataSourceTableIdss.Add(dd.DataSourceTable);
                                                            var nameData = a.DynamicFormSectionAttributeId + "_" + dd.AttributeHeaderDataSourceId + "_" + dd.DataSourceTable + "_Dependency";
                                                            var itemDepExits = jsonObjs.ContainsKey(nameData);
                                                            if (itemDepExits == true)
                                                            {
                                                                var itemDepValue = jsonObjs[nameData];
                                                                if (Data.GetType().GetProperty(nameData) != null)
                                                                {
                                                                    long? valuesDep = itemDepValue == null ? null : (long)itemDepValue;
                                                                    Data.GetType().GetProperty(nameData).SetValue(Data, valuesDep);
                                                                }
                                                            }
                                                        });
                                                        loadDependencyDataList(values, DataSourceTableIdss, a);


                                                    }
                                                }
                                                else if (a.ControlType == "CheckBox")
                                                {
                                                    bool? values = itemValue == null ? false : (bool)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    if (values == true)
                                                    {
                                                        SubAttrsHeader = a.SubAttributeHeaders;
                                                    }
                                                }
                                                else if (a.ControlType == "DateEdit")
                                                {
                                                    DateTime? values = itemValue == null ? null : (DateTime)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                }
                                                else if (a.ControlType == "TimeEdit")
                                                {
                                                    TimeSpan? values = itemValue == null ? null : (TimeSpan)itemValue;
                                                    Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                }

                                                else if (a.ControlType == "SpinEdit")
                                                {
                                                    if (a.IsSpinEditType == "decimal")
                                                    {
                                                        decimal? values = itemValue == null ? null : (decimal)itemValue;
                                                        Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    }
                                                    else
                                                    {
                                                        int? values = itemValue == null ? null : (int)itemValue;
                                                        Data.GetType().GetProperty(a.DynamicAttributeName).SetValue(Data, values);
                                                    }
                                                }
                                                loadSubHeaders(SubAttrsHeader, a);

                                            }
                                            if (a.DataSourceTable == "ApplicationMaster")
                                            {
                                                loadApplicationMasterDataList(a);
                                            }
                                            if (a.DataSourceTable == "ApplicationMasterParent")
                                            {
                                                loadApplicationMasterParentSetItemDataList(a);
                                            }
                                        }
                                    }
                                });

                            }
                        }
                        else
                        {
                            if (_dynamicformData != null)
                            {
                                dynamicFormData.DynamicFormDataId = _dynamicformData.DynamicFormDataId;
                                dynamicFormData.SessionId = _dynamicformData.SessionId;
                                dynamicFormData.AddedDate = _dynamicformData.AddedDate;
                                dynamicFormData.AddedByUserID = _dynamicformData.AddedByUserID;
                                dynamicFormData.DynamicFormCurrentItem = _dynamicformData.DynamicFormItem;
                                dynamicFormData.DynamicFormId = _dynamicformData.DynamicFormId;
                            }
                        }
                    }
                    if (_dynamicform != null && _dynamicformData == null)
                    {
                        if (_dynamicform.ProfileId > 0)
                        {
                            await loadData(_dynamicform.ProfileId);
                        }
                    }
                    if (_dynamicform != null && _dynamicformData != null)
                    {
                        if (_dynamicformData.ProfileId > 0)
                        {
                        }
                        else
                        {
                            if (_dynamicform.ProfileId > 0)
                            {
                                await loadData(_dynamicform.ProfileId);
                            }
                        }
                    }
                }

            }

        }
        else
        {
            AddEnabled = false;
        }
        StateHasChanged();
    }
    void loadApplicationMasterParentDataList(DynamicFormSectionAttribute dynamicFormSectionAttribute, ApplicationMasterParent applicationMasterParent, List<Type?> typesLists, List<string?> objectNameLists)
    {
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar";
            typesLists.Add(dynamicFormSectionAttribute.DataType);
            objectNameLists.Add(nameData);
            AddTempSectionAttribute addTempSectionAttributess = new AddTempSectionAttribute();
            addTempSectionAttributess.DataType = dynamicFormSectionAttribute.DataType;
            addTempSectionAttributess.DynamicAttributeName = nameData;
            addTempSectionAttributes.Add(addTempSectionAttributess);
            loadApplicationMasterParentDataList(dynamicFormSectionAttribute, dataList, typesLists, objectNameLists);
        }
    }
    void loadApplicationMasterParentSetItemDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (jsonObjs != null)
        {
            if (dynamicFormSectionAttributes.ApplicationMasterParents != null && dynamicFormSectionAttributes.ApplicationMasterParents.Count() > 0)
            {
                dynamicFormSectionAttributes.ApplicationMasterParents.ForEach(ab =>
                {
                    loadApplicationMasterParentSetDataList(dynamicFormSectionAttributes, ab);

                });
            }
        }
    }
    void loadApplicationMasterDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (jsonObjs != null)
        {
            if (dynamicFormSectionAttributes.ApplicationMaster != null && dynamicFormSectionAttributes.ApplicationMaster.Count() > 0)
            {
                dynamicFormSectionAttributes.ApplicationMaster.ForEach(ab =>
                {
                    var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
                    if (Data.GetType().GetProperty(nameData) != null)
                    {
                        var SubNamess = jsonObjs.ContainsKey(nameData);
                        if (SubNamess == true)
                        {
                            var itemValues = jsonObjs[nameData];
                            if (itemValues is JArray)
                            {
                                var values = (JArray)itemValues;
                                List<long?> listDatas = values.ToObject<List<long?>>();
                                if (dynamicFormSectionAttributes.IsMultiple == true || dynamicFormSectionAttributes.ControlType == "TagBox")
                                {
                                    Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                                }
                            }
                            else
                            {
                                if (dynamicFormSectionAttributes.ControlType == "ComboBox")
                                {
                                    long? values = itemValues == null ? null : (long)itemValues;
                                    Data.GetType().GetProperty(nameData).SetValue(Data, values);
                                }
                                else
                                {
                                    if (dynamicFormSectionAttributes.ControlType == "ListBox" && dynamicFormSectionAttributes.IsMultiple == false)
                                    {
                                        long? values = itemValues == null ? null : (long)itemValues;
                                        Data.GetType().GetProperty(nameData).SetValue(Data, values);
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }
    }
    void loadDependencyDataList(long? values, List<string?> DataSourceTableIdss, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        var plantDepIds = new List<long?>();
        if (values > 0)
        {
            plantDepIds.Add((long?)values);
            var plantDatas = _plantItems.FirstOrDefault(p => p.PlantID == values);
            if (!string.IsNullOrEmpty(plantDatas.PlantCode) && plantDatas.PlantCode.ToLower() == "SWGP".ToLower())
            {
                plantDepIds = new List<long?>();
                if (_plantItems != null && _plantItems.Count() > 0)
                {
                    plantDepIds = _plantItems.Where(w => plantNames.Contains(w.PlantCode)).Select(s => (long?)s.PlantID).ToList();
                }
            }
            if (PlantDependencySubAttributeDetails != null && DataSourceTableIdss.Count > 0)
            {
                List<AttributeDetails> attributeDepDetails = new List<AttributeDetails>();
                attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => plantDepIds.Contains(v.CompanyId) && DataSourceTableIdss.Contains(v.DropDownTypeId)).ToList());
                var soCustomerList = soCustomerType.Intersect(DataSourceTableIdss).ToList();
                if (soCustomerList.Count > 0)
                {
                    attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => soCustomerList.Contains(v.DropDownTypeId)).ToList());
                }
                dynamicFormSectionAttributes.SubAttributeDetails = attributeDepDetails;
            }
        }
    }
    void loadSubHeaders(List<AttributeHeader>? SubAttrsHeader, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        if (jsonObjs != null)
        {
            if (SubAttrsHeader != null && SubAttrsHeader.Count > 0)
            {
                SubAttrsHeader.ForEach(d =>
             {
                 var subAttrName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName;
                 if (Data.GetType().GetProperty(subAttrName) != null)
                 {
                     var SubNamess = jsonObjs.ContainsKey(subAttrName);
                     if (SubNamess == true)
                     {
                         var itemValues = jsonObjs[subAttrName];
                         if (itemValues is JArray)
                         {
                             var values = (JArray)itemValues;
                             List<long?> listDatas = values.ToObject<List<long?>>();
                             if (d.IsMultiple == true || d.ControlType == "TagBox")
                             {
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, listDatas);
                             }
                         }
                         else if (d.ControlType == "ListBox" && d.IsMultiple == false)
                         {
                             long? values = itemValues == null ? null : (long)itemValues;
                             Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                         }
                         else
                         {
                             if (d.ControlType == "TextBox" || d.ControlType == "Memo")
                             {
                                 var values = (string)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);

                             }
                             else if (d.ControlType == "ComboBox" || d.ControlType == "Radio" || d.ControlType == "RadioGroup")
                             {
                                 long? values = itemValues == null ? null : (long)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "CheckBox")
                             {
                                 bool? values = itemValues == null ? false : (bool)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "DateEdit")
                             {
                                 DateTime? values = itemValues == null ? null : (DateTime)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "TimeEdit")
                             {
                                 TimeSpan? values = itemValues == null ? null : (TimeSpan)itemValues;
                                 Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                             }
                             else if (d.ControlType == "SpinEdit")
                             {
                                 if (d.IsAttributeSpinEditType == "decimal")
                                 {
                                     decimal? values = itemValues == null ? null : (decimal)itemValues;
                                     Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                                 }
                                 else
                                 {
                                     int? values = itemValues == null ? null : (int)itemValues;
                                     Data.GetType().GetProperty(subAttrName).SetValue(Data, values);
                                 }
                             }
                         }
                         if (d.DataSourceTable == "ApplicationMaster" && d.SubApplicationMaster != null && d.SubApplicationMaster.Count() > 0)
                         {
                             d.SubApplicationMaster.ForEach(ab =>
                             {
                                 var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + d.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                 var SubNamesss = jsonObjs.ContainsKey(appendAppMaster);
                                 if (SubNamesss == true)
                                 {
                                     var itemValues = jsonObjs[appendAppMaster];
                                     if (itemValues is JArray)
                                     {
                                         var values = (JArray)itemValues;
                                         List<long?> listDatas = values.ToObject<List<long?>>();
                                         if (d.IsMultiple == true || d.ControlType == "TagBox")
                                         {
                                             Data.GetType().GetProperty(appendAppMaster).SetValue(Data, listDatas);
                                         }
                                     }
                                     else
                                     {
                                         if (d.ControlType == "ComboBox")
                                         {
                                             long? values = itemValues == null ? null : (long)itemValues;
                                             Data.GetType().GetProperty(appendAppMaster).SetValue(Data, values);
                                         }
                                         else
                                         {
                                             if (d.ControlType == "ListBox" && d.IsMultiple == false)
                                             {
                                                 long? values = itemValues == null ? null : (long)itemValues;
                                                 Data.GetType().GetProperty(appendAppMaster).SetValue(Data, values);
                                             }
                                         }
                                     }
                                 }
                             });
                         }
                     }
                 }
             });
            }

        }
    }
    void loadApplicationMasterParentSetDataList(DynamicFormSectionAttribute dynamicFormSectionAttributes, ApplicationMasterParent ab)
    {
        var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
        if (Data.GetType().GetProperty(nameData) != null)
        {
            var SubNamess = jsonObjs.ContainsKey(nameData);
            if (SubNamess == true)
            {
                var itemValues = jsonObjs[nameData];
                if (itemValues is JArray)
                {
                    var values = (JArray)itemValues;
                    List<long?> listDatas = values.ToObject<List<long?>>();
                    if (dynamicFormSectionAttributes.IsMultiple == true || dynamicFormSectionAttributes.ControlType == "TagBox")
                    {
                        Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                        List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
                        nameDatas.Add(ab);
                        RemoveApplicationMasterParentSingleAllItem(ab, dynamicFormSectionAttributes, nameDatas);
                        setApplicationMasterParentData(nameDatas, dynamicFormSectionAttributes);
                    }
                }
                else
                {
                    if (dynamicFormSectionAttributes.ControlType == "ComboBox")
                    {
                        long? values = itemValues == null ? null : (long)itemValues;
                        Data.GetType().GetProperty(nameData).SetValue(Data, values);
                        loadApplicationMasterParentDataLoad(values, dynamicFormSectionAttributes);
                    }
                    else
                    {
                        if (dynamicFormSectionAttributes.ControlType == "ListBox" && dynamicFormSectionAttributes.IsMultiple == false)
                        {
                            long? values = itemValues == null ? null : (long)itemValues;
                            Data.GetType().GetProperty(nameData).SetValue(Data, values);
                            loadApplicationMasterParentDataLoad(values, dynamicFormSectionAttributes);
                        }
                    }
                }
            }
        }
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == ab.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            loadApplicationMasterParentSetDataList(dynamicFormSectionAttributes, dataList);
        }
    }
    void setApplicationMasterParentData(List<ApplicationMasterParent> apar, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (apar != null && apar.Count() > 0)
        {
            var preData = new List<long?>();
            apar.ForEach(e =>
            {
                var curData = new List<long?>();
                var nameData = dynamicFormSectionAttributes.DynamicFormSectionAttributeId + "_" + e.ApplicationMasterParentCodeId + "_AppMasterPar";
                if (Data.GetType().GetProperty(nameData) != null)
                {
                    var SubNamess = jsonObjs.ContainsKey(nameData);
                    if (SubNamess == true)
                    {
                        var itemValues = jsonObjs[nameData];
                        if (itemValues is JArray)
                        {
                            var values = (JArray)itemValues;
                            List<long?> listDatas = values.ToObject<List<long?>>();
                            Data.GetType().GetProperty(nameData).SetValue(Data, listDatas);
                            if (listDatas != null && listDatas.Count() > 0 && PlantDependencySubAttributeDetails != null)
                            {
                                curData = listDatas;
                            }
                                if (preData.Count() > 0)
                                {
                                    preData.ForEach(t =>
                                    {
                                        loadApplicationMasterParentDataLoad(t, dynamicFormSectionAttributes);
                                    });
                                }
                            
                        }
                    }
                }
                preData = curData;
            });
        }
    }
    void loadApplicationMasterParentDataLoad(long? values, DynamicFormSectionAttribute dynamicFormSectionAttributes)
    {
        if (PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0)
        {
            var plt = PlantDependencySubAttributeDetails.Where(w => w.ParentId == values).ToList();
            if (plt != null && plt.Count() > 0)
            {
                plt.ForEach(a =>
                {
                    var exitss = a.ApplicationMasterParentSectionIds.Where(w => w == dynamicFormSectionAttributes.DynamicFormSectionAttributeId).Count();
                    if (exitss == 0)
                    {
                        a.ApplicationMasterParentSectionIds.Add(dynamicFormSectionAttributes.DynamicFormSectionAttributeId);
                    }
                });
                if (ApplicationMasterParentDetails == null)
                {
                    ApplicationMasterParentDetails = new List<AttributeDetails>();
                    ApplicationMasterParentDetails.AddRange(plt);
                }
                else
                {
                    var exitsData = ApplicationMasterParentDetails.Where(w => w.ParentId == values).Count();
                    if (exitsData == 0)
                    {
                        ApplicationMasterParentDetails.AddRange(plt);
                    }
                }

            }
        }
    }
    public void CheckedApprovalData()
    {
        if (_dynamicform.IsApproval == true)
        {
            IsSendApproval = _dynamicformData.IsSendApproval == true ? true : false;
            if (_dynamicformData.IsApproval == true)
            {
                if (_dynamicformData.IsSendApproval == true)
                {
                    IsSendApprovalVisible = false; IsApprovalSave = false;
                    isVisibleButton = false; IsSave = false; //IsUploadEnabled = false;
                }
                else
                {
                    IsSendApprovalVisible = true; IsApprovalSave = true;
                }
            }

            CheckApproval();
        }
    }
    public async Task loadData(long? profileID)
    {
        _editContexts = new EditContext(Datas);
        isPlant = false;
        isDivision = false; isDepartment = false;
        isSection = false; isSubSection = false;
        Datas.PlantId = 0; Datas.DepartmentId = 0; Datas.ProfileId = 0; Datas.ProfileNo = null;
        Datas.DivisionId = 0; Datas.SectionId = 0; Datas.SubSectionId = 0;
        if (profileID > 0)
        {
            Datas.ProfileId = profileID;
            Datas.UserId = applicationUser.UserID;
            documentProfileNoSeriesData = await Mediator.Send(new GetDocumentProfileNoSeriesById(profileID));

            dynamic abbreviation = JsonConvert.DeserializeObject(documentProfileNoSeriesData.Abbreviation1);
            if (abbreviation != null)
            {
                foreach (var item in abbreviation)
                {
                    var itemsId = item.Id;
                    if (itemsId == 1)
                    {
                        isPlant = true;
                        Datas.PlantId = null;
                    }
                    if (itemsId == 2)
                    {
                        isDepartment = true; isDivision = true;
                        Datas.DepartmentId = null;
                        Datas.DivisionId = null;
                    }
                    if (itemsId == 3)
                    {
                        isSection = true;
                        Datas.SectionId = null;
                    }
                    if (itemsId == 4)
                    {
                        isSubSection = true;
                        Datas.SubSectionId = null;
                    }
                }
            }
        }
        _plantItems = await Mediator.Send(new GetAllPlantQuery());
        await SelectedItemChanged(0);
        await SelectedItemDivisionChanged(0);
        await SelectedItemDepartementChanged(0);
        await SelectedItemSectionChanged(0);
        StateHasChanged();
    }
    async Task SelectedItemChanged(long? plantID)
    {
        _divisionItems = new List<ViewDivision>();
        _departmentItems = new List<ViewDepartment>();
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (plantID > 0)
        {
            _divisionItems = await Mediator.Send(new GetDivisionByCompany(plantID));
        }
    }
    async Task SelectedItemDivisionChanged(long? divisionId)
    {
        _departmentItems = new List<ViewDepartment>();
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (divisionId > 0)
        {
            _departmentItems = await Mediator.Send(new GetDepartmentByDivision(divisionId));
        }
    }
    async Task SelectedItemDepartementChanged(long? departmentId)
    {
        _sectionItems = new List<ViewSection>();
        _subSectionItems = new List<ViewSubSection>();
        if (departmentId > 0)
        {
            _sectionItems = await Mediator.Send(new GetSectionByDepartment(departmentId));
        }
    }
    async Task SelectedItemSectionChanged(long? sectionId)
    {
        _subSectionItems = new List<ViewSubSection>();
        if (sectionId > 0)
        {
            _subSectionItems = await Mediator.Send(new GetSubSectionBySection(sectionId));
        }
    }
    void CheckApproval()
    {
        if (_dynamicFormApprovedList != null && _dynamicFormApprovedList.Count > 0)
        {
            var notApproved = _dynamicFormApprovedList.Where(z => z.IsApproved != true).OrderBy(o => o.DynamicFormApprovedId).ToList();
            var isApprovedListData = _dynamicFormApprovedList.Where(z => z.IsApproved == true).OrderBy(o => o.DynamicFormApprovedId).ToList();
            var isNotApproved = notApproved.OrderBy(o => o.DynamicFormApprovedId).FirstOrDefault()?.UserId;
            if (isNotApproved == applicationUser.UserID)
            {
                var UserApproveData = notApproved.FirstOrDefault(a => a.UserId == applicationUser.UserID);
                if (UserApproveData != null)
                {
                    dynamicFormApproval.ApprovedDescription = UserApproveData?.ApprovedDescription;
                    dynamicFormApproval.DynamicFormApprovalId = UserApproveData?.DynamicFormApprovalId;
                    dynamicFormApproval.DynamicFormApprovedId = UserApproveData.DynamicFormApprovedId;
                    dynamicFormApproval.DynamicFormDataId = UserApproveData.DynamicFormDataId;
                    if (IsSendApproval == true)
                    {
                        if (UserApproveData.IsApproved == false)
                        {
                            IsApprovalApproved = true;
                            IsApprovalRejected = false;
                        }
                        else if (UserApproveData.IsApproved == true)
                        {
                            IsApprovalApproved = false;
                            IsApprovalRejected = true;
                        }
                        else
                        {
                            IsApprovalApproved = true;
                            IsApprovalRejected = true;
                        }

                    }
                }
                else
                {
                    isVisibleButton = false; IsSave = false;
                    isApproval = true;
                }
            }
            else
            {
                var isnotApproved = notApproved.FirstOrDefault(f => f.IsApproved == null);
                if (isnotApproved != null)
                {
                    isApproval = false;
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true;
                    }
                    else
                    {
                        var approvedPending = _dynamicFormApprovedList.Where(w => w.IsApproved == null).ToList();
                        var approved = _dynamicFormApprovedList.Where(w => w.IsApproved == true).ToList();
                        var appPre = 0;
                        if (approvedPending != null && approvedPending.Count > 0)
                        {
                            if (approved != null && approved.Count() > 0)
                            {
                                var isapproved = approved.OrderByDescending(o => o.DynamicFormApprovedId).FirstOrDefault(w => w.IsApproved == true);
                                if (isapproved != null)
                                {
                                    appPre = 1;
                                }
                            }
                            var isapprovedPending = approvedPending.OrderBy(o => o.DynamicFormApprovedId).FirstOrDefault(w => w.IsApproved == null);
                            if (isapprovedPending != null)
                            {

                                if (appPre == 1)
                                {
                                    // isVisibleButton = "display:none;"; IsSave = false;
                                }
                            }
                        }
                    }
                }
                else
                {
                    isVisibleButton = false; IsSave = false;
                    isApproval = false;
                }
            }
            var isApprovedAs = isApprovedListData.FirstOrDefault(f => f.UserId == applicationUser.UserID);
            if (isApprovedAs != null)
            {
                isVisibleButton = false; IsSave = false;
                isApproval = true;
            }
            else
            {
                var rejectedStatus = _dynamicFormApprovedList.Where(z => z.IsApproved == false).FirstOrDefault();
                if (rejectedStatus != null)
                {
                    if (rejectedStatus.UserId != applicationUser.UserID)
                    {
                        isVisibleButton = false; IsSave = false;
                    }
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true; isVisibleButton = false; IsSave = false;
                    }
                }
                else
                {
                    var appList = _dynamicFormApprovedList.Where(z => z.UserId == applicationUser.UserID).FirstOrDefault();
                    if (appList != null)
                    {
                        isApproval = true; isVisibleButton = false; IsSave = false;
                    }
                }
            }
        }
    }
    void onClickApprove()
    {
        ApproveRejectName = "Approve";
        IsDescriptionOpen = true;
        dynamicFormApproval.IsApproved = true;
    }
    void onClickReject()
    {
        ApproveRejectName = "Reject";
        IsDescriptionOpen = true;
        dynamicFormApproval.IsApproved = false;
    }
    async Task OnUpdateDescription()
    {
        await UpdateStatusApproval();
        IsDescriptionOpen = false;
    }
    async Task UpdateStatusApproval()
    {
        dynamicFormApproval.ApprovedByUserId = applicationUser.UserID;
        dynamicFormApproval.ApprovedDate = DateTime.Now;
        var response = await Mediator.Send(new UpdateDynamicFormApprovedByStaus(dynamicFormApproval));
        if (response != null)
        {
            if (response.IsApproved == true)
            {
                toastService.ShowToast("Satus Approved Successfully", AC.SD.Core.Services.ToastLevel.Success);
            }
            if (response.IsApproved == false)
            {
                toastService.ShowToast("Satus Rejected Successfully", AC.SD.Core.Services.ToastLevel.Success);
            }
            dynamicFormApproval = new DynamicFormApproved();
            await loadDynamicForm();
        }
    }
    void OnTabClick(TabClickEventArgs e)
    {
    }
    private static bool IsValidJson(string strInput)
    {
        if (string.IsNullOrWhiteSpace(strInput)) { return false; }
        strInput = strInput.Trim();
        if ((strInput.StartsWith("{") && strInput.EndsWith("}")) || //For object
            (strInput.StartsWith("[") && strInput.EndsWith("]"))) //For array
        {
            try
            {
                var obj = JToken.Parse(strInput);
                return true;
            }
            catch (JsonReaderException jex)
            {
                //Exception in parsing json
                return false;
            }
            catch (Exception ex) //some other exception
            {
                return false;
            }
        }
        else
        {
            return false;
        }
    }
    void backUrl()
    {
        RevokeGridBack.Invoke();
    }
    void ResetForm()
    {

    }
    async void addNew()
    {
        SessionIds = null;
        await loadDynamicForm();
    }
    private async Task SubmitApproveFormExternally()
    {
        IsSendApproval = true;
        if (_editContext.Validate() && _editContexts.Validate())
        {
            IsSendApproval = true;
            await this.HandleFormValidApprovalSubmit();
        }
    }

    private async Task SubmitFormExternally()
    {
        IsSendApproval = false;
        if (_editContext.Validate() && _editContexts.Validate())
        {
            IsSendApproval = false;

            await this.HandleValidSubmit();
        }
    }
    void formSubmitEnabled()
    {
        if (isVisibleButton == true)
        {
            isVisibleButton = false;
        }
        if (IsSendApprovalVisible == true)
        {
            IsSendApprovalVisible = false;
        }
        if (IsApprovalApproved == true)
        {
            IsApprovalApproved = false;
        }
        if (IsApprovalRejected == true)
        {
            IsApprovalRejected = false;
        }
        if (IsUploadEnabled == true)
        {
            IsUploadEnabled = false;
        }
        if (isWorkflowEnabled == true)
        {
            isWorkflowEnabled = false;
        }
        if (isSaveEnabled == true)
        {
            isSaveEnabled = false;
        }
    }
    async Task HandleFormValidApprovalSubmit()
    {
        isSubmit = true;
        if (isRequiredCount == 0)
        {
            if (IsSave == true || IsApprovalSave == true)
            {
                formSubmitEnabled();
                var datas = Data;
                string strJson = JsonConvert.SerializeObject(datas);
                loading = true;
                dynamicFormData.DynamicFormId = _dynamicform.ID;
                if (dynamicFormData.DynamicFormDataId > 0)
                {
                    var editReq = new InsertOrUpdateDynamicFormData
                        {
                            DynamicFormProfile = Datas,
                            ProfileId = _dynamicformData.ProfileId,
                            ProfileNo = _dynamicformData.ProfileNo,
                            DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                            DynamicFormId = _dynamicform.ID,
                            DynamicFormItem = strJson,
                            SessionId = dynamicFormData.SessionId,
                            ModifiedByUserID = applicationUser.UserID,
                            AddedByUserID = dynamicFormData.AddedByUserID,
                            ModifiedDate = DateTime.Now,
                            StatusCodeID = 1,
                            AddedDate = dynamicFormData.AddedDate,
                            AttributeHeader = _AttributeHeader,
                            ObjectData = Data,
                            IsSendApproval = IsSendApproval,
                            FileProfileSessionID = FileProfileSessionId,
                            DynamicFormDataGridId = DynamicFormDataGridId,
                        };

                    var result = await Mediator.Send(editReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        //if (IsSendApproval == true)
                        // {
                        if (_dynamicFormApprovedList == null)
                        {
                            await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                            await loadDynamicForm();
                        }
                        else
                        {
                            if (_dynamicFormApprovedList.Count == 0)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                        }
                        //}
                        // else
                        //{
                        //      await loadDynamicForm();
                        // }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            _dynamicformData.ProfileId = result.ProfileId; _dynamicformData.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        toastService.ShowToast("Record updated Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        loading = false;
                        //await onApproved();
                    }
                    StateHasChanged();
                }
                else
                {
                    var createReq = new InsertOrUpdateDynamicFormData
                        {
                            DynamicFormProfile = Datas,
                            ProfileId = dynamicFormData.ProfileId,
                            DynamicFormItem = strJson,
                            DynamicFormId = _dynamicform.ID,
                            SessionId = Guid.NewGuid(),
                            AddedByUserID = applicationUser.UserID,
                            ModifiedByUserID = applicationUser.UserID,
                            ModifiedDate = DateTime.Now,
                            StatusCodeID = 1,
                            AddedDate = DateTime.Now,
                            AttributeHeader = _AttributeHeader,
                            ObjectData = Data,
                            IsSendApproval = IsSendApproval,
                            DynamicFormDataGridId = DynamicFormDataGridId,
                        };
                    var result = await Mediator.Send(createReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        toastService.ShowToast("Record save Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        dynamicFormDataId = result.DynamicFormDataId;
                        dynamicFormData.DynamicFormDataId = dynamicFormDataId.Value;
                        // if (IsSendApproval == true)
                        // {
                        if (_dynamicFormApprovedList == null)
                        {
                            await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                            await loadDynamicForm();
                        }
                        else
                        {
                            if (_dynamicFormApprovedList.Count == 0)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                        }
                        // }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        loading = false;
                        // await onApproved();
                    }
                    loading = false;
                    NavigationManager.NavigateTo("DynamicMasterSetup/dynamicForms/" + SessionId + "/" + createReq.SessionId);
                    StateHasChanged();
                }
            }
        }
        else
        {
            toastService.ShowToast("Validation error occured.Please check the required field values!.", AC.SD.Core.Services.ToastLevel.Warning);
        }
    }
    async Task HandleFormValidSubmit()
    {
        isSubmit = true;
        if (isRequiredCount == 0)
        {
            if (IsSave == true || IsApprovalSave == true)
            {
                formSubmitEnabled();
                var datas = Data;
                string strJson = JsonConvert.SerializeObject(datas);
                loading = true;
                dynamicFormData.DynamicFormId = _dynamicform.ID;
                if (dynamicFormData.DynamicFormDataId > 0)
                {
                    var editReq = new InsertOrUpdateDynamicFormData
                        {
                            DynamicFormProfile = Datas,
                            ProfileId = _dynamicformData.ProfileId,
                            ProfileNo = _dynamicformData.ProfileNo,
                            DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                            DynamicFormId = _dynamicform.ID,
                            DynamicFormItem = strJson,
                            SessionId = dynamicFormData.SessionId,
                            ModifiedByUserID = applicationUser.UserID,
                            AddedByUserID = dynamicFormData.AddedByUserID,
                            ModifiedDate = DateTime.Now,
                            StatusCodeID = 1,
                            AddedDate = dynamicFormData.AddedDate,
                            AttributeHeader = _AttributeHeader,
                            ObjectData = Data,
                            IsSendApproval = IsSendApproval,
                            FileProfileSessionID = FileProfileSessionId,
                            DynamicFormDataGridId = DynamicFormDataGridId,
                        };

                    var result = await Mediator.Send(editReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        if (IsSendApproval == true)
                        {
                            if (_dynamicFormApprovedList == null)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                            else
                            {
                                if (_dynamicFormApprovedList.Count == 0)
                                {
                                    await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                    await loadDynamicForm();
                                }
                            }
                        }
                        else
                        {
                            await loadDynamicForm();
                        }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            _dynamicformData.ProfileId = result.ProfileId; _dynamicformData.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        toastService.ShowToast("Record updated Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        loading = false;
                        //await onApproved();
                    }
                    StateHasChanged();
                }
                else
                {
                    var createReq = new InsertOrUpdateDynamicFormData
                        {
                            DynamicFormProfile = Datas,
                            ProfileId = dynamicFormData.ProfileId,
                            DynamicFormItem = strJson,
                            DynamicFormId = _dynamicform.ID,
                            SessionId = Guid.NewGuid(),
                            AddedByUserID = applicationUser.UserID,
                            ModifiedByUserID = applicationUser.UserID,
                            ModifiedDate = DateTime.Now,
                            StatusCodeID = 1,
                            AddedDate = DateTime.Now,
                            AttributeHeader = _AttributeHeader,
                            ObjectData = Data,
                            IsSendApproval = IsSendApproval,
                            DynamicFormDataGridId = DynamicFormDataGridId,
                        };
                    var result = await Mediator.Send(createReq);
                    if (result.DynamicFormDataId > 0)
                    {
                        IsUploadEnabled = true;
                        toastService.ShowToast("Record save Successfully", AC.SD.Core.Services.ToastLevel.Success);
                        dynamicFormDataId = result.DynamicFormDataId;
                        dynamicFormData.DynamicFormDataId = dynamicFormDataId.Value;
                        if (IsSendApproval == true)
                        {
                            if (_dynamicFormApprovedList == null)
                            {
                                await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                await loadDynamicForm();
                            }
                            else
                            {
                                if (_dynamicFormApprovedList.Count == 0)
                                {
                                    await InsertOrUpdateDynamicFormApprovedData(dynamicFormData);
                                    await loadDynamicForm();
                                }
                            }
                        }
                        if (result.ProfileId > 0)
                        {
                            Datas.ProfileNo = result.ProfileNo;
                            isPlant = false; isDivision = false; isDepartment = false; isSection = false; isSubSection = false;
                        }
                        loading = false;
                        // await onApproved();
                    }
                    loading = false;
                    SessionIds = createReq.SessionId;
                    await loadDynamicForm();
                    StateHasChanged();
                }
            }
        }
        else
        {
            toastService.ShowToast("Validation error occured.Please check the required field values!.", AC.SD.Core.Services.ToastLevel.Warning);
        }
    }

    async Task InsertOrUpdateDynamicFormApprovedData(DynamicFormData dynamicFormData)
    {
        var response = await Mediator.Send(new InsertOrUpdateDynamicFormApproved(dynamicFormData));
    }
    async Task HandleValidSubmit()
    {
        if (_dynamicformData == null)
        {
            //if (isButtonClick == "Yes")
            // {
            // toastService.ShowToast("You must save record", AC.SD.Core.Services.ToastLevel.Error);
            //}
            //else
            // {
            if (isApproval == true && dynamicFormApproval.IsApproved == true)
            {
                isApprovedPopup = true;
            }
            else
            {
                await HandleFormValidSubmit();
            }
            //}
        }
        else
        {
            if (isApproval == true && dynamicFormApproval.IsApproved == true)
            {
                isApprovedPopup = true;
            }
            else
            {
                await HandleFormValidSubmit();
            }
        }
    }
    async Task onApproved()
    {
        if (isApproval == true)
        {
            if (dynamicFormApproval.IsApproved == true)
            {
                var createReq = new InsertDynamicFormApproved
                    {
                        DynamicFormId = _dynamicform.ID,
                        DynamicFormDataId = dynamicFormData.DynamicFormDataId,
                        DynamicFormApprovedId = dynamicFormApproval.DynamicFormApprovedId,
                        DynamicFormApprovalId = dynamicFormApproval.DynamicFormApprovalId,
                        ApprovedDescription = dynamicFormApproval.ApprovedDescription,
                        IsApproved = dynamicFormApproval.IsApproved,
                    };
                var result = await Mediator.Send(createReq);
                if (result.DynamicFormApprovedId > 0)
                {
                    dynamicFormApproval.DynamicFormApprovedId = result.DynamicFormApprovedId;
                    isApprovedPopup = false;

                    isApproved = false; isVisibleButton = false;
                }
            }
        }
    }
    async Task OnApprovedForm()
    {
        await HandleFormValidSubmit();
    }
    void EulaPopupClosed(PopupClosedEventArgs args)
    {
        isApprovedPopup = false;
    }
    void addUploadDocument()
    {
        PopupUpload = true;
    }
    void BackUpload()
    {
        InvokeAsync(loadDynamicForm);
        PopupUpload = false;
        StateHasChanged();

    }
    public void Dispose()
    {
        System.GC.Collect();
        GC.SuppressFinalize(this);
    }
    void EulaPopupWorkFlowClosed()
    {
        isButtonClick = "";
        wokrFlowpopup = false;
        StateHasChanged();
    }
    void OnWorkFlowNo()
    {
        isButtonClick = "";
        wokrFlowpopup = false;
        StateHasChanged();
    }
    async Task OnWorkFlowYes()
    {
        await addWorlflowAdd();
    }
    void addWorlflow()
    {
        if (_dynamicformData == null)
        {
            toastService.ShowToast("You must save record", AC.SD.Core.Services.ToastLevel.Error);
        }
        else
        {
            wokrFlowpopup = true;
        }
    }
    void OnSectionInfoClick(DynamicFormSection dynamicFormSection)
    {
        IsSectionInfoOpen = true;
        DynamicFormInfoSection = dynamicFormSection;
        StateHasChanged();
    }
    async Task addWorlflowAdd()
    {
        isButtonClick = "Yes";

        if (dynamicFormData != null && dynamicFormData.DynamicFormDataId > 0)
        {
            var dynamicFormWorkFlowSectionId = _dynamicFormWorkFlowSectionNoWorkFlow.FirstOrDefault(w => w.DynamicFormId == dynamicFormData.DynamicFormId && w.UserId == applicationUser.UserID);
            if (dynamicFormWorkFlowSectionId != null)
            {
                var resultData = await Mediator.Send(new GetDynamicFormWorkFlowFormExits(dynamicFormWorkFlowSectionId.DynamicFormWorkFlowSectionId, applicationUser.UserID, dynamicFormData.DynamicFormDataId));
                if (resultData == null)
                {
                    var response = await Mediator.Send(new InsertOrUpdateFormWorkFlowSectionNoWorkFlow(_dynamicFormWorkFlowSectionNoWorkFlow, dynamicFormData.DynamicFormDataId, applicationUser.UserID));
                    if (response != null)
                    {
                        wokrFlowpopup = false; isWorkflowEnabled = false; isSaveEnabled = false;
                        isVisibleButton = false;
                        IsUploadEnabled = false; IsSendApprovalVisible = false; IsApprovalApproved = false; IsApprovalRejected = false;
                        toastService.ShowToast("Workflow completed successfully", AC.SD.Core.Services.ToastLevel.Success);
                    }

                    await loadDynamicForm();
                    StateHasChanged();
                }
                else
                {
                    toastService.ShowToast("Workflow Already Completed", AC.SD.Core.Services.ToastLevel.Error);
                }
            }

        }
        else
        {
            await loadDynamicForm();
            StateHasChanged();
        }
    }
    async Task OnToastClick(long? Id)
    {
        isButtonClick = "Yes";

        if (dynamicFormData != null && dynamicFormData.DynamicFormDataId > 0)
        {
            var response = await Mediator.Send(new InsertOrUpdateFormWorkFlowSectionNoWorkFlow(_dynamicFormWorkFlowSectionNoWorkFlow, dynamicFormData.DynamicFormDataId, applicationUser.UserID));
            StateHasChanged();
        }
        else
        {
            StateHasChanged();
        }
    }
    async Task OnSectionUploadInfoClick(DynamicFormSection dynamicFormSection1)
    {
        if (dynamicFormSection1 != null)
        {
            if (dynamicFormSection1.DynamicFormDataUploadId > 0 && dynamicFormSection1.UploadSessionID != null && dynamicFormSection1.FileProfileSessionID != null && dynamicFormSection1.IsFileExits == "Yes")
            {
                var url = NavigationManager.BaseUri.ToString() + "fileprofiletype/" + dynamicFormSection1.FileProfileSessionID + "/" + dynamicFormSection1.UploadSessionID;
                await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
            }
        }
    }
    void OnCheckedChangedItem(bool? str, PropertyInfo property, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        if (dynamicFormSectionAttribute.SubAttributeHeaders.Count > 0)
        {
            List<AttributeHeader> subAttributeHeadersLists = new List<AttributeHeader>();

            Object DatsOld = new Object();
            DatsOld = Data;
            var screenId = _dynamicform.ScreenID.Replace(" ", "_");
            MyClassBuilder MCB = new MyClassBuilder(screenId);
            if (str == true)
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                dynamicFormSectionAttribute.SubAttributeHeaders.ForEach(s =>
                {
                    AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                    addTempSectionAttribute.DataType = s.SubDataType;
                    addTempSectionAttribute.DynamicAttributeName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName;
                    addTempSectionAttributes.Add(addTempSectionAttribute);
                    if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                    {
                        s.SubApplicationMaster.ForEach(ab =>
                        {
                            AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                            var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                            addTempSectionAttributeSub.DataType = s.SubDataType;
                            addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                            addTempSectionAttributes.Add(addTempSectionAttributeSub);
                        });
                    }
                });

                addTempSectionAttributes.ForEach(s =>
                {
                    DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                });
                subAttributeHeadersLists = dynamicFormSectionAttribute.SubAttributeHeaders;
            }
            else
            {
                DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
                dynamicFormSectionAttribute.SubAttributeHeaders.ForEach(s =>
                {
                    addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName);
                    if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                    {
                        s.SubApplicationMaster.ForEach(ab =>
                        {
                            var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                            addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == appendAppMaster);
                        });
                    }
                });
                addTempSectionAttributes.ForEach(s =>
                {
                    DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
                });
            }
            Type[] typesList = DataClassTypeList.ToArray();
            string[] objectNameList = DataClassObjectNameList.ToArray();
            Data = MCB.CreateObject(objectNameList, typesList);
            if (DataClassObjectNameList.Count > 0)
            {
                DataClassObjectNameList.ForEach(s =>
                {
                    if (DatsOld.GetType().GetProperty(s) != null)
                    {
                        var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
                        Data.GetType().GetProperty(s).SetValue(Data, avluess);
                    }
                });
            }
            loadSubHeaders(subAttributeHeadersLists, dynamicFormSectionAttribute);
        }
    }
    void loadPlantDroDownList(long? str, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<AttributeDetails> attributeDetails)
    {
        dynamicFormSectionAttribute.SubAttributeDetails = new List<AttributeDetails>();
        List<string?> DataSourceTableIds = new List<string?>();
        if (dynamicFormSectionAttribute.ControlType == "ComboBox" && dynamicFormSectionAttribute.IsPlantLoadDependency == true && dynamicFormSectionAttribute.AttributeHeaderDataSource.Count > 0)
        {
            dynamicFormSectionAttribute.AttributeHeaderDataSource.ForEach(a =>
            {
                if (!string.IsNullOrEmpty(a.DataSourceTable))
                {
                    DataSourceTableIds.Add(a.DataSourceTable);
                    var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + a.AttributeHeaderDataSourceId + "_" + a.DataSourceTable + "_Dependency";
                    var addexits = addTempSectionAttributes.FirstOrDefault(f => f.DynamicAttributeName == nameData);
                    if (addexits == null)
                    {
                        AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                        addTempSectionAttribute.DataType = typeof(long?);
                        addTempSectionAttribute.DynamicAttributeName = nameData;
                        addTempSectionAttributes.Add(addTempSectionAttribute);
                    }
                }
            });

            var listDetailsData = attributeDetails.Where(w => w.AttributeDetailID == str).FirstOrDefault();
            if (listDetailsData != null)
            {
                var plantDepIds = new List<long?>();
                plantDepIds.Add((long?)listDetailsData.AttributeDetailID);
                if (!string.IsNullOrEmpty(listDetailsData.AttributeDetailName) && listDetailsData.AttributeDetailName.ToLower() == "SWGP".ToLower())
                {
                    plantDepIds = new List<long?>();
                    if (attributeDetails != null && attributeDetails.Count() > 0)
                    {
                        plantDepIds = attributeDetails.Where(w => plantNames.Contains(w.AttributeDetailName)).Select(s => (long?)s.AttributeDetailID).ToList();
                    }
                }
                if (PlantDependencySubAttributeDetails != null && DataSourceTableIds.Count > 0)
                {
                    List<AttributeDetails> attributeDepDetails = new List<AttributeDetails>();
                    attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => plantDepIds.Contains(v.CompanyId) && DataSourceTableIds.Contains(v.DropDownTypeId)).ToList());
                    var soCustomerLists = soCustomerType.Intersect(DataSourceTableIds).ToList();
                    if (soCustomerLists.Count > 0)
                    {
                        attributeDepDetails.AddRange(PlantDependencySubAttributeDetails.Where(v => soCustomerLists.Contains(v.DropDownTypeId)).ToList());
                    }
                    dynamicFormSectionAttribute.SubAttributeDetails = attributeDepDetails;
                }
            }
        }
    }
    void OnRadioChangedItem(long? str, PropertyInfo property, List<AttributeDetails> attributeDetails, DynamicFormSection dynamicFormSection, DynamicFormSectionAttribute dynamicFormSectionAttribute)
    {
        property.SetValue(Data, str);
        if (dynamicFormSectionAttribute.ControlType == "ComboBox" && dynamicFormSectionAttribute.IsPlantLoadDependency == true && dynamicFormSectionAttribute.AttributeHeaderDataSource.Count > 0)
        {
            dynamicFormSectionAttribute.AttributeHeaderDataSource.ForEach(a =>
            {
                if (!string.IsNullOrEmpty(a.DataSourceTable))
                {
                    var nameData = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + a.AttributeHeaderDataSourceId + "_" + a.DataSourceTable + "_Dependency";
                    if (Data.GetType().GetProperty(nameData) != null)
                    {
                        Data.GetType().GetProperty(nameData).SetValue(Data, null);
                    }
                }
            });
        }
        // if (str > 0)
        // {
        List<AttributeHeader> subAttributeHeadersLists = new List<AttributeHeader>();
        var listDetails = attributeDetails.Where(w => w.AttributeDetailID == str && w.DropDownTypeId == null).FirstOrDefault();
        var listNotDetails = attributeDetails.Where(w => w.AttributeDetailID != str && w.DropDownTypeId == null).ToList();
        Object DatsOld = new Object();
        DatsOld = Data;
        var screenId = _dynamicform.ScreenID.Replace(" ", "_");
        MyClassBuilder MCB = new MyClassBuilder(screenId);
        DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
        loadPlantDroDownList(str, dynamicFormSectionAttribute, attributeDetails);
        if (listDetails != null && listDetails.SubAttributeHeaders != null && listDetails.SubAttributeHeaders.Count > 0)
        {
            subAttributeHeadersLists = listDetails.SubAttributeHeaders;
            listDetails.SubAttributeHeaders.ForEach(s =>
            {
                AddTempSectionAttribute addTempSectionAttribute = new AddTempSectionAttribute();
                addTempSectionAttribute.DataType = s.SubDataType;
                addTempSectionAttribute.DynamicAttributeName = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName;
                addTempSectionAttributes.Add(addTempSectionAttribute);
                if (s.SubApplicationMaster != null && s.SubApplicationMaster.Count > 0)
                {
                    s.SubApplicationMaster.ForEach(ab =>
                    {
                        AddTempSectionAttribute addTempSectionAttributeSub = new AddTempSectionAttribute();
                        var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + s.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                        addTempSectionAttributeSub.DataType = s.SubDataType;
                        addTempSectionAttributeSub.DynamicAttributeName = appendAppMaster;
                        addTempSectionAttributes.Add(addTempSectionAttributeSub);
                    });
                }
            });

            addTempSectionAttributes.ForEach(s =>
            {
                DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
            });
        }
        if (listNotDetails != null && listNotDetails.Count > 0)
        {
            DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
            listNotDetails.ForEach(l =>
            {
                if (l.SubAttributeHeaders != null && l.SubAttributeHeaders.Count > 0)
                {
                    l.SubAttributeHeaders.ForEach(v =>
                    {
                        addTempSectionAttributes.RemoveAll(p => p.DynamicAttributeName == dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + v.SubDynamicAttributeName);
                        if (v.SubApplicationMaster != null && v.SubApplicationMaster.Count > 0)
                        {
                            v.SubApplicationMaster.ForEach(ab =>
                            {
                                var appendAppMaster = dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + v.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
                                addTempSectionAttributes.RemoveAll(r => r.DynamicAttributeName == appendAppMaster);
                            });
                        }
                    });
                }
            });
            addTempSectionAttributes.ForEach(s =>
             {
                 DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
             });
        }
        else
        {
            DataClassTypeList = new List<Type?>(); DataClassObjectNameList = new List<string?>();
            addTempSectionAttributes.ForEach(s =>
             {
                 DataClassTypeList.Add(s.DataType); DataClassObjectNameList.Add(s.DynamicAttributeName);
             });
        }
        Type[] typesList = DataClassTypeList.ToArray();
        string[] objectNameList = DataClassObjectNameList.ToArray();
        Data = MCB.CreateObject(objectNameList, typesList);
        if (DataClassObjectNameList.Count > 0)
        {
            DataClassObjectNameList.ForEach(s =>
            {
                if (DatsOld.GetType().GetProperty(s) != null)
                {
                    var avluess = DatsOld.GetType().GetProperty(s).GetValue(DatsOld);
                    Data.GetType().GetProperty(s).SetValue(Data, avluess);
                }
            });
        }
        loadSubHeaders(subAttributeHeadersLists, dynamicFormSectionAttribute);

        // }
    }
    public RenderFragment CreateEditFormFields() => formLayoutBuilder =>
    {
        //PanelVisible = true;
        isRequiredCount = 0;
        var _AttributeHeaders = _AttributeHeader;
        var propertyList = Data.GetType().GetProperties(); int i = 0; int k = 0;
        if (_AttributeHeader != null && _AttributeHeader.DynamicFormSection != null && _AttributeHeader.DynamicFormSectionAttribute.Count > 0)
        {

            _AttributeHeader.DynamicFormSection.ForEach(a =>
        {
            //PanelVisible = true;
            var isReadonly = false;
            var isVisible = false; var isUploadReadonly = false;
            var isUploadVisible = false;
            if (isApproval == false)
            {
                if (a.IsPermissionCount == 0 && a.IsLoginUsers == 0)
                {
                    isVisible = true; isReadonly = true; isUploadVisible = true; isUploadReadonly = true;
                }
                else
                {
                    if (a.IsPermissionCount > 0)
                    {
                        if (a.IsVisible == true)
                        {
                            if (a.IsLoginUsers > 0)
                            {
                                isVisible = true; isUploadVisible = true;
                                if (a.IsReadWrite == true)
                                {
                                    isReadonly = true; isUploadReadonly = true;
                                }
                                if (a.IsReadOnly == true)
                                {
                                    isReadonly = false; isUploadReadonly = false;
                                }
                            }
                        }
                    }
                    else
                    {
                        isVisible = true; isReadonly = true; isUploadVisible = true; isUploadReadonly = true;
                    }
                }
            }
            else
            {
                isVisible = true; isReadonly = true; isUploadVisible = true; isUploadReadonly = true;
            }
            if (_dynamicFormWorkFlowSection != null && _dynamicFormWorkFlowSection.Count > 0)
            {
                isVisible = true; isReadonly = false; isVisibleButton = false;
                IsUploadEnabled = false; IsSendApprovalVisible = false; IsApprovalApproved = false; IsApprovalRejected = false;
                isSaveEnabled = false;
            }
            var exitsForm = string.Empty;
            if (_dynamicFormWorkFlowFormList != null && _dynamicFormWorkFlowFormList.Count > 0)
            {
                var exitsDatas = _dynamicFormWorkFlowFormList.FirstOrDefault(q => q.DynamicFormSectionId == a.DynamicFormSectionId);
                exitsForm = exitsDatas != null ? "Yes" : string.Empty;
            }

            if (exitsForm == "Yes")
            {
                if (_dynamicformData != null)
                {
                    if (_dynamicFormWorkFlowSectionNoWorkFlow != null && _dynamicFormWorkFlowSection.Count > 0)
                    {
                        var exitss = _dynamicFormWorkFlowSectionNoWorkFlow.FirstOrDefault(f => f.DynamicFormSectionId == a.DynamicFormSectionId);
                        if (exitss != null)
                        {
                            var userExits = _dynamicFormWorkFlowSectionNoWorkFlow.FirstOrDefault(f => f.DynamicFormSectionId == a.DynamicFormSectionId && f.UserId == applicationUser.UserID);
                            if (userExits != null)
                            {

                                isVisible = true; isReadonly = true;
                            }
                            else
                            {
                                isVisible = true; isReadonly = false;
                            }
                        }
                        else
                        {
                            isVisible = true; isReadonly = false;
                        }
                    }
                }
            }
            else
            {
                isVisible = true; isReadonly = true;
            }

            var exi = DynamicFormDataUploadByPermissions.FirstOrDefault(f => f.DynamicFormSectionId == a.DynamicFormSectionId);
            if (exi == null)
            {
                DynamicFormDataUploadByPermission DynamicFormDataUploadByPermission = new DynamicFormDataUploadByPermission();
                DynamicFormDataUploadByPermission.IsVisible = isUploadVisible;
                DynamicFormDataUploadByPermission.IsReadonly = isUploadReadonly;
                DynamicFormDataUploadByPermission.DynamicFormSectionId = a.DynamicFormSectionId;
                DynamicFormDataUploadByPermissions.Add(DynamicFormDataUploadByPermission);
            }
            formLayoutBuilder.OpenComponent<DxFormLayout>(i);

            formLayoutBuilder.AddAttribute(i + 1, "ChildContent", (RenderFragment)((layoutItemBuilder) =>
        {
            layoutItemBuilder.OpenComponent<DxFormLayoutGroup>(i + 1);
            layoutItemBuilder.AddAttribute(i + 1, "ExpandButtonDisplayMode", GroupExpandButtonDisplayMode.Start);
            layoutItemBuilder.AddAttribute(i + 1, "Expanded", k == 0 ? true : false);
            layoutItemBuilder.AddAttribute(i + 1, "AnimationType", LayoutAnimationType.Slide);
            //layoutItemBuilder.AddAttribute(i + 1, "Caption", a.SectionName);
            layoutItemBuilder.AddAttribute(i + 1, "Visible", isVisible);
            layoutItemBuilder.AddAttribute(i + 1, "HeaderContentTemplate", (RenderFragment<IFormLayoutGroupInfo>)((context) => (b) =>
            {
                b.OpenElement(i + 1, "div");
                b.AddContent(i + 1, a.SectionName);
                b.CloseElement();
                b.OpenElement(i + 1, "div");
                b.AddAttribute(i + 1, "style", "margin-left:auto;");
                if (isUploadReadonly == true)
                {
                    if (_dynamicformData != null && _dynamicformData.DynamicFormDataId > 0 && _dynamicFormSectionList != null && _dynamicFormSectionList.Count > 0)
                    {
                        var _dynamicSecAttach = _dynamicFormSectionList.FirstOrDefault(y => y.IsFileExits == "Yes" && y.DynamicFormSectionId == a.DynamicFormSectionId);
                        if (_dynamicSecAttach != null)
                        {
                            b.OpenElement(i + 1, "i");
                            b.AddAttribute(i + 1, "class", "fa fa-paperclip");
                            b.AddAttribute(i + 1, "style", "cursor: pointer;margin-right:10px;");
                            b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionUploadInfoClick(_dynamicSecAttach)));
                            b.AddAttribute(i + 1, "title", _dynamicSecAttach.FileName);
                            b.AddAttribute(i + 1, "aria-hidden", true);
                            b.CloseElement();
                        }
                    }
                }
                if (!string.IsNullOrEmpty(a.Instruction))
                {


                    b.OpenElement(i + 1, "i");
                    b.AddAttribute(i + 1, "class", "fa fa-info-circle");
                    b.AddAttribute(i + 1, "style", "cursor: pointer;");
                    b.AddAttribute(i + 1, "id", ($"flyout-overview-target-container-SectionInfo-{randomNum}-{a.DynamicFormSectionId}"));
                    b.AddAttribute(i + 1, "onclick", EventCallback.Factory.Create(this, () => OnSectionInfoClick(a)));
                    b.AddAttribute(i + 1, "title", "Click Here Show Instruction");
                    b.AddAttribute(i + 1, "aria-hidden", true);
                    b.CloseElement();
                }
                b.CloseElement();
            }));
            layoutItemBuilder.AddAttribute(i + 1, "Items", (RenderFragment)((itemBuilder) =>
    {
        var dynamicFormSectionAttributeData = _AttributeHeader.DynamicFormSectionAttribute.Where(w => w.DynamicFormSectionId == a.DynamicFormSectionId).OrderBy(o => o.SortOrderBy).ToList();
        if (dynamicFormSectionAttributeData != null && dynamicFormSectionAttributeData.Count > 0)
        {
            var dynamicFormSectionAttributeDataOne = new DynamicFormSectionAttribute();
            dynamicFormSectionAttributeData.ForEach(s =>
                {
                    bool? isAccessOnly = true; bool? isViewFormatOnly = true;
                    if (s.DynamicFormSectionAttributeSecurity.Count > 0)
                    {
                        isAccessOnly = false; isViewFormatOnly = false;
                        var exitsAccess = s.DynamicFormSectionAttributeSecurity.FirstOrDefault(f => f.UserId == applicationUser.UserID && f.IsAccess == true);
                        if (exitsAccess != null)
                        {
                            isAccessOnly = true;
                        }
                        var IsViewFormatAll = s.DynamicFormSectionAttributeSecurity.Where(f => f.IsViewFormatOnly == true).Count();
                        if (IsViewFormatAll > 0)
                        {
                            var exitsIsViewFormat = s.DynamicFormSectionAttributeSecurity.FirstOrDefault(f => f.UserId == applicationUser.UserID && f.IsViewFormatOnly == true);
                            if (exitsIsViewFormat != null)
                            {
                                isViewFormatOnly = true;
                            }
                            else
                            {
                                isViewFormatOnly = false;
                                isAccessOnly = false;
                            }
                        }
                        else
                        {
                            isViewFormatOnly = true;
                        }
                    }
                    dynamicFormSectionAttributeDataOne = s;
                    var property = Data.GetType().GetProperty(s.DynamicAttributeName);
                    if (property != null)
                    {
                        var valueData = property.GetValue(Data);
                        var propertyType = Nullable.GetUnderlyingType(property.PropertyType) ?? property.PropertyType;
                        var dataLists = new List<AttributeDetails>();
                        if (!string.IsNullOrEmpty(s.DropDownTypeId))
                        {
                            dataLists = _AttributeHeader.AttributeDetails.Where(x => x.DropDownTypeId == s.DataSourceTable && x.ApplicationMasterId == s.ApplicationMasterId).ToList();
                        }
                        else
                        {
                            dataLists = _AttributeHeader.AttributeDetails.Where(x => x.AttributeID == s.AttributeId).ToList();
                        }
                        List<AttributeDetails> attributeDetailss = dataLists;
                        if (s.DataSourceTable != "ApplicationMaster" && s.DataSourceTable != "ApplicationMasterParent")
                        {
                            itemBuilder.OpenComponent<DxFormLayoutItem>(1);
                            if (s.ControlType != "Dynamic Grid Form")
                            {
                                itemBuilder.AddAttribute(i++, "Caption", s.DisplayName);
                            }
                            itemBuilder.AddAttribute(i++, "ColSpanMd", s.ColSpan);

                            var access = Expression.Property(Expression.Constant(Data), s.DynamicAttributeName);
                            var lambda = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), access);

                            itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context) => ((editor) =>
             {
                 var j = 0;
                 if (s.ControlType == "Dynamic Grid Form")
                 {
                     editor.OpenComponent<AC.SD.Core.Pages.Attribute.DynamicFormGridLists>(j + 1);
                     editor.AddAttribute(j + 1, "SessionId", s.DynamicFormSessionId);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "IsReadonly", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "IsReadonly", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "MainSessionId", dynamicFormData?.SessionId);
                     editor.AddAttribute(j + 1, "DynamicFormDataGridId", dynamicFormData?.DynamicFormDataId);
                     editor.CloseComponent();
                 }
                 else if (s.ControlType == "TextBox")
                 {
                     editor.OpenComponent<DxTextBox>(j + 1);
                     if (isViewFormatOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Text", valueData);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Text", "******");
                     }

                     editor.AddAttribute(j + 1, "TextExpression", lambda);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }

                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { property.SetValue(Data, str); }));
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (string.IsNullOrEmpty((string)valueData))
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "border-color:red;");
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
             {
                 layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
                 layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
                 layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
                 layoutItemBuilderss.CloseComponent();

             }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (string.IsNullOrEmpty((string)valueData) && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }

                 else if (s.ControlType == "DateEdit")
                 {
                     if (valueData == null && s.IsSetDefaultValue == true)
                     {
                         valueData = DateTime.Now;
                         property.SetValue(Data, valueData);
                     }
                     editor.OpenComponent<DxDateEdit<DateTime?>>(j + 1);
                     editor.AddAttribute(j + 1, "Date", valueData);
                     editor.AddAttribute(j + 1, "DateExpression", lambda);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "DateChanged", EventCallback.Factory.Create<System.DateTime?>(this, str => { property.SetValue(Data, str); }));
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
                         {
                             layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
                             layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
                             layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
                             layoutItemBuilderss.CloseComponent();

                         }));
                     }
                     editor.CloseComponent();
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                 }
                 else if (s.ControlType == "TimeEdit")
                 {
                     if (valueData == null && s.IsSetDefaultValue == true)
                     {
                         valueData = DateTime.Now.TimeOfDay;
                         property.SetValue(Data, valueData);
                     }
                     editor.OpenComponent<DxTimeEdit<TimeSpan?>>(j + 1);
                     editor.AddAttribute(j + 1, "Time", valueData);
                     editor.AddAttribute(j + 1, "TimeExpression", lambda);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "TimeChanged", EventCallback.Factory.Create<System.TimeSpan?>(this, str => { property.SetValue(Data, str); }));
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }
                 }
                 else if (s.ControlType == "Memo")
                 {
                     editor.OpenComponent<DxMemo>(j);
                     if (isViewFormatOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Text", valueData);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Text", "******");
                     }
                     editor.AddAttribute(j + 1, "TextExpression", lambda);
                     editor.AddAttribute(j + 1, "Rows", 5);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { property.SetValue(Data, str); }));
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (string.IsNullOrEmpty((string)valueData))
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "border-color:red;");
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (string.IsNullOrEmpty((string)valueData) && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }
                 else if (s.ControlType == "SpinEdit")
                 {
                     if (isViewFormatOnly == true)
                     {
                         if (propertyType.Name == "Int32")
                         {
                             editor.OpenComponent<DxSpinEdit<int?>>(j + 1);
                             editor.AddAttribute(j + 1, "Value", valueData);
                             editor.AddAttribute(j + 1, "MinValue", 0);
                             if (isAccessOnly == true)
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isReadonly);
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                             }
                             editor.AddAttribute(j + 1, "BindValueMode", BindValueMode.OnInput);
                             editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<int?>(this, str => { property.SetValue(Data, str); }));
                         }
                         if (propertyType.Name == "Decimal")
                         {
                             editor.OpenComponent<DxSpinEdit<decimal?>>(j + 1);
                             editor.AddAttribute(j + 1, "Value", valueData);
                             editor.AddAttribute(j + 1, "Increment", 0.1M);
                             if (isAccessOnly == true)
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isReadonly);
                             }
                             else
                             {
                                 editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                             }
                             editor.AddAttribute(j + 1, "MinValue", 0M);

                             editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<decimal?>(this, str => { property.SetValue(Data, str); }));
                         }
                         editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                         editor.AddAttribute(j + 1, "ValueExpression", lambda);
                     }
                     else
                     {
                         var accessSpin = Expression.Property(Expression.Constant(SpinData), s.DynamicAttributeName);
                         var lambdaSpin = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(string)), accessSpin);
                         editor.OpenComponent<DxTextBox>(j + 1);
                         editor.AddAttribute(j + 1, "Text", "******");
                         editor.AddAttribute(j + 1, "Enabled", false);
                         editor.AddAttribute(j + 1, "TextExpression", lambdaSpin);
                     }

                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (valueData == null)
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "border-color:red;");
                             }
                         }
                     }

                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true && isViewFormatOnly == true)
                     {
                         if (valueData == null && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }
                 else if (s.ControlType == "CheckBox")
                 {
                     editor.OpenComponent<DxCheckBox<bool?>>(j + 1);
                     editor.AddAttribute(j + 1, "Checked", valueData ?? false);
                     editor.AddAttribute(j + 1, "CheckedExpression", lambda);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, (str) => OnCheckedChangedItem(str, property, a, s)));
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null || (bool)valueData == false)
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "border-color:red;");
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null || (bool)valueData == false && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }
                 else if (s.ControlType == "RadioGroup")
                 {
                     editor.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(j + 1);
                     editor.AddAttribute(j + 1, "Items", attributeDetailss);
                     editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                     editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                     editor.AddAttribute(j + 1, "Value", valueData);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ValueExpression", lambda);
                     editor.AddAttribute(j + 1, "Layout", s.RadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                     editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null)
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "color:red;");
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }
                 else if (s.ControlType == "Radio")
                 {
                     editor.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(j + 1);
                     editor.AddAttribute(j + 1, "Items", attributeDetailss);
                     editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                     editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                     editor.AddAttribute(j + 1, "Value", valueData);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ValueExpression", lambda);
                     editor.AddAttribute(j + 1, "Layout", s.RadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                     editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null)
                         {
                             isRequiredCount += 1;
                             if (isSubmit == true)
                             {
                                 //editor.AddAttribute(j + 1, "style", "color:red;");
                             }
                         }
                     }
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                     {
                         if (valueData == null && isSubmit == true)
                         {
                             editor.OpenElement(j + 1, "span");
                             editor.AddAttribute(j + 1, "class", "text-danger");
                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                             editor.CloseElement();
                         }
                     }
                 }
                 else if (s.ControlType == "ComboBox")
                 {
                     if (valueData == null && s.IsSetDefaultValue == true)
                     {
                         if (s.DataSourceTable == "Employee")
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                             if (exitsDefaultData != null)
                             {
                                 valueData = applicationUser.UserID;
                                 property.SetValue(Data, valueData);
                             }
                         }
                         if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                             if (exitsDefaultData != null)
                             {
                                 valueData = _userEmployee.PlantID;
                                 property.SetValue(Data, valueData);
                             }
                         }
                     }
                     List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                     if (s.IsDynamicFormDropTagBox == true)
                     {
                         editor.OpenComponent<DxComboBox<DynamicForm, long?>>(j + 1);
                         editor.AddAttribute(j + 1, "Data", _dynamicFormDropDown);
                     }
                     else
                     {
                         gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == s.DynamicFormGridDropDownId).FirstOrDefault()?.DropDownOptionsModels;
                         if (s.DataSourceTable == "DynamicGrid")
                         {
                             var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                             List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                             if (collection != null)
                             {
                                 foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                 {
                                     dynamic eod = v;
                                     var vv = eod.DynamicFormId;
                                     if ((long?)vv == s.DynamicFormGridDropDownId)
                                     {
                                         _dynamicformObjectDataList.Add(v);
                                     }
                                 }
                             }
                             if (gridlistss != null)
                             {
                                 editor.OpenComponent<DxComboBox<ExpandoObject, long?>>(j + 1);
                                 editor.AddAttribute(j + 1, "Data", _dynamicformObjectDataList);
                             }
                         }
                         else
                         {
                             editor.OpenComponent<DxComboBox<AttributeDetails, long?>>(j + 1);
                             editor.AddAttribute(j + 1, "Data", attributeDetailss);
                             editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}");

                         }
                     }
                     editor.AddAttribute(j + 1, "TextFieldName", s.IsDynamicFormDropTagBox == true ? "Name" : "AttributeDetailName");
                     editor.AddAttribute(j + 1, "ValueFieldName", s.IsDynamicFormDropTagBox == true ? "ID" : "AttributeDetailID");
                     editor.AddAttribute(j + 1, "NullText", "Select " + s.DisplayName + "..");
                     editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                     editor.AddAttribute(j + 1, "FilteringMode", DataGridFilteringMode.Contains);
                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "Value", valueData);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ValueExpression", lambda);
                     editor.AddAttribute(i++, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnRadioChangedItem(str, property, attributeDetailss, a, s)));
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                         }
                     }
                     editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
            {
                if (s.IsDynamicFormDropTagBox == true)
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "Name");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();

                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "ProfileName");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Profile");
                    layoutItemBuilders.CloseComponent();

                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
                    layoutItemBuilders.AddAttribute(2, "Caption", "Company Name");
                    layoutItemBuilders.CloseComponent();

                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(3);
                    layoutItemBuilders.AddAttribute(3, "FieldName", "ScreenID");
                    layoutItemBuilders.AddAttribute(3, "Caption", "Screen Name");
                    layoutItemBuilders.CloseComponent();

                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(4);
                    layoutItemBuilders.AddAttribute(4, "FieldName", "ModifiedBy");
                    layoutItemBuilders.AddAttribute(4, "Caption", "Modified By");
                    layoutItemBuilders.CloseComponent();

                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(5);
                    layoutItemBuilders.AddAttribute(5, "FieldName", "ModifiedDate");
                    layoutItemBuilders.AddAttribute(5, "Caption", "Modified Date");
                    layoutItemBuilders.CloseComponent();
                }
                else
                {
                    if (s.DataSourceTable == "DynamicGrid")
                    {
                        if (gridlistss != null)
                        {
                            var qCount = 0;
                            gridlistss.ForEach(q =>
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(qCount);
                            layoutItemBuilders.AddAttribute(qCount, "FieldName", q.Value);
                            layoutItemBuilders.AddAttribute(qCount, "Caption", q.Text);
                            layoutItemBuilders.CloseComponent();
                            qCount++;
                        });
                        }
                    }
                    else
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                    }
                }
            }));
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
             {
                 layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
                 layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
                 layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
                 layoutItemBuilderss.CloseComponent();

             }));
                     }
                     editor.CloseComponent();
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                         }
                     }

                 }
                 else if (s.ControlType == "TagBox")
                 {
                     if (valueData == null && s.IsSetDefaultValue == true)
                     {
                         if (s.DataSourceTable == "Employee")
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                             if (exitsDefaultData != null)
                             {
                                 List<long?> valueDatads = new List<long?>();
                                 valueDatads.Add(applicationUser.UserID);
                                 valueData = valueDatads;
                                 property.SetValue(Data, valueData);
                             }
                         }
                         if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                             if (exitsDefaultData != null)
                             {
                                 List<long?> valueDatads = new List<long?>();
                                 valueDatads.Add(_userEmployee.PlantID);
                                 valueData = valueDatads;
                                 property.SetValue(Data, valueData);
                             }
                         }
                     }
                     List<DropDownOptionsModel?> gridlistss = new List<DropDownOptionsModel?>();
                     if (s.IsDynamicFormDropTagBox == true)
                     {
                         editor.OpenComponent<DxTagBox<DynamicForm, long?>>(j + 1);
                         editor.AddAttribute(j + 1, "Data", _dynamicFormDropDown);
                     }
                     else
                     {
                         gridlistss = _AttributeHeader.DropDownOptionsGridListModel.DropDownGridOptionsModel.Where(ax => ax.DynamicFormId == s.DynamicFormGridDropDownId).FirstOrDefault()?.DropDownOptionsModels;
                         if (s.DataSourceTable == "DynamicGrid")
                         {
                             var collection = _AttributeHeader.DropDownOptionsGridListModel.ObjectData;
                             List<ExpandoObject>? _dynamicformObjectDataList = new List<ExpandoObject>();
                             if (collection != null)
                             {
                                 foreach (var v in (collection as IEnumerable<ExpandoObject>))
                                 {
                                     dynamic eod = v;
                                     var vv = eod.DynamicFormId;
                                     if ((long?)vv == s.DynamicFormGridDropDownId)
                                     {
                                         _dynamicformObjectDataList.Add(v);
                                     }
                                 }
                             }
                             if (gridlistss != null)
                             {
                                 editor.OpenComponent<DxTagBox<ExpandoObject, long?>>(j + 1);
                                 editor.AddAttribute(j + 1, "Data", _dynamicformObjectDataList);
                             }
                         }
                         else
                         {
                             editor.OpenComponent<DxTagBox<AttributeDetails, long?>>(j + 1);
                             editor.AddAttribute(j + 1, "Data", attributeDetailss);
                             editor.AddAttribute(j + 1, "EditFormat", "{0}|{1}");

                         }
                     }
                     editor.AddAttribute(j + 1, "NullText", "Select " + s.DisplayName + "..");
                     editor.AddAttribute(j + 1, "TextFieldName", s.IsDynamicFormDropTagBox == true ? "Name" : "AttributeDetailName");
                     editor.AddAttribute(j + 1, "ValueFieldName", s.IsDynamicFormDropTagBox == true ? "ID" : "AttributeDetailID");
                     editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                     editor.AddAttribute(j + 1, "FilteringMode", DataGridFilteringMode.Contains);
                     editor.AddAttribute(j + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                     editor.AddAttribute(j + 1, "Values", valueData);
                     editor.AddAttribute(j + 1, "ValuesExpression", lambda);
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { property.SetValue(Data, str); }));

                     editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
    {
        if (s.IsDynamicFormDropTagBox == true)
        {
            layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
            layoutItemBuilders.AddAttribute(0, "FieldName", "Name");
            layoutItemBuilders.AddAttribute(0, "Caption", "Name");
            layoutItemBuilders.CloseComponent();

            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
            layoutItemBuilders.AddAttribute(1, "FieldName", "ProfileName");
            layoutItemBuilders.AddAttribute(1, "Caption", "Profile");
            layoutItemBuilders.CloseComponent();

            layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
            layoutItemBuilders.AddAttribute(2, "FieldName", "CompanyName");
            layoutItemBuilders.AddAttribute(2, "Caption", "Company Name");
            layoutItemBuilders.CloseComponent();

            layoutItemBuilders.OpenComponent<DxListEditorColumn>(3);
            layoutItemBuilders.AddAttribute(3, "FieldName", "ScreenID");
            layoutItemBuilders.AddAttribute(3, "Caption", "Screen Name");
            layoutItemBuilders.CloseComponent();

            layoutItemBuilders.OpenComponent<DxListEditorColumn>(4);
            layoutItemBuilders.AddAttribute(4, "FieldName", "ModifiedBy");
            layoutItemBuilders.AddAttribute(4, "Caption", "Modified By");
            layoutItemBuilders.CloseComponent();

            layoutItemBuilders.OpenComponent<DxListEditorColumn>(5);
            layoutItemBuilders.AddAttribute(5, "FieldName", "ModifiedDate");
            layoutItemBuilders.AddAttribute(5, "Caption", "Modified Date");
            layoutItemBuilders.CloseComponent();
        }
        else
        {
            if (s.DataSourceTable == "DynamicGrid")
            {
                if (gridlistss != null)
                {
                    var qCount = 0;
                    gridlistss.ForEach(q =>
    {
        layoutItemBuilders.OpenComponent<DxListEditorColumn>(qCount);
        layoutItemBuilders.AddAttribute(qCount, "FieldName", q.Value);
        layoutItemBuilders.AddAttribute(qCount, "Caption", q.Text);
        layoutItemBuilders.CloseComponent();
        qCount++;
    });
                }
            }
            else
            {
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                layoutItemBuilders.CloseComponent();
                layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                layoutItemBuilders.CloseComponent();
            }
        }
    }));
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true)
                         {
                             if (valueData == null)
                             {
                                 isRequiredCount += 1;
                                 if (isSubmit == true)
                                 {
                                     //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                 }
                             }
                             else
                             {
                                 IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                 if (valueDatas != null)
                                 {
                                     List<long?> listData = valueDatas.ToList();
                                     if (listData.Count() == 0)
                                     {
                                         isRequiredCount += 1;
                                         if (isSubmit == true)
                                         {
                                             //editor.AddAttribute(j + 1, "style", "border-color:red;");
                                         }
                                     }
                                 }
                             }
                         }
                     }
                     editor.CloseComponent();
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                             else
                             {
                                 IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                 if (valueDatas != null)
                                 {
                                     List<long?> listData = valueDatas.ToList();
                                     if (listData.Count() == 0 && isSubmit == true)
                                     {
                                         editor.OpenElement(j + 1, "span");
                                         editor.AddAttribute(j + 1, "class", "text-danger");
                                         editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                         editor.CloseElement();
                                     }
                                 }
                             }
                         }
                     }
                 }
                 else if (s.ControlType == "ListBox")
                 {
                     if (valueData == null && s.IsSetDefaultValue == true)
                     {
                         if (s.DataSourceTable == "Employee")
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == applicationUser.UserID);
                             if (exitsDefaultData != null)
                             {
                                 if (s.IsMultiple == true)
                                 {
                                     List<long?> valueDatads = new List<long?>();
                                     valueDatads.Add(applicationUser.UserID);
                                     valueData = valueDatads;
                                     property.SetValue(Data, valueData);
                                 }
                                 else
                                 {
                                     valueData = applicationUser.UserID;
                                     property.SetValue(Data, valueData);
                                 }
                             }
                         }
                         if (s.DataSourceTable == "Plant" && _userEmployee != null && _userEmployee.PlantID > 0)
                         {
                             var exitsDefaultData = attributeDetailss.FirstOrDefault(f => f.AttributeDetailID == _userEmployee.PlantID);
                             if (exitsDefaultData != null)
                             {
                                 if (s.IsMultiple == true)
                                 {
                                     List<long?> valueDatads = new List<long?>();
                                     valueDatads.Add(_userEmployee.PlantID);
                                     valueData = valueDatads;
                                     property.SetValue(Data, valueData);
                                 }
                                 else
                                 {
                                     valueData = _userEmployee.PlantID;
                                     property.SetValue(Data, valueData);
                                 }
                             }
                         }
                     }
                     editor.OpenComponent<DxListBox<AttributeDetails, long?>>(j + 1);
                     editor.AddAttribute(j + 1, "Data", attributeDetailss);
                     editor.AddAttribute(j + 1, "TextFieldName", "AttributeDetailName");
                     editor.AddAttribute(j + 1, "ValueFieldName", "AttributeDetailID");
                     if (isAccessOnly == true)
                     {
                         editor.AddAttribute(j + 1, "Enabled", s.IsDefaultReadOnly == true ? false : isReadonly);
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Enabled", isAccessOnly);
                     }
                     editor.AddAttribute(j + 1, "ListRenderMode", ListRenderMode.Virtual);
                     editor.AddAttribute(j + 1, "ShowCheckboxes", true);

                     if (s.IsMultiple == true)
                     {
                         editor.AddAttribute(j + 1, "Values", valueData);
                         editor.AddAttribute(j + 1, "ValuesExpression", lambda);
                         editor.AddAttribute(j + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                         editor.AddAttribute(j + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { property.SetValue(Data, str); }));
                     }
                     else
                     {
                         editor.AddAttribute(j + 1, "Value", valueData);
                         editor.AddAttribute(j + 1, "ValueExpression", lambda);
                         editor.AddAttribute(j + 1, "SelectionMode", ListBoxSelectionMode.Single);
                         editor.AddAttribute(j + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { property.SetValue(Data, str); }));
                     }
                     editor.AddAttribute(j + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
    {
        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
        layoutItemBuilders.CloseComponent();
        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
        layoutItemBuilders.CloseComponent();

    }));
                     if (!string.IsNullOrEmpty(s.FormToolTips))
                     {
                         editor.AddAttribute(j + 1, "Buttons", (RenderFragment)((layoutItemBuilderss) =>
     {
         layoutItemBuilderss.OpenComponent<DxEditorButton>(j + 1);
         layoutItemBuilderss.AddAttribute(j + 1, "IconCssClass", "fa fa-info");
         layoutItemBuilderss.AddAttribute(j + 1, "Tooltip", s.FormToolTips);
         layoutItemBuilderss.CloseComponent();

     }));
                     }
                     editor.CloseComponent();
                     if (s.IsDefaultReadOnly == false)
                     {
                         if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                         {
                             if (valueData == null && isSubmit == true)
                             {
                                 editor.OpenElement(j + 1, "span");
                                 editor.AddAttribute(j + 1, "class", "text-danger");
                                 editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                 editor.CloseElement();
                             }
                             else
                             {
                                 if (s.IsMultiple == true)
                                 {
                                     IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueData;
                                     if (valueDatas != null)
                                     {
                                         List<long?> listData = valueDatas.ToList();
                                         if (listData.Count() == 0 && isSubmit == true)
                                         {
                                             editor.OpenElement(j + 1, "span");
                                             editor.AddAttribute(j + 1, "class", "text-danger");
                                             editor.AddContent(j + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                             editor.CloseElement();
                                         }
                                     }
                                 }
                             }
                         }
                     }

                 }
             })));

                            itemBuilder.CloseComponent();
                        }
                    }
                    k++;
                    if (s.ControlType == "ComboBox" && s.IsPlantLoadDependency == true && s.AttributeHeaderDataSource.Count() > 0)
                    {
                        s.AttributeHeaderDataSource.ForEach(ff =>
                {
                    var appendDependency = s.DynamicFormSectionAttributeId + "_" + ff.AttributeHeaderDataSourceId + "_" + ff.DataSourceTable + "_Dependency";
                    var propertyDependency = Data.GetType().GetProperty(appendDependency);
                    if (propertyDependency != null)
                    {
                        var valueDataDependency = propertyDependency.GetValue(Data);
                        var accesspropertyDependency = Expression.Property(Expression.Constant(Data), appendDependency);
                        var lambdapropertyDependency = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(long?)), accesspropertyDependency);
                        itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                        itemBuilder.AddAttribute(i++, "Caption", ff.DisplayName);
                        itemBuilder.AddAttribute(i++, "ColSpanMd", 6);
                        itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
        {
            editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(i + 1);
            editor11.AddAttribute(i + 1, "Data", s.SubAttributeDetails.Where(e => e.DropDownTypeId == ff.DataSourceTable).ToList());
            editor11.AddAttribute(i + 1, "EditFormat", "{0}|{1}");
            editor11.AddAttribute(i + 1, "TextFieldName", "AttributeDetailName");
            editor11.AddAttribute(i + 1, "ValueFieldName", "AttributeDetailID");
            editor11.AddAttribute(i + 1, "NullText", "Select " + s.PlantDropDownWithOtherDataSourceTable + "..");
            editor11.AddAttribute(i + 1, "ListRenderMode", ListRenderMode.Virtual);
            editor11.AddAttribute(i + 1, "FilteringMode", DataGridFilteringMode.Contains);
            editor11.AddAttribute(i + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
            editor11.AddAttribute(i + 1, "Value", valueDataDependency);
            if (isAccessOnly == true)
            {
                editor11.AddAttribute(i + 1, "Enabled", isReadonly);
            }
            else
            {
                editor11.AddAttribute(i + 1, "Enabled", isAccessOnly);
            }
            editor11.AddAttribute(i + 1, "ValueExpression", lambdapropertyDependency);
            editor11.AddAttribute(i + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyDependency.SetValue(Data, str); }));
            editor11.AddAttribute(i + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
    {
        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
        layoutItemBuilders1.CloseComponent();
        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
        layoutItemBuilders1.CloseComponent();
        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
        layoutItemBuilders1.AddAttribute(2, "FieldName", "CompanyName");
        layoutItemBuilders1.AddAttribute(2, "Caption", "Company");
        layoutItemBuilders1.CloseComponent();
    }));
            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
            {
                if (valueDataDependency == null)
                {
                    isRequiredCount += 1;
                    if (isSubmit == true)
                    {
                        //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                    }
                }
            }
            editor11.CloseComponent();
            if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
            {
                if (valueDataDependency == null && isSubmit == true)
                {
                    editor11.OpenElement(i + 1, "span");
                    editor11.AddAttribute(i + 1, "class", "text-danger");
                    editor11.AddContent(i + 1, "This field is Required");
                    editor11.CloseElement();
                }
            }
        })));
                        itemBuilder.CloseComponent();
                    }
                });
                    }
                    if (s.ControlTypeId == 2705 || s.ControlTypeId == 2711 || s.ControlTypeId == 2710)
                    {
                        if (s.IsRadioCheckRemarks == "TextBox" || s.IsRadioCheckRemarks == "Memo")
                        {
                            var appendProNames = s.DynamicFormSectionAttributeId + "_RadioCheckRemarks_" + s.AttributeName;
                            var propertyRemarks = Data.GetType().GetProperty(appendProNames);
                            if (propertyRemarks != null)
                            {
                                var valueDataRemarks = propertyRemarks.GetValue(Data);
                                var accessRemarks = Expression.Property(Expression.Constant(Data), appendProNames);
                                var lambdaRemarks = Expression.Lambda(typeof(Func<>).MakeGenericType(typeof(string)), accessRemarks);
                                itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                                itemBuilder.AddAttribute(i++, "Caption", (string.IsNullOrEmpty(s.RemarksLabelName) ? "Remarks" : s.RemarksLabelName));
                                itemBuilder.AddAttribute(i++, "ColSpanMd", 6);
                                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context1) => ((editor1) =>
                {
                    if (s.IsRadioCheckRemarks == "TextBox")
                    {
                        editor1.OpenComponent<DxTextBox>(i++);
                    }
                    if (s.IsRadioCheckRemarks == "Memo")
                    {
                        editor1.OpenComponent<DxMemo>(i++);
                        editor1.AddAttribute(i++, "Rows", 5);
                    }
                    editor1.AddAttribute(i++, "Text", valueDataRemarks);
                    editor1.AddAttribute(i++, "TextExpression", lambdaRemarks);
                    if (isAccessOnly == true)
                    {
                        editor1.AddAttribute(i + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor1.AddAttribute(i + 1, "Enabled", isAccessOnly);
                    }
                    editor1.AddAttribute(i++, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(i++, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertyRemarks.SetValue(Data, str); }));
                    editor1.CloseComponent();
                })));
                                itemBuilder.CloseComponent();
                            }
                        }
                    }

                    if (s.ControlType == "CheckBox" || s.ControlType == "Radio" || s.ControlType == "RadioGroup")
                    {
                        List<AttributeHeader> SubAttributeHeadersList = new List<AttributeHeader>();
                        if (Data.GetType().GetProperty(s.DynamicAttributeName) != null)
                        {
                            if (s.ControlType == "CheckBox")
                            {
                                var avluess = (bool?)Data.GetType().GetProperty(s.DynamicAttributeName).GetValue(Data);
                                if (avluess == true)
                                {
                                    SubAttributeHeadersList = s.SubAttributeHeaders;
                                }
                            }
                            if (s.ControlType == "Radio" || s.ControlType == "RadioGroup")
                            {
                                var avluess = (long?)Data.GetType().GetProperty(s.DynamicAttributeName).GetValue(Data);
                                if (avluess > 0)
                                {
                                    var attrDetails = _AttributeHeader.AttributeDetails.Where(mm => mm.AttributeDetailID == avluess && mm.DropDownTypeId == null).FirstOrDefault()?.SubAttributeHeaders;
                                    if (attrDetails != null && attrDetails.Count > 0)
                                    {
                                        SubAttributeHeadersList = attrDetails;
                                    }
                                }
                            }
                            if (SubAttributeHeadersList != null && SubAttributeHeadersList.Count > 0)
                            {

                                SubAttributeHeadersList.ForEach(q =>
        {
            int m = 0;
            var appendProSubNames = s.DynamicFormSectionAttributeId + "_" + q.SubDynamicAttributeName;
            if (q.DataSourceTable == "ApplicationMaster")
            {
                if (q.SubApplicationMaster != null && q.SubApplicationMaster.Count() > 0)
                {
                    loadApplicationMasterSubForm(s, q, i, itemBuilder, isAccessOnly, isReadonly);
                }
            }
            else
            {
                var propertySub = Data.GetType().GetProperty(appendProSubNames);
                if (propertySub != null)
                {
                    itemBuilder.OpenComponent<DxFormLayoutItem>(2);
                    itemBuilder.AddAttribute(i++, "Caption", q.Description);
                    itemBuilder.AddAttribute(i++, "ColSpanMd", 6);
                    itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context1) => ((editor1) =>
            {

                var valueDataSub = propertySub.GetValue(Data);
                var accessSub = Expression.Property(Expression.Constant(Data), appendProSubNames);
                var lambdaSub = Expression.Lambda(typeof(Func<>).MakeGenericType(q.SubDataType), accessSub);
                var propertySubType = Nullable.GetUnderlyingType(propertySub.PropertyType) ?? propertySub.PropertyType;
                if (q.ControlType == "TextBox")
                {
                    editor1.OpenComponent<DxTextBox>(m + 1);
                    editor1.AddAttribute(m + 1, "Text", valueDataSub);
                    editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                    // editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                    if (q.IsRequired == true)
                    {
                        if (string.IsNullOrEmpty((string)valueDataSub))
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                // editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "Memo")
                {
                    editor1.OpenComponent<DxMemo>(m + 1);
                    editor1.AddAttribute(m + 1, "Text", valueDataSub);
                    editor1.AddAttribute(m + 1, "TextExpression", lambdaSub);
                    editor1.AddAttribute(m + 1, "Rows", 5);
                    // editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "TextChanged", EventCallback.Factory.Create<System.String>(this, str => { propertySub.SetValue(Data, str); }));
                    if (q.IsRequired == true)
                    {
                        if (string.IsNullOrEmpty((string)valueDataSub))
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (string.IsNullOrEmpty((string)valueDataSub) && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "DateEdit")
                {
                    editor1.OpenComponent<DxDateEdit<DateTime?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Date", valueDataSub);
                    editor1.AddAttribute(m + 1, "DateExpression", lambdaSub);
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "DateChanged", EventCallback.Factory.Create<System.DateTime?>(this, str => { propertySub.SetValue(Data, str); }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "TimeEdit")
                {
                    editor1.OpenComponent<DxTimeEdit<TimeSpan?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Time", valueDataSub);
                    editor1.AddAttribute(m + 1, "TimeExpression", lambdaSub);
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "TimeChanged", EventCallback.Factory.Create<System.TimeSpan?>(this, str => { propertySub.SetValue(Data, str); }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "SpinEdit")
                {
                    if (propertySubType.Name == "Int32")
                    {
                        editor1.OpenComponent<DxSpinEdit<int?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Value", valueDataSub);
                        editor1.AddAttribute(m + 1, "MinValue", 0);
                        //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        editor1.AddAttribute(m + 1, "BindValueMode", BindValueMode.OnInput);
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<int?>(this, str => { propertySub.SetValue(Data, str); }));
                    }
                    if (propertySubType.Name == "Decimal")
                    {
                        editor1.OpenComponent<DxSpinEdit<decimal?>>(m + 1);
                        editor1.AddAttribute(m + 1, "Value", valueDataSub);
                        editor1.AddAttribute(m + 1, "Increment", 0.1M);
                        //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                        editor1.AddAttribute(m + 1, "MinValue", 0M);
                        editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                        editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<decimal?>(this, str => { propertySub.SetValue(Data, str); }));
                    }
                    editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "CheckBox")
                {
                    editor1.OpenComponent<DxCheckBox<bool?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Checked", valueDataSub ?? false);
                    editor1.AddAttribute(m + 1, "CheckedExpression", lambdaSub);
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    //editor1.AddAttribute(i+1, "LabelPosition", LabelPosition.Right);
                    editor1.AddAttribute(m + 1, "CheckedChanged", EventCallback.Factory.Create<bool?>(this, str => { propertySub.SetValue(Data, str); }));
                    if (s.IsRequired == true)
                    {
                        if (valueDataSub == null || (bool)valueDataSub == false)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null || (bool)valueDataSub == false && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "RadioGroup" || q.ControlType == "Radio")
                {
                    editor1.OpenComponent<DxRadioGroup<AttributeDetails, long?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Items", q.SubAttributeDetails);
                    editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                    editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                    editor1.AddAttribute(m + 1, "Value", valueDataSub);
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                    editor1.AddAttribute(m + 1, "Layout", q.AttributeRadioLayout == "Vertical" ? RadioGroupLayout.Vertical : RadioGroupLayout.Horizontal);
                    editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                editor1.AddAttribute(m + 1, "style", "color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "ComboBox")
                {
                    editor1.OpenComponent<DxComboBox<AttributeDetails, long?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Data", q.SubAttributeDetails);
                    editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                    editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                    editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                    editor1.AddAttribute(m + 1, "NullText", "Select " + q.Description + "..");
                    editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor1.AddAttribute(m + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "Value", valueDataSub);
                    // editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                    editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                    editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                    }
                }
                else if (q.ControlType == "TagBox")
                {
                    editor1.OpenComponent<DxTagBox<AttributeDetails, long?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Data", q.SubAttributeDetails);
                    editor1.AddAttribute(m + 1, "EditFormat", "{0}|{1}");
                    editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                    editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                    editor1.AddAttribute(m + 1, "NullText", "Select " + q.Description + "..");
                    editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor1.AddAttribute(m + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor1.AddAttribute(m + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor1.AddAttribute(m + 1, "Values", valueDataSub);
                    editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                    editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor1.OpenElement(m + 1, "span");
                                    editor1.AddAttribute(m + 1, "class", "text-danger");
                                    editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor1.CloseElement();
                                }
                            }
                        }
                    }
                }
                else if (q.ControlType == "ListBox")
                {
                    editor1.OpenComponent<DxListBox<AttributeDetails, long?>>(m + 1);
                    editor1.AddAttribute(m + 1, "Data", q.SubAttributeDetails);
                    editor1.AddAttribute(m + 1, "TextFieldName", "AttributeDetailName");
                    editor1.AddAttribute(m + 1, "ValueFieldName", "AttributeDetailID");
                    //editor1.AddAttribute(m + 1, "Enabled", isReadonly);
                    editor1.AddAttribute(m + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor1.AddAttribute(m + 1, "ShowCheckboxes", true);
                    if (q.IsMultiple == true)
                    {
                        editor1.AddAttribute(m + 1, "Values", valueDataSub);
                        editor1.AddAttribute(m + 1, "ValuesExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                        editor1.AddAttribute(m + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertySub.SetValue(Data, str); }));
                    }
                    else
                    {
                        editor1.AddAttribute(m + 1, "Value", valueDataSub);
                        editor1.AddAttribute(m + 1, "ValueExpression", lambdaSub);
                        editor1.AddAttribute(m + 1, "SelectionMode", ListBoxSelectionMode.Single);
                        editor1.AddAttribute(m + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertySub.SetValue(Data, str); }));
                    }
                    editor1.AddAttribute(m + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                {
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders.CloseComponent();
                    layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders.CloseComponent();
                }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0)
                                    {
                                        isRequiredCount += 1;
                                        if (isSubmit == true)
                                        {
                                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                        }
                                    }
                                }
                            }
                        }
                    }
                    editor1.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataSub == null && isSubmit == true)
                        {
                            editor1.OpenElement(m + 1, "span");
                            editor1.AddAttribute(m + 1, "class", "text-danger");
                            editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor1.CloseElement();
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataSub;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0 && isSubmit == true)
                                    {
                                        editor1.OpenElement(m + 1, "span");
                                        editor1.AddAttribute(m + 1, "class", "text-danger");
                                        editor1.AddContent(m + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                        editor1.CloseElement();
                                    }
                                }
                            }
                        }
                    }
                }
            })));
                    itemBuilder.CloseComponent();
                }
            }
        });

                            }
                        }
                    }
                    if (s.DataSourceTable == "ApplicationMaster" && s.ApplicationMaster != null && s.ApplicationMaster.Count > 0)

                    {
                        loadApplicationMasterForm(s, i, itemBuilder, isAccessOnly, isReadonly);
                    }
                    if (s.DataSourceTable == "ApplicationMasterParent" && s.ApplicationMasterParents != null && s.ApplicationMasterParents.Count() > 0)
                    {
                        loadApplicationMasterParentForm(s, i, itemBuilder, isAccessOnly, isReadonly);
                    }
                });

        }

        if (_dynamicFormWorkFlowSectionNoWorkFlow != null)
        {
            var exitss = _dynamicFormWorkFlowSectionNoWorkFlow.FirstOrDefault(f => f.DynamicFormSectionId == a.DynamicFormSectionId && f.UserId == applicationUser.UserID);
            if (_dynamicform.IsApproval == true)
            {
                isApprovalEnabled = true;
                isVisibleButton = true;
                if (_dynamicformData != null)
                {
                    CheckedApprovalData();
                }
            }
            if (_dynamicformData == null)
            {
                isSaveEnabled = true;
            }
            if (exitss != null)
            {
                isWorkflowEnabled = true; isSaveEnabled = true;
                if (_dynamicformData != null)
                {
                    if (isApproval == true)
                    {
                        IsUploadEnabled = true;
                    }
                }
                //         itemBuilder.OpenComponent<DxFormLayoutItem>(i++);
                //         itemBuilder.AddAttribute(i++, "ColSpanMd", 12);
                //         itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context) => ((editors) =>
                //     {
                //         editors.OpenElement(i++, "button");
                //         editors.AddAttribute(i++, "style", "cursor: not-allowed;pointer - events: none;");
                //         editors.AddAttribute(i++, "class", "btn btn-success");
                //         editors.AddAttribute(i++, "onclick", EventCallback.Factory.Create(this, () => OnToastClick(a.DynamicFormSectionId)));
                //         editors.AddContent(i++, "Next");
                //         editors.CloseElement();
                //     })));

                //         itemBuilder.CloseComponent();
            }
        }
    }));

            layoutItemBuilder.CloseComponent();
        }));

            formLayoutBuilder.CloseComponent();
            //PanelVisible = false;
        });

        }
        //PanelVisible = false;
    };

    void loadApplicationMasterParentForm(DynamicFormSectionAttribute s, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        s.ApplicationMasterParents.ForEach(ab =>
        {
            loadApplicationMasterParentRecursiveForm(s, ab, i, itemBuilder, isAccessOnly, isReadonly, true);
            if (ab.ApplicationMasterParentCodeId > 0)
            {
                loadApplicationMasterParentFormDataList(s, ab, i, itemBuilder, isAccessOnly, isReadonly);
            }
        });
    }
    void loadApplicationMasterParentFormDataList(DynamicFormSectionAttribute s, ApplicationMasterParent ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        var dataList = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == ab.ApplicationMasterParentCodeId);
        if (dataList != null)
        {
            loadApplicationMasterParentRecursiveForm(s, dataList, i, itemBuilder, isAccessOnly, isReadonly, false);
            loadApplicationMasterParentFormDataList(s, dataList, i, itemBuilder, isAccessOnly, isReadonly);
        }
    }
    void OnApplicationMasterParentChangedMultipleItem(IEnumerable<long?> str, PropertyInfo propertyAppMaster, ApplicationMasterParent ab, DynamicFormSectionAttribute s)
    {
        var pervValue = propertyAppMaster.GetValue(Data);
        List<long?> pervValueData = new List<long?>();
        IEnumerable<long?> preValueDatas = (IEnumerable<long?>)pervValue;
        List<long?> currentValueData = new List<long?>();


        // propertyAppMaster.SetValue(Data, str);
        // List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
        // nameDatas.Add(ab);
        // RemoveApplicationMasterParentSingleAllItem(ab, s, nameDatas);
        // if(nameDatas!=null && nameDatas.Count>0)
        // {
        //     var preData = new List<long?>();
        //     nameDatas.ForEach(n=>
        //     {
        //         var curData = new List<long?>();
        //         List<long?> listDatas=new List<long?>();
        //         var nameData = s.DynamicFormSectionAttributeId + "_" + n.ApplicationMasterParentCodeId + "_AppMasterPar";
        //         var propertyAppMastersData = Data.GetType().GetProperty(nameData);
        //         if (propertyAppMastersData != null)
        //         {
        //             var valueDataAppMastersCurrent = (IEnumerable<long?>)propertyAppMastersData.GetValue(Data);
        //             listDatas = valueDataAppMastersCurrent != null ? valueDataAppMastersCurrent.ToList() : new List<long?>();

        //             var days = ApplicationMasterParentDetails.Where(q => q.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId)).ToList();
        //             var dayss = days.Where(q => listDatas.Contains(q.ParentId)).ToList();
        //             var plts = PlantDependencySubAttributeDetails.Where(w => listDatas.Contains(w.ParentId)).FirstOrDefault()?.ApplicationMasterParentCodeId;
        //             if (plts != null)
        //             {
        //                 var getData = ApplicationMasterParentDetails.Where(w => w.ApplicationMasterParentCodeId == plts).ToList();
        //                 if (getData != null && getData.Count() > 0)
        //                 {
        //                     getData.ForEach(r =>
        //                     {
        //                         var exitsDatas = dayss.Where(w => w.AttributeDetailID == r.AttributeDetailID).Count();
        //                         if (exitsDatas == 0)
        //                         {
        //                             ApplicationMasterParentDetails.ForEach(a =>
        //                             {
        //                                 if (r.AttributeDetailID == a.AttributeDetailID)
        //                                 {
        //                                     a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
        //                                 }
        //                             });
        //                         }
        //                     });
        //                 }
        //             }
        //             else
        //             {
        //                 var pls = PlantDependencySubAttributeDetails.Where(w => w.ApplicationMasterParentCodeId == n.ApplicationMasterParentCodeId).ToList();
        //                 if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
        //                 {
        //                     ApplicationMasterParentDetails.ForEach(a =>
        //                     {
        //                         var exits = pls.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
        //                         if (exits > 0)
        //                         {
        //                             a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
        //                         }
        //                     });
        //                 }
        //                 propertyAppMastersData.SetValue(Data, null);
        //             }
        //             if (listDatas != null && listDatas.Count() > 0)
        //             {
        //                 curData = listDatas;
        //             }
        //             if (preData.Count() > 0)
        //             {
        //                 preData.ForEach(t =>
        //                 {
        //                     loadApplicationMasterParentDataLoad(t, s);
        //                 });
        //             }
        //         }
        //         preData = listDatas;
        //     });
        // }



        //setApplicationMasterParentData(nameDatas, s);
        // if (preValueDatas != null)
        // {
        //     pervValueData = preValueDatas != null ? preValueDatas.ToList() : new List<long?>();
        // }
        if (str != null)
        {
            currentValueData = str != null ? str.ToList() : new List<long?>();
        }
        propertyAppMaster.SetValue(Data, str);
        if (currentValueData != null && currentValueData.Count() > 0)
        {
            currentValueData.ForEach(t =>
            {
                List<string?> nameDatas = new List<string?>();
                var dataList = ApplicationMasterParentDetails.FirstOrDefault(f => f.AttributeDetailID == t);
                if (dataList != null)
                {
                    nameDatas.Add(s.DynamicFormSectionAttributeId + "_" + dataList.ApplicationMasterParentCodeId + "_AppMasterPar");
                    var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == dataList.ApplicationMasterParentCodeId);
                    if (listss != null)
                    {
                        RemoveApplicationMasterParentSingleItem(listss, s, nameDatas);
                    }
                }
                if (nameDatas != null && nameDatas.Count() > 0)
                {
                    int i = 0;
                    nameDatas.ForEach(n =>
                    {
                        var propertyAppMastersData = Data.GetType().GetProperty(n);
                        if (propertyAppMastersData != null)
                        {
                            var valueDataAppMastersCurrent = (IEnumerable<long?>)propertyAppMastersData.GetValue(Data);
                            List<long?> pervValueDatas = valueDataAppMastersCurrent != null ? valueDataAppMastersCurrent.ToList() : new List<long?>();
                            var days = ApplicationMasterParentDetails.Where(q => q.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId)).ToList();
                            var dayss = days.Where(q => pervValueDatas.Contains(q.ParentId)).ToList();
                            var plts = PlantDependencySubAttributeDetails.Where(w => pervValueDatas.Contains(w.ParentId)).FirstOrDefault()?.ApplicationMasterParentCodeId;
                            if (plts != null)
                            {
                                var getData = ApplicationMasterParentDetails.Where(w => w.ApplicationMasterParentCodeId == plts).ToList();
                                if (getData != null && getData.Count() > 0)
                                {
                                    getData.ForEach(r =>
                                    {
                                        var exitsDatas = dayss.Where(w => w.AttributeDetailID == r.AttributeDetailID).Count();
                                        if (exitsDatas == 0)
                                        {
                                            ApplicationMasterParentDetails.ForEach(a =>
                                            {
                                                if (r.AttributeDetailID == a.AttributeDetailID)
                                                {
                                                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                                }
                                            });
                                        }
                                    });
                                }
                            }
                            var j = i + 1;
                            if (nameDatas.Count() > j)
                            {
                                var nextItems = nameDatas[j];
                                if (nextItems != null)
                                {
                                    var propertyAppMastersNext = Data.GetType().GetProperty(nextItems);
                                    if (propertyAppMastersNext != null)
                                    {
                                        List<long?> nextValueData = new List<long?>();
                                        var valueDataAppMastersNext = (IEnumerable<long?>)propertyAppMastersNext.GetValue(Data);
                                        if (valueDataAppMastersNext != null)
                                        {
                                            nextValueData = valueDataAppMastersNext != null ? valueDataAppMastersNext.ToList() : new List<long?>();
                                        }
                                        var Lists1 = dayss != null && dayss.Count() > 0 ? dayss.Select(z => (long?)z.AttributeDetailID).ToList() : new List<long?>();
                                        var soCustomerLists = Lists1.Intersect(nextValueData).ToList();
                                        propertyAppMastersNext.SetValue(Data, soCustomerLists);
                                    }
                                }
                            }

                            if (valueDataAppMastersCurrent != null && PlantDependencySubAttributeDetails != null && PlantDependencySubAttributeDetails.Count() > 0)
                            {
                                var plt = PlantDependencySubAttributeDetails.Where(w => valueDataAppMastersCurrent.Contains(w.ParentId)).ToList();
                                if (plt != null && plt.Count() > 0)
                                {
                                    plt.ForEach(a =>
                                    {
                                        var exitss = a.ApplicationMasterParentSectionIds.Where(w => w == s.DynamicFormSectionAttributeId).Count();
                                        if (exitss == 0)
                                        {
                                            a.ApplicationMasterParentSectionIds.Add(s.DynamicFormSectionAttributeId);
                                        }
                                        if (ApplicationMasterParentDetails == null)
                                        {
                                            ApplicationMasterParentDetails = new List<AttributeDetails>();
                                            ApplicationMasterParentDetails.Add(a);
                                        }
                                        else
                                        {
                                            var exitsData = ApplicationMasterParentDetails.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
                                            if (exitsData == 0)
                                            {
                                                ApplicationMasterParentDetails.Add(a);
                                            }
                                        }
                                    });
                                }
                            }
                        }
                        i++;
                    });
                }
            });
        }
        else
        {
            List<ApplicationMasterParent> nameDatas = new List<ApplicationMasterParent>();
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                RemoveApplicationMasterParentSingleAllItem(listss, s, nameDatas);
            }
            if (nameDatas != null && nameDatas.Count() > 0)
            {
                int i = 0;
                nameDatas.ForEach(n =>
                {
                    var nameData = s.DynamicFormSectionAttributeId + "_" + n.ApplicationMasterParentCodeId + "_AppMasterPar";
                    var propertyAppMastersData = Data.GetType().GetProperty(nameData);
                    if (propertyAppMastersData != null)
                    {
                        var pls = PlantDependencySubAttributeDetails.Where(w => w.ApplicationMasterParentCodeId == n.ApplicationMasterParentCodeId).ToList();
                        if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
                        {
                            ApplicationMasterParentDetails.ForEach(a =>
                            {
                                var exits = pls.Where(w => w.AttributeDetailID == a.AttributeDetailID).Count();
                                if (exits > 0)
                                {
                                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                }
                            });
                        }
                        propertyAppMastersData.SetValue(Data, null);
                    }
                });
            }
        }
    }
    void RemoveApplicationMasterParentSingleAllItem(ApplicationMasterParent applicationMasterParent, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<ApplicationMasterParent> nameDatas)
    {
        if (applicationMasterParent != null)
        {
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                nameDatas.Add(listss);
                RemoveApplicationMasterParentSingleAllItem(listss, dynamicFormSectionAttribute, nameDatas);
            }
        }
    }
    void OnApplicationMasterParentChangedSingleItem(long? str, PropertyInfo propertyAppMaster, ApplicationMasterParent ab, DynamicFormSectionAttribute s)
    {
        var pervValue = (long?)propertyAppMaster.GetValue(Data);
        propertyAppMaster.SetValue(Data, str);
        if (pervValue != str)
        {
            RemoveloadApplicationMasterParentDataLoad(pervValue, s);
        }
        if (str > 0)
        {
            loadApplicationMasterParentDataLoad(str, s);
        }

    }
    void RemoveloadApplicationMasterParentDataLoad(long? pervValue, DynamicFormSectionAttribute s)
    {
        if (pervValue != null && ApplicationMasterParentDetails != null)
        {
            List<string?> nameDatas = new List<string?>();
            var dataList = ApplicationMasterParentDetails.FirstOrDefault(f => f.AttributeDetailID == pervValue);
            if (dataList != null)
            {
                var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ApplicationMasterParentCodeId == dataList.ApplicationMasterParentCodeId);
                if (listss != null)
                {
                    RemoveApplicationMasterParentSingleItem(listss, s, nameDatas);
                }
            }
            if (nameDatas != null && nameDatas.Count() > 0)
            {
                nameDatas.ForEach(n =>
                {
                    var propertyAppMasters = Data.GetType().GetProperty(n);
                    if (propertyAppMasters != null)
                    {
                        if (s.ControlType == "ComboBox" || s.ControlType == "ListBox" && s.IsMultiple == false)
                        {
                            var valueDataAppMasters = (long?)propertyAppMasters.GetValue(Data);
                            propertyAppMasters.SetValue(Data, null);
                            if (valueDataAppMasters > 0)
                            {
                                var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == valueDataAppMasters).ToList();
                                if (preList != null && preList.Count() > 0)
                                {
                                    preList.ForEach(a =>
                                    {
                                        a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                    });
                                }
                            }
                        }
                        if (s.ControlType == "TagBox" || s.ControlType == "ListBox" && s.IsMultiple == true)
                        {
                            List<long?> pervValueData = new List<long?>();
                            var valueDataAppMasters = (IEnumerable<long?>)propertyAppMasters.GetValue(Data);
                            if (valueDataAppMasters != null)
                            {
                                pervValueData = valueDataAppMasters != null ? valueDataAppMasters.ToList() : new List<long?>();
                            }
                            pervValueData.ForEach(e =>
                            {
                                if (e > 0)
                                {
                                    var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == e).ToList();
                                    if (preList != null && preList.Count() > 0)
                                    {
                                        preList.ForEach(a =>
                                        {
                                            a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                                        });
                                    }
                                }

                            });
                        }
                    }
                });
            }

        }
        if (ApplicationMasterParentDetails != null && ApplicationMasterParentDetails.Count() > 0)
        {
            var preList = ApplicationMasterParentDetails.Where(w => w.ParentId == pervValue).ToList();
            if (preList != null && preList.Count() > 0)
            {
                preList.ForEach(a =>
                {
                    a.ApplicationMasterParentSectionIds.Remove(s.DynamicFormSectionAttributeId);
                });
            }
        }
    }
    void RemoveApplicationMasterParentSingleItem(ApplicationMasterParent applicationMasterParent, DynamicFormSectionAttribute dynamicFormSectionAttribute, List<string?> nameDatas)
    {
        if (applicationMasterParent != null)
        {
            var listss = _AttributeHeader.ApplicationMasterParent.FirstOrDefault(f => f.ParentId == applicationMasterParent.ApplicationMasterParentCodeId);
            if (listss != null)
            {
                nameDatas.Add(dynamicFormSectionAttribute.DynamicFormSectionAttributeId + "_" + listss.ApplicationMasterParentCodeId + "_AppMasterPar");
                RemoveApplicationMasterParentSingleItem(listss, dynamicFormSectionAttribute, nameDatas);
            }
        }
    }
    void loadApplicationMasterParentRecursiveForm(DynamicFormSectionAttribute s, ApplicationMasterParent ab, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly, bool? isLoadDropdown)
    {
        int l = 0;
        var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterParentCodeId + "_AppMasterPar";
        var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
        if (propertyAppMaster != null)
        {
            var valueDataAppMaster = propertyAppMaster.GetValue(Data);
            var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
            var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyAppMaster);
            var listDataSub = new List<AttributeDetails>();
            if (isLoadDropdown == true)
            {
                listDataSub = ApplicationMasterParentDetails != null ? ApplicationMasterParentDetails.Where(e => e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId).ToList() : new List<AttributeDetails>();
            }
            else
            {
                listDataSub = ApplicationMasterParentDetails != null ? ApplicationMasterParentDetails.Where(e => e.ApplicationMasterParentSectionIds.Contains(s.DynamicFormSectionAttributeId) && e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterParentCodeId == ab.ApplicationMasterParentCodeId).ToList() : new List<AttributeDetails>();
            }
            itemBuilder.OpenComponent<DxFormLayoutItem>(3);
            itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
            itemBuilder.AddAttribute(i++, "ColSpanMd", s.ColSpan);
            itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
        {
            if (s.ControlType == "ComboBox")
            {
                editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "EditFormat", "{0}|{2}");
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                if (isAccessOnly == true)
                {
                    editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                }
                editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnApplicationMasterParentChangedSingleItem(str, propertyAppMaster, ab, s)));
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                {
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders1.AddAttribute(2, "FieldName", "ParentName");
                    layoutItemBuilders1.AddAttribute(2, "Caption", "Parent Name");
                    layoutItemBuilders1.CloseComponent();
                }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                        editor11.CloseElement();
                    }
                }
            }
            if (s.ControlType == "TagBox")
            {
                editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "EditFormat", "{0}|{2}");
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                if (isAccessOnly == true)
                {
                    editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                }
                editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, (str) => OnApplicationMasterParentChangedMultipleItem(str, propertyAppMaster, ab, s)));
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                {
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                    layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                    layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                    layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                    layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                    layoutItemBuilders1.CloseComponent();
                    layoutItemBuilders1.OpenComponent<DxListEditorColumn>(2);
                    layoutItemBuilders1.AddAttribute(2, "FieldName", "ParentName");
                    layoutItemBuilders1.AddAttribute(2, "Caption", "Parent Name");
                    layoutItemBuilders1.CloseComponent();
                }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                        }
                    }
                    else
                    {
                        IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                        if (valueDatas != null)
                        {
                            List<long?> listData = valueDatas.ToList();
                            if (listData.Count() == 0)
                            {
                                isRequiredCount += 1;
                                if (isSubmit == true)
                                {
                                    //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                }
                            }
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, "This field is Required");
                        editor11.CloseElement();
                    }
                    else
                    {
                        IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                        if (valueDatas != null)
                        {
                            List<long?> listData = valueDatas.ToList();
                            if (listData.Count() == 0 && isSubmit == true)
                            {
                                editor11.OpenElement(l + 1, "span");
                                editor11.AddAttribute(l + 1, "class", "text-danger");
                                editor11.AddContent(l + 1, "This field is Required");
                                editor11.CloseElement();
                            }
                        }
                    }
                }
            }
            if (s.ControlType == "ListBox")
            {
                editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                editor11.AddAttribute(l + 1, "Data", listDataSub);
                editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                if (s.IsMultiple == true)
                {
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, (str) => OnApplicationMasterParentChangedMultipleItem(str, propertyAppMaster, ab, s)));
                }
                else
                {
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, (str) => OnApplicationMasterParentChangedSingleItem(str, propertyAppMaster, ab, s)));
                }
                editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(2);
                        layoutItemBuilders.AddAttribute(2, "FieldName", "ParentName");
                        layoutItemBuilders.AddAttribute(2, "Caption", "Parent Name");
                        layoutItemBuilders.CloseComponent();
                    }));
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null)
                    {
                        isRequiredCount += 1;
                        if (isSubmit == true)
                        {
                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                        }
                    }
                    else
                    {
                        if (s.IsMultiple == true)
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                }
                editor11.CloseComponent();
                if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                {
                    if (valueDataAppMaster == null && isSubmit == true)
                    {
                        editor11.OpenElement(l + 1, "span");
                        editor11.AddAttribute(l + 1, "class", "text-danger");
                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                        editor11.CloseElement();
                    }
                    else
                    {
                        if (s.IsMultiple == true)
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
            }
        })));
            itemBuilder.CloseComponent();

        }

    }
    void loadApplicationMasterForm(DynamicFormSectionAttribute s, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        s.ApplicationMaster.ForEach(ab =>
        {
            int l = 0;
            var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + ab.ApplicationMasterCodeId + "_AppMaster";
            var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
            if (propertyAppMaster != null)
            {
                var valueDataAppMaster = propertyAppMaster.GetValue(Data);
                var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
                var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(s.DataType), accesspropertyAppMaster);
                var listDataSub = PlantDependencySubAttributeDetails != null ? PlantDependencySubAttributeDetails.Where(e => e.DropDownTypeId == s.DataSourceTable && e.ApplicationMasterId == ab.ApplicationMasterId).ToList() : new List<AttributeDetails>();

                itemBuilder.OpenComponent<DxFormLayoutItem>(3);
                itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", s.ColSpan);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
            {
                if (s.ControlType == "ComboBox")
                {
                    editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                }
                if (s.ControlType == "TagBox")
                {
                    editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                    }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
                if (s.ControlType == "ListBox")
                {
                    editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listDataSub);
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                    if (s.IsMultiple == true)
                    {
                        editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                        editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                        editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                        {
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                            layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                            layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                            layoutItemBuilders.CloseComponent();
                            layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                            layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                            layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                            layoutItemBuilders.CloseComponent();
                        }));
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            if (s.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0)
                                    {
                                        isRequiredCount += 1;
                                        if (isSubmit == true)
                                        {
                                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                        }
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (s.IsRequired == true && isReadonly == true && isAccessOnly == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            if (s.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0 && isSubmit == true)
                                    {
                                        editor11.OpenElement(l + 1, "span");
                                        editor11.AddAttribute(l + 1, "class", "text-danger");
                                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(s.RequiredMessage) ? s.RequiredMessage : "This field is Required");
                                        editor11.CloseElement();
                                    }
                                }
                            }
                        }
                    }
                }
            })));
                itemBuilder.CloseComponent();

            }
        });
    }
    void loadApplicationMasterSubForm(DynamicFormSectionAttribute s, AttributeHeader q, int i, Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder itemBuilder, bool? isAccessOnly, bool? isReadonly)
    {
        q.SubApplicationMaster.ForEach(ab =>
        {
            int l = 0;
            var appendAppMaster = s.DynamicFormSectionAttributeId + "_" + q.SubDynamicAttributeName + "_" + ab.ApplicationMasterCodeId + "_SubAppMaster";
            var propertyAppMaster = Data.GetType().GetProperty(appendAppMaster);
            if (propertyAppMaster != null)
            {
                var valueDataAppMaster = propertyAppMaster.GetValue(Data);
                var accesspropertyAppMaster = Expression.Property(Expression.Constant(Data), appendAppMaster);
                var lambdapropertyAppMaster = Expression.Lambda(typeof(Func<>).MakeGenericType(q.SubDataType), accesspropertyAppMaster);
                var listSubData = q.SubAttributeDetails != null ? q.SubAttributeDetails.Where(e => e.DropDownTypeId == q.DataSourceTable && e.ApplicationMasterId == ab.ApplicationMasterId).ToList() : new List<AttributeDetails>();
                itemBuilder.OpenComponent<DxFormLayoutItem>(4);
                itemBuilder.AddAttribute(i++, "Caption", "Select " + ab.ApplicationMasterName);
                itemBuilder.AddAttribute(i++, "ColSpanMd", s.ColSpan);
                itemBuilder.AddAttribute(i++, "Template", (RenderFragment<Object>)((context11) => ((editor11) =>
            {
                if (q.ControlType == "ComboBox")
                {
                    editor11.OpenComponent<DxComboBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                    }
                }
                if (q.ControlType == "TagBox")
                {
                    editor11.OpenComponent<DxTagBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    editor11.AddAttribute(l + 1, "EditFormat", "{0}|{1}");
                    editor11.AddAttribute(l + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "NullText", "Select " + ab.ApplicationMasterName + "..");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "FilteringMode", DataGridFilteringMode.Contains);
                    editor11.AddAttribute(l + 1, "ClearButtonDisplayMode", DataEditorClearButtonDisplayMode.Auto);
                    editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                    if (isAccessOnly == true)
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isReadonly);
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Enabled", isAccessOnly);
                    }
                    editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                    editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders1) =>
                    {
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders1.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders1.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders1.CloseComponent();
                        layoutItemBuilders1.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders1.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders1.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders1.CloseComponent();
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor11.AddAttribute(i + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0)
                                {
                                    isRequiredCount += 1;
                                    if (isSubmit == true)
                                    {
                                        //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                            if (valueDatas != null)
                            {
                                List<long?> listData = valueDatas.ToList();
                                if (listData.Count() == 0 && isSubmit == true)
                                {
                                    editor11.OpenElement(l + 1, "span");
                                    editor11.AddAttribute(l + 1, "class", "text-danger");
                                    editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                    editor11.CloseElement();
                                }
                            }
                        }
                    }
                }
                if (q.ControlType == "ListBox")
                {
                    editor11.OpenComponent<DxListBox<AttributeDetails, long?>>(l + 1);
                    editor11.AddAttribute(l + 1, "Data", listSubData);
                    editor11.AddAttribute(i + 1, "TextFieldName", "AttributeDetailName");
                    editor11.AddAttribute(l + 1, "ValueFieldName", "AttributeDetailID");
                    editor11.AddAttribute(l + 1, "ListRenderMode", ListRenderMode.Virtual);
                    editor11.AddAttribute(l + 1, "ShowCheckboxes", true);
                    if (q.IsMultiple == true)
                    {
                        editor11.AddAttribute(l + 1, "Values", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValuesExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Multiple);
                        editor11.AddAttribute(l + 1, "ValuesChanged", EventCallback.Factory.Create<IEnumerable<long?>>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    else
                    {
                        editor11.AddAttribute(l + 1, "Value", valueDataAppMaster);
                        editor11.AddAttribute(l + 1, "ValueExpression", lambdapropertyAppMaster);
                        editor11.AddAttribute(l + 1, "SelectionMode", ListBoxSelectionMode.Single);
                        editor11.AddAttribute(l + 1, "ValueChanged", EventCallback.Factory.Create<long?>(this, str => { propertyAppMaster.SetValue(Data, str); }));
                    }
                    editor11.AddAttribute(l + 1, "ChildContent", (RenderFragment)((layoutItemBuilders) =>
                    {
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(0);
                        layoutItemBuilders.AddAttribute(0, "FieldName", "AttributeDetailName");
                        layoutItemBuilders.AddAttribute(0, "Caption", "Name");
                        layoutItemBuilders.CloseComponent();
                        layoutItemBuilders.OpenComponent<DxListEditorColumn>(1);
                        layoutItemBuilders.AddAttribute(1, "FieldName", "Description");
                        layoutItemBuilders.AddAttribute(1, "Caption", "Description");
                        layoutItemBuilders.CloseComponent();
                    }));
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null)
                        {
                            isRequiredCount += 1;
                            if (isSubmit == true)
                            {
                                //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                            }
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0)
                                    {
                                        isRequiredCount += 1;
                                        if (isSubmit == true)
                                        {
                                            //editor1.AddAttribute(m + 1, "style", "border-color:red;");
                                        }
                                    }
                                }
                            }
                        }
                    }
                    editor11.CloseComponent();
                    if (q.IsRequired == true)
                    {
                        if (valueDataAppMaster == null && isSubmit == true)
                        {
                            editor11.OpenElement(l + 1, "span");
                            editor11.AddAttribute(l + 1, "class", "text-danger");
                            editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                            editor11.CloseElement();
                        }
                        else
                        {
                            if (q.IsMultiple == true)
                            {
                                IEnumerable<long?> valueDatas = (IEnumerable<long?>)valueDataAppMaster;
                                if (valueDatas != null)
                                {
                                    List<long?> listData = valueDatas.ToList();
                                    if (listData.Count() == 0 && isSubmit == true)
                                    {
                                        editor11.OpenElement(l + 1, "span");
                                        editor11.AddAttribute(l + 1, "class", "text-danger");
                                        editor11.AddContent(l + 1, !string.IsNullOrEmpty(q.RequiredMessage) ? q.RequiredMessage : "This field is Required");
                                        editor11.CloseElement();
                                    }
                                }
                            }
                        }
                    }
                }
            })));
                itemBuilder.CloseComponent();

            }
        });
    }
}

