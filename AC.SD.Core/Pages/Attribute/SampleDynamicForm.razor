@page "/DynamicMasterSetup/sampledynamic"
@page "/DynamicMasterSetup/sampledynamic/{SessionIds:guid}"
@using System.ComponentModel.DataAnnotations;
@using global::Core.AttributeDynamicData;
@using global::Core.Entities.Views;
@using global::Core.Entities;
@inject IMediator Mediator
@using Application.Queries;
@using MediatR
@using global::Core.EntityModels;
@using global::Core.Repositories.Query;
@inject AC.SD.Core.Services.ToastService toastService
@inject ILocalStorageService<ApplicationUser> _localStorageService
@inject IJSRuntime JSRuntime;
@inject NavigationManager NavigationManager






@code {
    [Parameter]
    public Guid SessionIds { get; set; }
    private List<DynamicForm> _dynamicform;
    //  private List<AttributeHeader> ControlType;
    string ControlType;
    string DataType;
    List<string> AttributeList = new List<string>();

    protected override async Task OnInitializedAsync()
    {

        _dynamicform = await Mediator.Send(new GetAllDynamicFormLst(SessionIds));
        var splite = _dynamicform[0].AttributeID;
        string[] attributeidList = splite.Split(",");
        foreach (string author in attributeidList)
        {

            var list = await Mediator.Send(new GetAllAttributeNameList(author));
           
            ControlType = list[0].ControlType;
            var t2 = "[FieldType(FieldType."+ @ControlType + ")]";
            var t3 = "[Display(Name =" + list[0].EntryMask + " )]";
            if(ControlType == "TextBox" || ControlType == "ComboBox" )
            {
                DataType = "string";
            }

            if (ControlType == "DateEdit")
            {
                DataType = "DateTime";
            }

            if (ControlType == "CheckBox")
            {
                DataType = "bool";
            }
            if (ControlType == "SpinEdit")
            {
                DataType = "int";
            }
            var t4 = "public"+" "+ @DataType +" "+ list[0].AttributeName + "{ get; set; };";
            AttributeList.Add(t2);
            AttributeList.Add(t3);
            AttributeList.Add(t4);



        }
    }

   
}

