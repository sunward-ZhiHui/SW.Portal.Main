@page "/chartpages"
@using Application.Queries;
@using MediatR;
@using global::Core.Entities;
@inject IMediator Mediator

<DxPieChart Data="@_types"
            Diameter="diameter"
            InnerDiameter="innerDiameter"
            CustomizeSeriesPoint="@CustomizeSeriesPoint"
            T="EmailTopics"
SeriesClick="OnClick">
    <DxPieChartSeries T="EmailTopics"
                      TArgument="long"
                      TValue="double"
                      ValueField="si => si.ID"
                      ArgumentField="si => si.TopicFrom"
                     
                      SummaryMethod="Enumerable.Sum">
        <DxChartSeriesLabel Visible="showLabels"
                            Position="labelPosition"
                            ValueFormat="ChartElementFormat.Thousands(1)">
            <DxChartSeriesLabelConnector Visible="true" />
        </DxChartSeriesLabel>
    </DxPieChartSeries>
    <DxChartTooltip Enabled="true"
                    Position="RelativePosition.Outside">
        <div style="margin: 0.75rem">
            <div class="fw-bold">@context.Point.Argument</div>
            <div>Sales: @($"${context.Point.Value:#,0.}")</div>
        </div>
    </DxChartTooltip>
    <DxChartTitle Text="Email Counts">
        <DxChartSubTitle Text="Chart" />
    </DxChartTitle>
    <DxChartLegend HorizontalAlignment="HorizontalAlignment.Center"
                   VerticalAlignment="VerticalEdge.Bottom"
                   Position="RelativePosition.Outside"
                   Orientation="Orientation.Horizontal" />
</DxPieChart>

<html>
<head>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
* {
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

/* Float four columns side by side */
.column {
  float: left;
  width: 25%;
  padding: 0 5px;
}

.row {margin: 0 -5px;}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

/* Responsive columns */
.media screen and (max-width: 600px) {
  .column {
    width: 100%;
    display: block;
    margin-bottom: 10px;
  }
}

/* Style the counter cards */
.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  padding: 16px;
  text-align: center;
  background-color: whitesmoke;
  color: black;
}

.fa {font-size:50px;}
</style>
</head>
<body>

    <h2>Section Counter</h2>
   
    <br>

        <div class="row">
          <div class="column">
            <div class="card">
              <p><i class="fa fa-user"></i></p>
                <h3>@_EmailCount</h3>
              <p>EmailTopics</p>
            </div>
          </div>
        </div>
</body>
</html>
@code {
    IEnumerable<EmailTopics>? _types;
    long _EmailCount;
    double? diameter = null;
    double innerDiameter = 0.5;
    bool showLabels = true;
    RelativePosition labelPosition = RelativePosition.Outside;
    protected override async Task OnInitializedAsync()
    {
        _types = await Mediator.Send(new GetEmailDasboard());
        var lst = await Mediator.Send(new GetEmployeeCount());
        _EmailCount = lst[0].HeadCount.Value;
    }
    void OnClick()
    {
        
    }
    protected void CustomizeSeriesPoint(ChartSeriesPointCustomizationSettings settings)
    {
        if (settings.Point.Argument.ToString() == "Denver")
            settings.PointAppearance.Color = System.Drawing.Color.Yellow;
    }
}
