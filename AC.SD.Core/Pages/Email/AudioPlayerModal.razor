@using DevExpress.Blazor

<DxPopup Visible="IsVisible"
         VisibleChanged="HandleVisibleChanged"
         CloseOnOutsideClick="true"
         ShowCloseButton="true"
         Width="400px"
         HeaderText="Audio Player"
         Position="PopupPosition.WindowCenter"
         ShowFooter="false">

    @if (!string.IsNullOrEmpty(AudioSource))
    {
        <div class="audio-wrapper">
            <audio controls autoplay style="width: 100%;">
                <source src="@AudioSource" type="audio/wav" />
                Your browser does not support the audio element.
            </audio>
        </div>
    }

</DxPopup>

@code {
    [Parameter] public string? AudioSource { get; set; }
    [Parameter] public long? DocumentId { get; set; }

    [Parameter] public bool IsVisible { get; set; }
    [Parameter] public EventCallback<bool> IsVisibleChanged { get; set; }
    [Parameter] public EventCallback OnClosed { get; set; }

    private async Task HandleVisibleChanged(bool visible)
    {
        await IsVisibleChanged.InvokeAsync(visible);

        if (!visible)
        {
            await OnClosed.InvokeAsync();
        }
    }
}
