@using Application.Commands;
@using Application.Queries;
@using MediatR
@using global::Core.Entities.Views;
@using global::Core.Entities;
@inject IMediator Mediator
@using DevExpress.Export
@using Application.Response;
@page "/EmployeeForm"


<DxFormLayout CssClass="w-100">
    <DxFormLayoutGroup Caption="Personal Information" ColSpanMd="6">
        <DxFormLayoutItem Caption="First Name" ColSpanMd="12">
            <DxTextBox @bind-Text="@employee.FirstName" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Last Name" ColSpanMd="12">
            <DxTextBox @bind-Text="@employee.LastName" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Nick Name:" ColSpanMd="12">
            <DxTextBox @bind-Date="@employee.NickName" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Gender" ColSpanMd="12">
            <DxComboBox Data="@GenderList" @bind-Value="@employee.Gender"></DxComboBox>
        </DxFormLayoutItem>
    </DxFormLayoutGroup>
    <DxFormLayoutGroup Caption="Login Credentials" ColSpanMd="6">
        <DxFormLayoutItem Caption="Login ID" ColSpanMd="12">
            <DxTextBox @bind-Text="@employee.LoginID" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Password" ColSpanMd="12">
            <DxTextBox Password="true" @bind-Text="@employee.LoginPassword" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="User Role" ColSpanMd="12">
            <DxComboBox Data="@_roles"
                        NullText="Select Role..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="RoleName"
                        ValueFieldName="RoleID"
                        @bind-Value="@employee.RoleID" />
        </DxFormLayoutItem>
    </DxFormLayoutGroup>
    <DxFormLayoutGroup Caption="Main Employment Information" ColSpanMd="12">
        <DxFormLayoutItem Caption="Company" ColSpanMd="6">
            <DxComboBox Data="@_plantItems"
                        NullText="Select Company..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="Description"
                        ValueFieldName="PlantID"
                        @bind-Value="@employee.PlantID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Section" ColSpanMd="6">
            <DxComboBox Data="@_sectionItems"
                        NullText="Select Section..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="SectionName"
                        ValueFieldName="SectionID"
                        @bind-Value="@employee.SectionID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Division" ColSpanMd="6">
            <DxComboBox Data="@_divisionsItems"
                        NullText="Select Division..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="Name"
                        ValueFieldName="DivisionID"
                        @bind-Value="@employee.DivisionID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Sub Section" ColSpanMd="6">
            <DxComboBox Data="@_subSectionItems"
                        NullText="Select Division..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="SubSectionName"
                        ValueFieldName="SubSectionID"
                        @bind-Value="@employee.SubSectionID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Department" ColSpanMd="6">
            <DxComboBox Data="@_departmentItems"
                        NullText="Select Department..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="DepartmentName"
                        ValueFieldName="DepartmentID"
                        @bind-Value="@employee.DepartmentID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Level" ColSpanMd="6">
            <DxComboBox Data="@_leveMasterItems"
                        NullText="Select Level..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="Name"
                        ValueFieldName="LevelID"
                        @bind-Value="@employee.LevelID" />

        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Employment Type" ColSpanMd="6">
            <DxComboBox Data="@_employmentTypeItems"
                        NullText="Select Employment Type..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="Value"
                        ValueFieldName="ApplicationMasterDetailId"
                        @bind-Value="@employee.TypeOfEmployeement" />
        </DxFormLayoutItem>
    </DxFormLayoutGroup>
    <DxFormLayoutGroup Caption="Communication Infromation" ColSpanMd="12">
        <DxFormLayoutItem Caption="User Role" ColSpanMd="4">
            <DxComboBox Data="@_languageMasterItems"
                        NullText="Select Language..."
                        FilteringMode="DataGridFilteringMode.Contains"
                        TextFieldName="Name"
                        ValueFieldName="LanguageId"
                        @bind-Value="@employee.LanguageID" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Extension" ColSpanMd="4">
            <DxTextBox @bind-Text="@employee.Extension" />
        </DxFormLayoutItem>
        <DxFormLayoutItem Caption="Speed Dial" ColSpanMd="4">
            <DxTextBox @bind-Text="@employee.SpeedDial" />
        </DxFormLayoutItem>
    </DxFormLayoutGroup>

</DxFormLayout>

@code {
    private List<LanguageMaster> _languageMasterItems;
    private List<ApplicationMasterDetail> _employmentTypeItems;
    private List<ApplicationRole> _roles;
    private List<ViewPlants> _plantItems;
    private List<CodeMaster> _stausItems;
    private List<ViewDepartment> _departmentItems;
    private List<ViewDivision> _divisionsItems;
    private List<ViewDesignation> _designationItems;
    private List<ViewSection> _sectionItems;
    private List<ViewSubSection> _subSectionItems;
    private List<ViewLevel> _leveMasterItems;
    EmployeeResponse employee = new EmployeeResponse();
    List<string> GenderList = new List<string>() { "Male", "Female" };
    protected override async Task OnInitializedAsync()
    {
        _roles = await Mediator.Send(new GetAllRoleQuery());
        _departmentItems = await Mediator.Send(new GetAllDepartmentQuery());
        _plantItems = await Mediator.Send(new GetAllPlantQuery());
        _stausItems = await Mediator.Send(new GetAllCodeMasterQuery("Status"));
        _divisionsItems = await Mediator.Send(new GetAllDivisionQuery());
        _sectionItems = await Mediator.Send(new GetAllSectionQuery());
        _subSectionItems = await Mediator.Send(new GetAllSubSectionQuery());
        _designationItems = await Mediator.Send(new GetAllDesignationQuery());
        _leveMasterItems = await Mediator.Send(new GetAllLevelMasterQuery());
        _languageMasterItems = await Mediator.Send(new GetAllLanguageQuery());
        employee.EmployeeID = 1;
        employee.FirstName = "Karuppusamy";
        employee.LastName = "A";
        employee.NickName = "Ga";
        employee.Gender = "Male";
    }
}
