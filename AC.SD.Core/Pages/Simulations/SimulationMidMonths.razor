@using Application.Queries;
@using MediatR
@inject IMediator Mediator
@using DevExpress.Export
@using global::Core.Entities;
@using global::Core.Entities.Views;
@using global::Core.Repositories.Query;
@using global::Core.EntityModels;
@inject ILocalStorageService<ApplicationUser> _localStorageService
@page "/simulationMidMonth"
<div class="menu-bar-content-container col-md-12">
    <div class="card w-100" style="margin-bottom:1px;">



        <div class="card-body p-0">

            <DxMenu CollapseItemsToHamburgerMenu="true"
                    CollapseItemToIconMode="MenuCollapseItemToIconMode.Sequentially"
                    DisplayMode="MenuDisplayMode.Auto">

                <Items>
                    <DxMenuItem Position="ItemPosition.End" title="Search And Filter" IconCssClass="fa fa-filter" Click="@(() => OnFileProfiltefilter())" id=@($"flyout-overview-target-container-FilterDocuments") />
                </Items>
            </DxMenu>

        </div>


    </div>
</div>
<DxLoadingPanel @bind-Visible="PanelVisible"
                IsContentBlocked="true"
                ApplyBackgroundShading="true"
                IndicatorAreaVisible="false"
                Text="Fetching Data...">
    <DxGrid @ref="Grid" Data="@_simulationItems" ShowGroupPanel="true" ShowGroupedColumns="true" ShowSearchBox="true" CustomizeElement="Grid_CustomizeElement"
            PagerNavigationMode="PagerNavigationMode.InputBox"
            PageSizeSelectorVisible="true"
            PageSizeSelectorAllRowsItemVisible="true"
            PageSizeSelectorItems="@(new int[] { 5,10,20 })"
            PageSize="20"
            SelectionMode="GridSelectionMode.Multiple"
            SelectAllCheckboxMode="GridSelectAllCheckboxMode.AllPages"
            VirtualScrollingEnabled="true"
            AutoExpandAllGroupRows="true"
            CssClass="ch-360"
            style="height: calc(100vh - 250px);">
        <Columns>

            <DxGridDataColumn FieldName="MethodCode" Caption="Generic Code" GroupIndex="0" Width="300" FixedPosition="GridColumnFixedPosition.Left" />
            <DxGridDataColumn FieldName="ItemNo" Width="300" FixedPosition="GridColumnFixedPosition.Left" />
            <DxGridDataColumn FieldName="PackSize" Width="200" FixedPosition="GridColumnFixedPosition.Left" />
            <DxGridBandColumn Caption="@Acheader" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="ApexQty" DisplayFormat="n2" Caption="Apex" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ApexQty > 0 ? (Convert.ToDecimal(item.ApexQty.GetValueOrDefault(0).ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="AntahQty" DisplayFormat="n2" Caption="Antah" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.AntahQty > 0 ? (Convert.ToDecimal(item.AntahQty.GetValueOrDefault(0).ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="MissQty" DisplayFormat="n2" Caption="MSS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.MissQty > 0 ? (Convert.ToDecimal(item.MissQty.GetValueOrDefault(0).ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PxQty" DisplayFormat="n2" Caption="PX" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PxQty > 0 ? (Convert.ToDecimal(item.PxQty.GetValueOrDefault(0).ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="AcSum" DisplayFormat="n2" Caption="AC Total" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.AcSum > 0 ? (Convert.ToDecimal(item.AcSum.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridDataColumn FieldName="SymlQty" DisplayFormat="n2" Caption="AC in Units" Width="100">
                <CellDisplayTemplate>
                    @{
                        var item = (INPCalendarPivotModel)context.DataItem;
                    }
                    @((item.SymlQty > 0 ? (Convert.ToDecimal(item.SymlQty.GetValueOrDefault(0).ToString("0.00"))) : ""))
                </CellDisplayTemplate>
            </DxGridDataColumn>
            <DxGridDataColumn FieldName="ThreeMonthACQty" DisplayFormat="n2" Caption="AC Unit X 3" Width="100">
                <CellDisplayTemplate>
                    @{
                        var item = (INPCalendarPivotModel)context.DataItem;
                    }
                    @((item.ThreeMonthACQty > 0 ? (Convert.ToDecimal(item.ThreeMonthACQty.ToString("0.00"))) : ""))
                </CellDisplayTemplate>
            </DxGridDataColumn>
            <DxGridDataColumn FieldName="ProdRecipe" Caption="Register Batch Size" Width="100">
            </DxGridDataColumn>
            <DxGridBandColumn Caption="@CurrentBatchSize" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="BatchSize90" Caption="@BatchSize90" Width="100">
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="Roundup1" Caption="Count" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Roundup1 > 0 ? (Convert.ToDecimal(item.Roundup1.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Roundup2" Caption="Round Up" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Roundup2 > 0 ? (Convert.ToDecimal(item.Roundup2.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@StbPreheader" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="PreApexStockBalance" Caption="Apex" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreApexStockBalance > 0 ? (Convert.ToDecimal(item.PreApexStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreAntahStockBalance" Caption="Antah" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreAntahStockBalance > 0 ? (Convert.ToDecimal(item.PreAntahStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreMsbStockBalance" Caption="MSS" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreMsbStockBalance > 0 ? (Convert.ToDecimal(item.PreMsbStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PrePsbStockBalance" Caption="PX" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PrePsbStockBalance > 0 ? (Convert.ToDecimal(item.PrePsbStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreSgTenderStockBalance" Caption="SWSIN" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreSgTenderStockBalance > 0 ? (Convert.ToDecimal(item.PreSgTenderStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreMyStockBalance" Caption="SWMY" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreMyStockBalance > 0 ? (Convert.ToDecimal(item.PreMyStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreOtherStoreQty" Caption="Other Store" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreOtherStoreQty > 0 ? (Convert.ToDecimal(item.PreOtherStoreQty.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PrewipQty" Caption="WIP Stock" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PrewipQty > 0 ? (Convert.ToDecimal(item.PrewipQty.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreStockBalance" Caption="Total Stock Balance" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreStockBalance > 0 ? (Convert.ToDecimal(item.PreStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PreStockHoldingBalance" Caption="No. of mth" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PreStockHoldingBalance > 0 ? (Convert.ToDecimal(item.PreStockHoldingBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Stbheader" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="ApexStockBalance" Caption="Apex" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ApexStockBalance > 0 ? (Convert.ToDecimal(item.ApexStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="AntahStockBalance" Caption="Antah" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.AntahStockBalance > 0 ? (Convert.ToDecimal(item.AntahStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="MsbStockBalance" Caption="MSS" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.MsbStockBalance > 0 ? (Convert.ToDecimal(item.MsbStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="PsbStockBalance" Caption="PX" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.PsbStockBalance > 0 ? (Convert.ToDecimal(item.PsbStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="SgTenderStockBalance" Caption="SWSIN" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.SgTenderStockBalance > 0 ? (Convert.ToDecimal(item.SgTenderStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="MyStockBalance" Caption="SWMY" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.MyStockBalance > 0 ? (Convert.ToDecimal(item.MyStockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="OtherStoreQty" Caption="Other Store" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.OtherStoreQty > 0 ? (Convert.ToDecimal(item.OtherStoreQty.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="DeliverynotReceived" Caption="In Transit" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.DeliverynotReceived > 0 ? (Convert.ToDecimal(item.DeliverynotReceived.GetValueOrDefault(0).ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="InterCompanyTransitQty" Caption="In T/intercompany" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.InterCompanyTransitQty > 0 ? (Convert.ToDecimal(item.InterCompanyTransitQty.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="StockBalance" Caption="Stock Balance" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.StockBalance > 0 ? (Convert.ToDecimal(item.StockBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="StockHoldingBalance" Caption="No. of mth" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.StockHoldingBalance > 0 ? (Convert.ToDecimal(item.StockHoldingBalance.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Rework" Caption="Rework" Width="100"></DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month1" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc1" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc1 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc1.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month1" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month1 > 0 ? (Convert.ToDecimal(item.Month1.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock1" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock1 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock1.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket1" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected1" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected1 > 0 ? (Convert.ToDecimal(item.ProductionProjected1.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month2" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc2" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc2 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc2.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month2" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month2 > 0 ? (Convert.ToDecimal(item.Month2.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock2" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock2 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock2.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket2" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected2" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected2 > 0 ? (Convert.ToDecimal(item.ProductionProjected2.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month3" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc3" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc3 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc3.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month3" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month3 > 0 ? (Convert.ToDecimal(item.Month3.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock3" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock3 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock3.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket3" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected3" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected3 > 0 ? (Convert.ToDecimal(item.ProductionProjected3.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month4" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc4" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc4 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc4.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month4" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month4 > 0 ? (Convert.ToDecimal(item.Month4.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock4" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock4 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock4.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket4" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected4" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected4 > 0 ? (Convert.ToDecimal(item.ProductionProjected4.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month5" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc5" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc5 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc5.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month5" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month5 > 0 ? (Convert.ToDecimal(item.Month5.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock5" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock5 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock5.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket5" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected5" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected5 > 0 ? (Convert.ToDecimal(item.ProductionProjected5.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month6" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc6" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc6 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc6.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month6" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month6 > 0 ? (Convert.ToDecimal(item.Month6.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock6" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock6 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock6.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket6" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected6" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected6 > 0 ? (Convert.ToDecimal(item.ProductionProjected6.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month7" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc7" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc7 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc7.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month7" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month7 > 0 ? (Convert.ToDecimal(item.Month7.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock7" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock7 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock7.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket7" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected7" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected7 > 0 ? (Convert.ToDecimal(item.ProductionProjected7.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month8" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc8" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc8 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc8.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month8" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month8 > 0 ? (Convert.ToDecimal(item.Month8.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock8" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock8 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock8.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket8" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected8" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected8 > 0 ? (Convert.ToDecimal(item.ProductionProjected8.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month9" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc9" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc9 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc9.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month9" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month9 > 0 ? (Convert.ToDecimal(item.Month9.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock9" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock9 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock9.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket9" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected9" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected9 > 0 ? (Convert.ToDecimal(item.ProductionProjected9.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month10" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc10" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc10 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc10.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month10" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month10 > 0 ? (Convert.ToDecimal(item.Month10.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock10" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock10 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock10.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket10" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected10" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected10 > 0 ? (Convert.ToDecimal(item.ProductionProjected10.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month11" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc11" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc11 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc11.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month11" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month11 > 0 ? (Convert.ToDecimal(item.Month11.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock11" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock11 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock11.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket11" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected11" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected11 > 0 ? (Convert.ToDecimal(item.ProductionProjected11.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridBandColumn Caption="@Month12" CaptionAlignment="GridTextAlignment.Center" Width="200">
                <Columns>
                    <DxGridDataColumn FieldName="AddhocCust" Caption="" Width="100">
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="BlanketAddhoc12" Caption="Ad Hoc" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.BlanketAddhoc12 > 0 ? (Convert.ToDecimal(item.BlanketAddhoc12.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Month12" Caption="Proj. Inv" DisplayFormat="n2" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.Month12 > 0 ? (Convert.ToDecimal(item.Month12.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProjectedHoldingStock12" DisplayFormat="n2" Caption="Prod. Proj." Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProjectedHoldingStock12 > 0 ? (Convert.ToDecimal(item.ProjectedHoldingStock12.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                    <DxGridDataColumn FieldName="Ticket12" Caption="Production Ticket" Width="100"></DxGridDataColumn>
                    <DxGridDataColumn FieldName="ProductionProjected12" DisplayFormat="n2" Caption="Proj. HS" Width="100">
                        <CellDisplayTemplate>
                            @{
                                var item = (INPCalendarPivotModel)context.DataItem;
                            }
                            @((item.ProductionProjected12 > 0 ? (Convert.ToDecimal(item.ProductionProjected12.ToString("0.00"))) : ""))
                        </CellDisplayTemplate>
                    </DxGridDataColumn>
                </Columns>
            </DxGridBandColumn>
            <DxGridDataColumn FieldName="Remarks" Caption="Remarks" Width="300" />
        </Columns>
        <ToolbarTemplate>
            <DxToolbar>
                <DxToolbarItem Text="Export to XLSX" Click="ExportXlsx_Click" BeginGroup="true" />
                <DxToolbarItem Text="Export to XLS" Click="ExportXls_Click" BeginGroup="true" />
                <DxToolbarItem Text="Export to CSV" Click="ExportCsv_Click" BeginGroup="true" />

            </DxToolbar>
        </ToolbarTemplate>
        <TotalSummary>
            <DxGridSummaryItem SummaryType="GridSummaryItemType.Count" FieldName="ItemNo" />
        </TotalSummary>
    </DxGrid>
</DxLoadingPanel>
<DxFlyout @bind-IsOpen=IsFilterOpen
          PositionTarget=@($"#flyout-overview-target-container-FilterDocuments")
          RestrictionTarget="#Navigation-Flyout-Customization"
          AnimationType="FlyoutAnimationType.Fade"
          HeaderVisible="true"
          HeaderText="Search Document"
          FooterVisible="true"
          FooterCssClass="custom-flyout-footer"
          CloseOnOutsideClick="false"
          MinWidth="500" MinHeight="200" MaxWidth="1000px" MaxHeight="800"
          PreventCloseOnPositionTargetClick="true">
    <BodyContentTemplate Context="PopupContext">
        <DxFormLayout CssClass="w-100">
            <DxFormLayoutItem Caption="Opening Balance Month" ColSpanMd="12">
                <DxDateEdit NullText="Select a Opening Balance Month..." @bind-Date="@dateRangeModel.StockMonth" ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto" CssClass="cw-320" />
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="Company" ColSpanMd="12">
                <DxComboBox Data="@_plantItems"
                            NullText="Select Company..."
                            ListRenderMode="ListRenderMode.Virtual"
                            SearchMode="ListSearchMode.Default"
                            SearchFilterCondition="ListSearchFilterCondition.Contains"
                            TextFieldName="NavCompany"
                            ValueFieldName="PlantID"
                            @bind-Value="@dateRangeModel.CompanyId" ShowValidationIcon="true">
                    <Columns>
                        <DxListEditorColumn FieldName="@nameof(ViewPlants.PlantCode)"
                                            Caption="Company Code"
                                            Width="180px" />
                        <DxListEditorColumn FieldName="@nameof(ViewPlants.Description)"
                                            Caption="Description" />
                        <DxListEditorColumn FieldName="@nameof(ViewPlants.NavCompany)"
                                            Caption="Nav Company" />
                    </Columns>
                </DxComboBox>
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="" ColSpanMd="6">
                <DxCheckBox Checked="@dateRangeModel.IsSteroids" CheckedExpression="@(() => dateRangeModel.IsSteroids)" CheckedChanged="@((bool value) => CheckedVisibleChanged(value))">Steroid</DxCheckBox>
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="" ColSpanMd="6">
                <DxCheckBox Checked="@dateRangeModel.IsNonSteroids" CheckedExpression="@(() => dateRangeModel.IsNonSteroids)" CheckedChanged="@((bool value) => CheckedReadWriteChanged(value))">Non Steroid</DxCheckBox>
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="Version" ColSpanMd="12">
                <DxComboBox Data="@_versionItems"
                            NullText="Select Version..."
                            ListRenderMode="ListRenderMode.Virtual"
                            SearchMode="ListSearchMode.Default"
                            SearchFilterCondition="ListSearchFilterCondition.Contains"
                            TextFieldName="Value"
                            ValueFieldName="Id"
                            ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                            @bind-Value="@dateRangeModel.VersionId" ShowValidationIcon="true">
                </DxComboBox>
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="Sales Category" ColSpanMd="12">
                <DxComboBox Data="@_salesCategoryItems"
                            NullText="Select Sales Category..."
                            ListRenderMode="ListRenderMode.Virtual"
                            SearchMode="ListSearchMode.Default"
                            SearchFilterCondition="ListSearchFilterCondition.Contains"
                            TextFieldName="Text"
                            ValueFieldName="Id"
                            ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                            @bind-Value="@dateRangeModel.SalesCategoryId" ShowValidationIcon="true">
                </DxComboBox>
            </DxFormLayoutItem>
            <DxFormLayoutItem Caption="Method Code" ColSpanMd="12">
                <DxComboBox Data="@_navMethodCodeModeltems"
                            NullText="Select Method Code..."
                            ListRenderMode="ListRenderMode.Virtual"
                            SearchMode="ListSearchMode.Default"
                            SearchFilterCondition="ListSearchFilterCondition.Contains"
                            TextFieldName="MethodName"
                            ValueFieldName="MethodCodeID"
                            ClearButtonDisplayMode="DataEditorClearButtonDisplayMode.Auto"
                            @bind-Value="@dateRangeModel.MethodCodeId" ShowValidationIcon="true">
                </DxComboBox>
            </DxFormLayoutItem>
        </DxFormLayout>
    </BodyContentTemplate>
    <FooterContentTemplate Context="Context">
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Success" Text="Search" Click=@(()=> OnFilterDocuments()) />
        <DxButton style="margin-right: 10px;" RenderStyle="ButtonRenderStyle.Primary" Text="Clear" Click=@(()=> OnClearFilterDocuments()) />
        <DxButton RenderStyle="ButtonRenderStyle.Secondary" Text="Close" Click=@(()=> OnCloseFilterDocuments()) />

    </FooterContentTemplate>
</DxFlyout>
@code {
    private List<ViewPlants>? _plantItems;
    private List<NavMethodCodeModel>? _navMethodCodeModeltems;
    bool IsFilterOpen { get; set; } = false;
    bool PanelVisible { get; set; }
    private List<INPCalendarPivotModel> _simulationItems = new List<INPCalendarPivotModel>();
    private List<DropDownOptionsModel> _versionItems = new List<DropDownOptionsModel>();
    private List<DropDownOptionsModel> _salesCategoryItems = new List<DropDownOptionsModel>();
    IGrid Grid { get; set; }
    DateRangeModel dateRangeModel = new DateRangeModel();
    bool ExportSelectedRowsOnly { get; set; }
    public string? Acheader { get; set; } = "AC as at end Aug 19";
    public string? CurrentBatchSize { get; set; } = "Current Batch Size"; public string? BatchSize90 { get; set; } = "Batch Size";
    public string? StbPreheader { get; set; } = ""; public string? Stbheader { get; set; } = "Stock balance as at end Aug 2019";
    public string? Month1 { get; set; } = ""; public string? Month2 { get; set; } = ""; public string? Month3 { get; set; } = ""; public string? Month4 { get; set; } = "";
    public string? Month5 { get; set; } = ""; public string? Month6 { get; set; } = ""; public string? Month7 { get; set; } = ""; public string? Month8 { get; set; } = "";
    public string? Month9 { get; set; } = ""; public string? Month10 { get; set; } = ""; public string? Month11 { get; set; } = ""; public string? Month12 { get; set; } = "";
    public ApplicationUser applicationUser { get; private set; }
    protected override async Task OnInitializedAsync()
    {
        dateRangeModel.StockMonth = DateTime.Now;
        dateRangeModel.CompanyId = 1; dateRangeModel.VersionId = null;
        applicationUser = await _localStorageService.GetItem<ApplicationUser>("user");
        _plantItems = await Mediator.Send(new GetAllPlantByNavCompanyQuery());
        _navMethodCodeModeltems = await Mediator.Send(new GetAllNavMethodCode());
        for (long i = 1; i <= 10; i++)
        {
            DropDownOptionsModel dropDownOptionsModel = new DropDownOptionsModel();
            dropDownOptionsModel.Id = i;
            dropDownOptionsModel.Value = i.ToString();
            _versionItems.Add(dropDownOptionsModel);
        }
        salesCatList();

        await onLoadData();
    }
    void salesCatList()
    {
        DropDownOptionsModel dropDownOptionsModel1 = new DropDownOptionsModel();
        dropDownOptionsModel1.Text = "CAP";
        dropDownOptionsModel1.Id = 1;
        _salesCategoryItems.Add(dropDownOptionsModel1);
        DropDownOptionsModel dropDownOptionsModel2 = new DropDownOptionsModel();
        dropDownOptionsModel2.Text = "CREAM";
        dropDownOptionsModel2.Id = 2;
        _salesCategoryItems.Add(dropDownOptionsModel2);

        DropDownOptionsModel dropDownOptionsModel3 = new DropDownOptionsModel();
        dropDownOptionsModel3.Text = "DD";
        dropDownOptionsModel3.Id = 3;
        _salesCategoryItems.Add(dropDownOptionsModel3);
        DropDownOptionsModel dropDownOptionsModel4 = new DropDownOptionsModel();
        dropDownOptionsModel4.Text = "SYRUP";
        dropDownOptionsModel4.Id = 1;
        _salesCategoryItems.Add(dropDownOptionsModel4);
        DropDownOptionsModel dropDownOptionsModel5 = new DropDownOptionsModel();
        dropDownOptionsModel5.Text = "TABLET";
        dropDownOptionsModel5.Id = 1;
        _salesCategoryItems.Add(dropDownOptionsModel5);
        DropDownOptionsModel dropDownOptionsModel6 = new DropDownOptionsModel();
        dropDownOptionsModel6.Text = "VET";
        dropDownOptionsModel6.Id = 1;
        _salesCategoryItems.Add(dropDownOptionsModel6);
        DropDownOptionsModel dropDownOptionsModel7 = new DropDownOptionsModel();
        dropDownOptionsModel7.Text = "POWDER";
        dropDownOptionsModel7.Id = 7;
        _salesCategoryItems.Add(dropDownOptionsModel7);
        DropDownOptionsModel dropDownOptionsModel8 = new DropDownOptionsModel();
        dropDownOptionsModel8.Text = "INJ";
        dropDownOptionsModel8.Id = 8;
        _salesCategoryItems.Add(dropDownOptionsModel8);
    }
    async Task onLoadData()
    {
        PanelVisible = true;


        var startDate = dateRangeModel.StockMonth;
        var makeDate = dateRangeModel.StockMonth.AddDays(-1);
        Stbheader = "Stock balance as at " + makeDate.ToString("dd-MMM-yyyy");
        makeDate = makeDate.AddMonths(-1);
        var lastDay = new DateTime(makeDate.Year, makeDate.Month, 1).AddMonths(1).AddDays(-1);
        StbPreheader = "Stock balance as at " + lastDay.ToString("dd-MMM-yyyy");
        Acheader = "AC as at " + lastDay.ToString("dd-MMM-yyyy");
        var endDate = startDate.AddMonths(12);
        int countmonth = 1;
        while (startDate < endDate)
        {

            var lastDayOfMonth = DateTime.DaysInMonth(startDate.Year, startDate.Month);

            var daysInMonth = lastDayOfMonth - startDate.Day;

            var monthEndDate = startDate.AddDays(daysInMonth);

            if (endDate <= monthEndDate)
            {
                startDate = startDate.AddDays(daysInMonth);
            }
            else
            {
                var month = startDate.ToString("MMM");
                if (countmonth == 1) Month1 = month;
                if (countmonth == 2) Month2 = month;
                if (countmonth == 3) Month3 = month;
                if (countmonth == 4) Month4 = month;
                if (countmonth == 5) Month5 = month;
                if (countmonth == 6) Month6 = month;
                if (countmonth == 7) Month7 = month;
                if (countmonth == 8) Month8 = month;
                if (countmonth == 9) Month9 = month;
                if (countmonth == 10) Month10 = month;
                if (countmonth == 11) Month11 = month;
                if (countmonth == 12) Month12 = month;
                startDate = monthEndDate.AddDays(1);
            }
            countmonth++;
        }

        _simulationItems = await Mediator.Send(new GetAllSimulationMidMonthQuery(dateRangeModel));
        if (_simulationItems != null && _simulationItems.Count() > 0)
        {
            PanelVisible = false;
        }
        else
        {
            PanelVisible = false;
        }
        StateHasChanged();
        //Grid.AutoFitColumnWidths();
    }
    void OnFileProfiltefilter()
    {
        IsFilterOpen = true;
        StateHasChanged();
    }
    async Task OnFilterDocuments()
    {
        await onLoadData();
    }
    async Task OnClearFilterDocuments()
    {
        dateRangeModel = new DateRangeModel();
        dateRangeModel.StockMonth = DateTime.Now;
        dateRangeModel.CompanyId = 1;
        dateRangeModel.VersionId = null;
        dateRangeModel.IsSteroid = null;
        dateRangeModel.SalesCategoryId = null;
        dateRangeModel.MethodCodeId = null;
        await onLoadData();
        StateHasChanged();
    }
    void CheckedVisibleChanged(bool value)
    {
        dateRangeModel.IsSteroid = true;
        dateRangeModel.IsSteroids = value;
        dateRangeModel.IsNonSteroids = false;
        if (dateRangeModel.IsSteroids == false)
        {
            dateRangeModel.IsSteroid = null;
        }
        StateHasChanged();
    }
    void CheckedReadWriteChanged(bool value)
    {
        dateRangeModel.IsSteroid = true;
        dateRangeModel.IsSteroids = false;
        dateRangeModel.IsNonSteroids = value;
        if (dateRangeModel.IsNonSteroids == false)
        {
            dateRangeModel.IsSteroid = null;
        }
        StateHasChanged();
    }
    void OnCloseFilterDocuments()
    {
        IsFilterOpen = false;
        StateHasChanged();
    }
    async Task ExportXlsx_Click()
    {
        await Grid.ExportToXlsxAsync("ExportResult", new GridXlExportOptions()
            {
                ExportSelectedRowsOnly = ExportSelectedRowsOnly
            });
    }
    async Task ExportCsv_Click()
    {
        await Grid.ExportToCsvAsync("ExportResult", new GridCsvExportOptions()
            {
                ExportSelectedRowsOnly = ExportSelectedRowsOnly
            });
    }
    async Task ExportXls_Click()
    {
        await Grid.ExportToXlsAsync("ExportResult", new GridXlExportOptions()
            {
                ExportSelectedRowsOnly = ExportSelectedRowsOnly
            });
    }

    void Grid_CustomizeElement(GridCustomizeElementEventArgs e)
    {
        if (e.ElementType == GridElementType.DataRow && e.VisibleIndex % 2 == 1)
        {
            e.CssClass = "alt-item";
        }

    }
}