@using global::Core.Entities.Views;
@using global::Core.Entities;
@using Application.Queries;
@using MediatR
@inject IMediator Mediator
@using global::Core.EntityModels;
@inject AC.SD.Core.Services.ToastService toastService
@implements IAsyncDisposable
<div class="col-md-12">
    <div class="row align-items-end" style="border-top: 1px solid #d5d4d4; margin-top:10px;">
        <div class="cw-480 ch-220" style="margin-top:10px;">
            <DxFormLayout CssClass="w-100">
                <DxFormLayoutTabPages @bind-ActiveTabIndex="@ActiveSubTabIndex" RenderMode="TabsRenderMode.Default" TabClick="OnTabClick">
                    <DxFormLayoutTabPage Caption="From Data Approved">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataApproved @ref="refTransferDynamicFormDataApproved" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataApproved>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="From Data Workflow">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormWorkFlow @ref="refTransferDynamicFormWorkFlow" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormWorkFlow>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="From Data Lock">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataLock @ref="refTransferDynamicFormDataLock" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataLock>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="From Data Section Lock">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataSectionLock @ref="refTransferDynamicFormDataSectionLock" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataSectionLock>
                    </DxFormLayoutTabPage>
                </DxFormLayoutTabPages>
            </DxFormLayout>
        </div>
    </div>
</div>
@code {
    [Parameter]
    public ResetPermissionModel? Data { get; set; }
    int ActiveSubTabIndex { get; set; } = 0;
    int tabIndex { get; set; } = 0;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataSectionLock refTransferDynamicFormDataSectionLock;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataLock refTransferDynamicFormDataLock;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormDataApproved refTransferDynamicFormDataApproved;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormDataTransfer.TransferDynamicFormWorkFlow refTransferDynamicFormWorkFlow;
    protected override async Task OnInitializedAsync()
    {

    }
    void OnTabClick(TabClickEventArgs e)
    {
        tabIndex = e.TabIndex;
    }
    public async Task loadDynamicFormDataForm(ResetPermissionModel data)
    {
        Data = data;
        if (refTransferDynamicFormDataApproved != null)
        {
            await refTransferDynamicFormDataApproved.loadFromApproved(Data);
        }
        if (refTransferDynamicFormWorkFlow != null)
        {
            await refTransferDynamicFormWorkFlow.loadDynamicFormWorkFlowForm(Data);
        }
        if (refTransferDynamicFormDataLock != null)
        {
            await refTransferDynamicFormDataLock.loadDynamicFormDataLock(Data);
        }
        if (refTransferDynamicFormDataSectionLock != null)
        {
            await refTransferDynamicFormDataSectionLock.loadDynamicFormDataSectionLock(Data);
        }
    }
    public async ValueTask DisposeAsync()
    {
        refTransferDynamicFormDataApproved?.DisposeAsync();
        refTransferDynamicFormWorkFlow?.DisposeAsync();
        refTransferDynamicFormDataLock?.DisposeAsync();
        refTransferDynamicFormDataSectionLock?.DisposeAsync();
    }
}