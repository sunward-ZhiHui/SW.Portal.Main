@using global::Core.Entities.Views;
@using global::Core.Entities;
@using Application.Queries;
@using MediatR
@inject IMediator Mediator
@using global::Core.EntityModels;
@inject AC.SD.Core.Services.ToastService toastService
@implements IAsyncDisposable
<div class="col-md-12">
    <div class="row align-items-end" style="border-top: 1px solid #d5d4d4; margin-top:10px;">
        <div class="cw-480 ch-220" style="margin-top:10px;">
            <DxFormLayout CssClass="w-100">
                <DxFormLayoutTabPages @bind-ActiveTabIndex="@ActiveSubTabIndex" RenderMode="TabsRenderMode.Default" TabClick="OnTabClick">
                    <DxFormLayoutTabPage Caption="From Approval Master">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormApproval @ref="refTransferDynamicFormApproval" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormApproval>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="WokFlow Master">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowTransfer @ref="refDynamicFormWorkFlowTransfer" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowTransfer>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="WokFlow Approval Master">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowApprovalTransfer @ref="refDynamicFormWorkFlowApprovalTransfer" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowApprovalTransfer>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="Section Permission">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionSecurity @ref="refTransferDynamicFormSectionSecurity" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionSecurity>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="Section Attribute Permission">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionAttributeSecurity @ref="refTransferDynamicFormSectionAttributeSecurity" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionAttributeSecurity>
                    </DxFormLayoutTabPage>
                    <DxFormLayoutTabPage Caption="Section Attribute Form Control Permission">
                        <AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormSectionAttributeSectionControlPermission @ref="refDynamicFormSectionAttributeSectionControlPermission" Data="@Data"></AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormSectionAttributeSectionControlPermission>
                    </DxFormLayoutTabPage>
                </DxFormLayoutTabPages>
            </DxFormLayout>
        </div>
    </div>
</div>
@code {
    [Parameter]
    public ResetPermissionModel? Data { get; set; }
    int ActiveSubTabIndex { get; set; } = 0;
    int tabIndex { get; set; } = 0;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormApproval refTransferDynamicFormApproval;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionAttributeSecurity refTransferDynamicFormSectionAttributeSecurity;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.TransferDynamicFormSectionSecurity refTransferDynamicFormSectionSecurity;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowApprovalTransfer refDynamicFormWorkFlowApprovalTransfer;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormWorkFlowTransfer refDynamicFormWorkFlowTransfer;
    private AC.SD.Core.Pages.TransferPermissions.DynamicFormTransfer.DynamicFormSectionAttributeSectionControlPermission refDynamicFormSectionAttributeSectionControlPermission;
    protected override async Task OnInitializedAsync()
    {

    }
    void OnTabClick(TabClickEventArgs e)
    {
        tabIndex = e.TabIndex;
    }
    public async Task loadDynamicFormData(ResetPermissionModel data)
    {
        Data = data;
        if (refDynamicFormWorkFlowTransfer != null)
        {
            await refDynamicFormWorkFlowTransfer.loadWorkFlowData(Data);
        }
        if (refDynamicFormWorkFlowApprovalTransfer != null)
        {
            await refDynamicFormWorkFlowApprovalTransfer.loadWorkFlowApprovalData(Data);
        }
        if (refTransferDynamicFormSectionSecurity != null)
        {
            await refTransferDynamicFormSectionSecurity.loadDynamicFormSectionSecurity(Data);
        }
        if (refTransferDynamicFormSectionAttributeSecurity != null)
        {
            await refTransferDynamicFormSectionAttributeSecurity.loadDynamicFormSectionAttributeSecurity(Data);
        }
        if (refDynamicFormSectionAttributeSectionControlPermission != null)
        {
            await refDynamicFormSectionAttributeSectionControlPermission.loadAttributeSectionControlPermission(Data);
        }
        if (refTransferDynamicFormApproval != null)
        {
            await refTransferDynamicFormApproval.loadFromApproval(Data);
        }
    }
    public async ValueTask DisposeAsync()
    {
        refDynamicFormWorkFlowTransfer?.DisposeAsync();
        refDynamicFormWorkFlowApprovalTransfer?.DisposeAsync();
        refTransferDynamicFormSectionSecurity?.DisposeAsync();
        refTransferDynamicFormSectionAttributeSecurity?.DisposeAsync();
        refDynamicFormSectionAttributeSectionControlPermission?.DisposeAsync();
        refTransferDynamicFormApproval?.DisposeAsync();
    }
}